import{u as Ai,a as Ti}from"./use-dark.446fa49d.js";import{m as ke,c as F,h as ae,g as Ie,v as ir,S as yo,U as mo,r as re,Z as tn,_ as sr,Y as _o,$ as wo,a0 as Xs,a1 as me,a2 as bo,a3 as Ao,a4 as Je,a5 as pn,a6 as Dr,a7 as vn,a8 as Mr,a9 as St,l as Ne,aa as ss,w as _e,ab as To,o as Zs,n as jr,ac as Oe,ad as Po,ae as ea,af as ta,ag as ar,ah as Or,a as Eo,ai as ra,aj as Oo,ak as So,al as ko,am as $r,an as na,C as gn,M as as,G as Io,H as Co,ao as yn,D as xo,J as Ro,N as Do}from"./index.a86bbf37.js";import{g as Mo,a as jo,h as $o,b as Bo,c as ia}from"./scroll.e35f4f5a.js";import{r as os,a as Lo,b as sa}from"./uid.0579cf5f.js";import{I as No}from"./iconify.6ad5f225.js";const Uo={true:"inset",item:"item-inset","item-thumbnail":"item-thumbnail-inset"},mn={xs:2,sm:4,md:8,lg:16,xl:24};var zf=ke({name:"QSeparator",props:{...Ai,spaced:[Boolean,String],inset:[Boolean,String],vertical:Boolean,color:String,size:String},setup(t){const e=Ie(),r=Ti(t,e.proxy.$q),n=F(()=>t.vertical===!0?"vertical":"horizontal"),i=F(()=>` q-separator--${n.value}`),s=F(()=>t.inset!==!1?`${i.value}-${Uo[t.inset]}`:""),a=F(()=>`q-separator${i.value}${s.value}`+(t.color!==void 0?` bg-${t.color}`:"")+(r.value===!0?" q-separator--dark":"")),o=F(()=>{const l={};if(t.size!==void 0&&(l[t.vertical===!0?"width":"height"]=t.size),t.spaced!==!1){const u=t.spaced===!0?`${mn.md}px`:t.spaced in mn?`${mn[t.spaced]}px`:t.spaced,c=t.vertical===!0?["Left","Right"]:["Top","Bottom"];l[`margin${c[0]}`]=l[`margin${c[1]}`]=u}return l});return()=>ae("hr",{class:a.value,style:o.value,"aria-orientation":n.value})}}),Vf=ke({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(t,{slots:e}){const r=F(()=>`q-item__section column q-item__section--${t.avatar===!0||t.side===!0||t.thumbnail===!0?"side":"main"}`+(t.top===!0?" q-item__section--top justify-start":" justify-center")+(t.avatar===!0?" q-item__section--avatar":"")+(t.thumbnail===!0?" q-item__section--thumbnail":"")+(t.noWrap===!0?" q-item__section--nowrap":""));return()=>ae("div",{class:r.value},ir(e.default))}}),Jf=ke({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(t,{slots:e}){const r=F(()=>parseInt(t.lines,10)),n=F(()=>"q-item__label"+(t.overline===!0?" q-item__label--overline text-overline":"")+(t.caption===!0?" q-item__label--caption text-caption":"")+(t.header===!0?" q-item__label--header":"")+(r.value===1?" ellipsis":"")),i=F(()=>t.lines!==void 0&&r.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":r.value}:null);return()=>ae("div",{style:i.value,class:n.value},ir(e.default))}}),Gf=ke({name:"QItem",props:{...Ai,...yo,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(t,{slots:e,emit:r}){const{proxy:{$q:n}}=Ie(),i=Ti(t,n),{hasLink:s,linkAttrs:a,linkClass:o,linkTag:l,navigateOnClick:u}=mo(),c=re(null),d=re(null),h=F(()=>t.clickable===!0||s.value===!0||t.tag==="label"),f=F(()=>t.disable!==!0&&h.value===!0),p=F(()=>"q-item q-item-type row no-wrap"+(t.dense===!0?" q-item--dense":"")+(i.value===!0?" q-item--dark":"")+(s.value===!0&&t.active===null?o.value:t.active===!0?` q-item--active${t.activeClass!==void 0?` ${t.activeClass}`:""}`:"")+(t.disable===!0?" disabled":"")+(f.value===!0?" q-item--clickable q-link cursor-pointer "+(t.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(t.focused===!0?" q-manual-focusable--focused":""):"")),v=F(()=>{if(t.insetLevel===void 0)return null;const g=n.lang.rtl===!0?"Right":"Left";return{["padding"+g]:16+t.insetLevel*56+"px"}});function y(g){f.value===!0&&(d.value!==null&&(g.qKeyEvent!==!0&&document.activeElement===c.value?d.value.focus():document.activeElement===d.value&&c.value.focus()),u(g))}function b(g){if(f.value===!0&&tn(g,[13,32])===!0){sr(g),g.qKeyEvent=!0;const w=new MouseEvent("click",g);w.qKeyEvent=!0,c.value.dispatchEvent(w)}r("keyup",g)}function _(){const g=_o(e.default,[]);return f.value===!0&&g.unshift(ae("div",{class:"q-focus-helper",tabindex:-1,ref:d})),g}return()=>{const g={ref:c,class:p.value,style:v.value,role:"listitem",onClick:y,onKeyup:b};return f.value===!0?(g.tabindex=t.tabindex||"0",Object.assign(g,a.value)):h.value===!0&&(g["aria-disabled"]="true"),ae(l.value,g,_())}}});const Ko=ae("div",{class:"q-space"});var Qf=ke({name:"QSpace",setup(){return()=>Ko}});const Pi={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},qo=Object.keys(Pi);Pi.all=!0;function ls(t){const e={};for(const r of qo)t[r]===!0&&(e[r]=!0);return Object.keys(e).length===0?Pi:(e.horizontal===!0?e.left=e.right=!0:e.left===!0&&e.right===!0&&(e.horizontal=!0),e.vertical===!0?e.up=e.down=!0:e.up===!0&&e.down===!0&&(e.vertical=!0),e.horizontal===!0&&e.vertical===!0&&(e.all=!0),e)}const Fo=["INPUT","TEXTAREA"];function us(t,e){return e.event===void 0&&t.target!==void 0&&t.target.draggable!==!0&&typeof e.handler=="function"&&Fo.includes(t.target.nodeName.toUpperCase())===!1&&(t.qClonedBy===void 0||t.qClonedBy.indexOf(e.uid)===-1)}function Br(){if(window.getSelection!==void 0){const t=window.getSelection();t.empty!==void 0?t.empty():t.removeAllRanges!==void 0&&(t.removeAllRanges(),wo.is.mobile!==!0&&t.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}function _n(t,e,r){const n=Mr(t);let i,s=n.left-e.event.x,a=n.top-e.event.y,o=Math.abs(s),l=Math.abs(a);const u=e.direction;u.horizontal===!0&&u.vertical!==!0?i=s<0?"left":"right":u.horizontal!==!0&&u.vertical===!0?i=a<0?"up":"down":u.up===!0&&a<0?(i="up",o>l&&(u.left===!0&&s<0?i="left":u.right===!0&&s>0&&(i="right"))):u.down===!0&&a>0?(i="down",o>l&&(u.left===!0&&s<0?i="left":u.right===!0&&s>0&&(i="right"))):u.left===!0&&s<0?(i="left",o<l&&(u.up===!0&&a<0?i="up":u.down===!0&&a>0&&(i="down"))):u.right===!0&&s>0&&(i="right",o<l&&(u.up===!0&&a<0?i="up":u.down===!0&&a>0&&(i="down")));let c=!1;if(i===void 0&&r===!1){if(e.event.isFirst===!0||e.event.lastDir===void 0)return{};i=e.event.lastDir,c=!0,i==="left"||i==="right"?(n.left-=s,o=0,s=0):(n.top-=a,l=0,a=0)}return{synthetic:c,payload:{evt:t,touch:e.event.mouse!==!0,mouse:e.event.mouse===!0,position:n,direction:i,isFirst:e.event.isFirst,isFinal:r===!0,duration:Date.now()-e.event.time,distance:{x:o,y:l},offset:{x:s,y:a},delta:{x:n.left-e.event.lastX,y:n.top-e.event.lastY}}}}let Ho=0;var Yf=Xs({name:"touch-pan",beforeMount(t,{value:e,modifiers:r}){if(r.mouse!==!0&&me.has.touch!==!0)return;function n(s,a){r.mouse===!0&&a===!0?sr(s):(r.stop===!0&&vn(s),r.prevent===!0&&Dr(s))}const i={uid:"qvtp_"+Ho++,handler:e,modifiers:r,direction:ls(r),noop:bo,mouseStart(s){us(s,i)&&Ao(s)&&(Je(i,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),i.start(s,!0))},touchStart(s){if(us(s,i)){const a=s.target;Je(i,"temp",[[a,"touchmove","move","notPassiveCapture"],[a,"touchcancel","end","passiveCapture"],[a,"touchend","end","passiveCapture"]]),i.start(s)}},start(s,a){if(me.is.firefox===!0&&pn(t,!0),i.lastEvt=s,a===!0||r.stop===!0){if(i.direction.all!==!0&&(a!==!0||i.modifiers.mouseAllDir!==!0&&i.modifiers.mousealldir!==!0)){const u=s.type.indexOf("mouse")!==-1?new MouseEvent(s.type,s):new TouchEvent(s.type,s);s.defaultPrevented===!0&&Dr(u),s.cancelBubble===!0&&vn(u),Object.assign(u,{qKeyEvent:s.qKeyEvent,qClickOutside:s.qClickOutside,qAnchorHandled:s.qAnchorHandled,qClonedBy:s.qClonedBy===void 0?[i.uid]:s.qClonedBy.concat(i.uid)}),i.initialEvent={target:s.target,event:u}}vn(s)}const{left:o,top:l}=Mr(s);i.event={x:o,y:l,time:Date.now(),mouse:a===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:o,lastY:l}},move(s){if(i.event===void 0)return;const a=Mr(s),o=a.left-i.event.x,l=a.top-i.event.y;if(o===0&&l===0)return;i.lastEvt=s;const u=i.event.mouse===!0,c=()=>{n(s,u);let f;r.preserveCursor!==!0&&r.preservecursor!==!0&&(f=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),u===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),Br(),i.styleCleanup=p=>{if(i.styleCleanup=void 0,f!==void 0&&(document.documentElement.style.cursor=f),document.body.classList.remove("non-selectable"),u===!0){const v=()=>{document.body.classList.remove("no-pointer-events--children")};p!==void 0?setTimeout(()=>{v(),p()},50):v()}else p!==void 0&&p()}};if(i.event.detected===!0){i.event.isFirst!==!0&&n(s,i.event.mouse);const{payload:f,synthetic:p}=_n(s,i,!1);f!==void 0&&(i.handler(f)===!1?i.end(s):(i.styleCleanup===void 0&&i.event.isFirst===!0&&c(),i.event.lastX=f.position.left,i.event.lastY=f.position.top,i.event.lastDir=p===!0?void 0:f.direction,i.event.isFirst=!1));return}if(i.direction.all===!0||u===!0&&(i.modifiers.mouseAllDir===!0||i.modifiers.mousealldir===!0)){c(),i.event.detected=!0,i.move(s);return}const d=Math.abs(o),h=Math.abs(l);d!==h&&(i.direction.horizontal===!0&&d>h||i.direction.vertical===!0&&d<h||i.direction.up===!0&&d<h&&l<0||i.direction.down===!0&&d<h&&l>0||i.direction.left===!0&&d>h&&o<0||i.direction.right===!0&&d>h&&o>0?(i.event.detected=!0,i.move(s)):i.end(s,!0))},end(s,a){if(i.event!==void 0){if(St(i,"temp"),me.is.firefox===!0&&pn(t,!1),a===!0)i.styleCleanup!==void 0&&i.styleCleanup(),i.event.detected!==!0&&i.initialEvent!==void 0&&i.initialEvent.target.dispatchEvent(i.initialEvent.event);else if(i.event.detected===!0){i.event.isFirst===!0&&i.handler(_n(s===void 0?i.lastEvt:s,i).payload);const{payload:o}=_n(s===void 0?i.lastEvt:s,i,!0),l=()=>{i.handler(o)};i.styleCleanup!==void 0?i.styleCleanup(l):l()}i.event=void 0,i.initialEvent=void 0,i.lastEvt=void 0}}};if(t.__qtouchpan=i,r.mouse===!0){const s=r.mouseCapture===!0||r.mousecapture===!0?"Capture":"";Je(i,"main",[[t,"mousedown","mouseStart",`passive${s}`]])}me.has.touch===!0&&Je(i,"main",[[t,"touchstart","touchStart",`passive${r.capture===!0?"Capture":""}`],[t,"touchmove","noop","notPassiveCapture"]])},updated(t,e){const r=t.__qtouchpan;r!==void 0&&(e.oldValue!==e.value&&(typeof value!="function"&&r.end(),r.handler=e.value),r.direction=ls(e.modifiers))},beforeUnmount(t){const e=t.__qtouchpan;e!==void 0&&(e.event!==void 0&&e.end(),St(e,"main"),St(e,"temp"),me.is.firefox===!0&&pn(t,!1),e.styleCleanup!==void 0&&e.styleCleanup(),delete t.__qtouchpan)}});function Xf(t,e,r){return r<=e?e:Math.min(r,Math.max(e,t))}function Zf(t,e,r){if(r<=e)return e;const n=r-e+1;let i=e+(t-e)%n;return i<e&&(i=n+i),i===0?0:i}function ep(t,e=2,r="0"){if(t==null)return t;const n=""+t;return n.length>=e?n:new Array(e-n.length+1).join(r)+n}function Wo(t,e,r){let n;function i(){n!==void 0&&(ss.remove(n),n=void 0)}return Ne(()=>{t.value===!0&&i()}),{removeFromHistory:i,addToHistory(){n={condition:()=>r.value===!0,handler:e},ss.add(n)}}}const Ei={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},Oi=["beforeShow","show","beforeHide","hide"];function Si({showing:t,canShow:e,hideOnRouteChange:r,handleShow:n,handleHide:i,processOnMount:s}){const a=Ie(),{props:o,emit:l,proxy:u}=a;let c;function d(_){t.value===!0?p(_):h(_)}function h(_){if(o.disable===!0||_!==void 0&&_.qAnchorHandled===!0||e!==void 0&&e(_)!==!0)return;const g=o["onUpdate:modelValue"]!==void 0;g===!0&&(l("update:modelValue",!0),c=_,jr(()=>{c===_&&(c=void 0)})),(o.modelValue===null||g===!1)&&f(_)}function f(_){t.value!==!0&&(t.value=!0,l("beforeShow",_),n!==void 0?n(_):l("show",_))}function p(_){if(o.disable===!0)return;const g=o["onUpdate:modelValue"]!==void 0;g===!0&&(l("update:modelValue",!1),c=_,jr(()=>{c===_&&(c=void 0)})),(o.modelValue===null||g===!1)&&v(_)}function v(_){t.value!==!1&&(t.value=!1,l("beforeHide",_),i!==void 0?i(_):l("hide",_))}function y(_){o.disable===!0&&_===!0?o["onUpdate:modelValue"]!==void 0&&l("update:modelValue",!1):_===!0!==t.value&&(_===!0?f:v)(c)}_e(()=>o.modelValue,y),r!==void 0&&To(a)===!0&&_e(()=>u.$route.fullPath,()=>{r.value===!0&&t.value===!0&&p()}),s===!0&&Zs(()=>{y(o.modelValue)});const b={show:h,hide:p,toggle:d};return Object.assign(u,b),b}let Nt=0,wn,bn,Kt,An=!1,cs,ds,hs,tt=null;function zo(t){Vo(t)&&sr(t)}function Vo(t){if(t.target===document.body||t.target.classList.contains("q-layout__backdrop"))return!0;const e=Po(t),r=t.shiftKey&&!t.deltaX,n=!r&&Math.abs(t.deltaX)<=Math.abs(t.deltaY),i=r||n?t.deltaY:t.deltaX;for(let s=0;s<e.length;s++){const a=e[s];if($o(a,n))return n?i<0&&a.scrollTop===0?!0:i>0&&a.scrollTop+a.clientHeight===a.scrollHeight:i<0&&a.scrollLeft===0?!0:i>0&&a.scrollLeft+a.clientWidth===a.scrollWidth}return!0}function fs(t){t.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function vr(t){An!==!0&&(An=!0,requestAnimationFrame(()=>{An=!1;const{height:e}=t.target,{clientHeight:r,scrollTop:n}=document.scrollingElement;(Kt===void 0||e!==window.innerHeight)&&(Kt=r-e,document.scrollingElement.scrollTop=n),n>Kt&&(document.scrollingElement.scrollTop-=Math.ceil((n-Kt)/8))}))}function ps(t){const e=document.body,r=window.visualViewport!==void 0;if(t==="add"){const{overflowY:n,overflowX:i}=window.getComputedStyle(e);wn=Mo(window),bn=jo(window),cs=e.style.left,ds=e.style.top,hs=window.location.href,e.style.left=`-${wn}px`,e.style.top=`-${bn}px`,i!=="hidden"&&(i==="scroll"||e.scrollWidth>window.innerWidth)&&e.classList.add("q-body--force-scrollbar-x"),n!=="hidden"&&(n==="scroll"||e.scrollHeight>window.innerHeight)&&e.classList.add("q-body--force-scrollbar-y"),e.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,me.is.ios===!0&&(r===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",vr,Oe.passiveCapture),window.visualViewport.addEventListener("scroll",vr,Oe.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",fs,Oe.passiveCapture))}me.is.desktop===!0&&me.is.mac===!0&&window[`${t}EventListener`]("wheel",zo,Oe.notPassive),t==="remove"&&(me.is.ios===!0&&(r===!0?(window.visualViewport.removeEventListener("resize",vr,Oe.passiveCapture),window.visualViewport.removeEventListener("scroll",vr,Oe.passiveCapture)):window.removeEventListener("scroll",fs,Oe.passiveCapture)),e.classList.remove("q-body--prevent-scroll"),e.classList.remove("q-body--force-scrollbar-x"),e.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,e.style.left=cs,e.style.top=ds,window.location.href===hs&&window.scrollTo(wn,bn),Kt=void 0)}function Jo(t){let e="add";if(t===!0){if(Nt++,tt!==null){clearTimeout(tt),tt=null;return}if(Nt>1)return}else{if(Nt===0||(Nt--,Nt>0))return;if(e="remove",me.is.ios===!0&&me.is.nativeMobile===!0){tt!==null&&clearTimeout(tt),tt=setTimeout(()=>{ps(e),tt=null},100);return}}ps(e)}function Go(){let t;return{preventBodyScroll(e){e!==t&&(t!==void 0||e===!0)&&(t=e,Jo(e))}}}function ki(){let t=null;const e=Ie();function r(){t!==null&&(clearTimeout(t),t=null)}return ea(r),Ne(r),{removeTimeout:r,registerTimeout(n,i){r(),ta(e)===!1&&(t=setTimeout(()=>{t=null,n()},i))}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var q=function(){return q=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},q.apply(this,arguments)};function Un(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var V=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,ne=Object.keys,fe=Array.isArray;typeof Promise!="undefined"&&!V.Promise&&(V.Promise=Promise);function ve(t,e){return typeof e!="object"||ne(e).forEach(function(r){t[r]=e[r]}),t}var Qt=Object.getPrototypeOf,Qo={}.hasOwnProperty;function be(t,e){return Qo.call(t,e)}function Ct(t,e){typeof e=="function"&&(e=e(Qt(t))),(typeof Reflect=="undefined"?ne:Reflect.ownKeys)(e).forEach(function(r){Ue(t,r,e[r])})}var aa=Object.defineProperty;function Ue(t,e,r,n){aa(t,e,ve(r&&be(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Dt(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Ue(t.prototype,"constructor",t),{extend:Ct.bind(null,t.prototype)}}}}var Yo=Object.getOwnPropertyDescriptor;function Ii(t,e){var r=Yo(t,e),n;return r||(n=Qt(t))&&Ii(n,e)}var Xo=[].slice;function rn(t,e,r){return Xo.call(t,e,r)}function oa(t,e){return e(t)}function qt(t){if(!t)throw new Error("Assertion Failed")}function la(t){V.setImmediate?setImmediate(t):setTimeout(t,0)}function ua(t,e){return t.reduce(function(r,n,i){var s=e(n,i);return s&&(r[s[0]]=s[1]),r},{})}function Zo(t,e,r){try{t.apply(null,r)}catch(n){e&&e(n)}}function Le(t,e){if(typeof e=="string"&&be(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var r=[],n=0,i=e.length;n<i;++n){var s=Le(t,e[n]);r.push(s)}return r}var a=e.indexOf(".");if(a!==-1){var o=t[e.substr(0,a)];return o===void 0?void 0:Le(o,e.substr(a+1))}}function Ee(t,e,r){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){qt(typeof r!="string"&&"length"in r);for(var n=0,i=e.length;n<i;++n)Ee(t,e[n],r[n])}else{var s=e.indexOf(".");if(s!==-1){var a=e.substr(0,s),o=e.substr(s+1);if(o==="")r===void 0?fe(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=r;else{var l=t[a];(!l||!be(t,a))&&(l=t[a]={}),Ee(l,o,r)}}else r===void 0?fe(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function el(t,e){typeof e=="string"?Ee(t,e,void 0):"length"in e&&[].map.call(e,function(r){Ee(t,r,void 0)})}function ca(t){var e={};for(var r in t)be(t,r)&&(e[r]=t[r]);return e}var tl=[].concat;function da(t){return tl.apply([],t)}var ha="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(da([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return V[t]}),rl=ha.map(function(t){return V[t]});ua(ha,function(t){return[t,!0]});var ze=null;function or(t){ze=typeof WeakMap!="undefined"&&new WeakMap;var e=Kn(t);return ze=null,e}function Kn(t){if(!t||typeof t!="object")return t;var e=ze&&ze.get(t);if(e)return e;if(fe(t)){e=[],ze&&ze.set(t,e);for(var r=0,n=t.length;r<n;++r)e.push(Kn(t[r]))}else if(rl.indexOf(t.constructor)>=0)e=t;else{var i=Qt(t);e=i===Object.prototype?{}:Object.create(i),ze&&ze.set(t,e);for(var s in t)be(t,s)&&(e[s]=Kn(t[s]))}return e}var nl={}.toString;function qn(t){return nl.call(t).slice(8,-1)}var Fn=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",il=typeof Fn=="symbol"?function(t){var e;return t!=null&&(e=t[Fn])&&e.apply(t)}:function(){return null},Pt={};function $e(t){var e,r,n,i;if(arguments.length===1){if(fe(t))return t.slice();if(this===Pt&&typeof t=="string")return[t];if(i=il(t)){for(r=[];n=i.next(),!n.done;)r.push(n.value);return r}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var Ci=typeof Symbol!="undefined"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ce=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function fa(t,e){Ce=t,pa=e}var pa=function(){return!0},sl=!new Error("").stack;function vt(){if(sl)try{throw vt.arguments,new Error}catch(t){return t}return new Error}function Hn(t,e){var r=t.stack;return r?(e=e||0,r.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),r.split(`
`).slice(e).filter(pa).map(function(n){return`
`+n}).join("")):""}var al=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],va=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xi=al.concat(va),ol={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Mt(t,e){this._e=vt(),this.name=t,this.message=e}Dt(Mt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Hn(this._e,2))}},toString:function(){return this.name+": "+this.message}});function ga(t,e){return t+". Errors: "+Object.keys(e).map(function(r){return e[r].toString()}).filter(function(r,n,i){return i.indexOf(r)===n}).join(`
`)}function Lr(t,e,r,n){this._e=vt(),this.failures=e,this.failedKeys=n,this.successCount=r,this.message=ga(t,e)}Dt(Lr).from(Mt);function Wt(t,e){this._e=vt(),this.name="BulkError",this.failures=Object.keys(e).map(function(r){return e[r]}),this.failuresByPos=e,this.message=ga(t,e)}Dt(Wt).from(Mt);var Ri=xi.reduce(function(t,e){return t[e]=e+"Error",t},{}),ll=Mt,x=xi.reduce(function(t,e){var r=e+"Error";function n(i,s){this._e=vt(),this.name=r,i?typeof i=="string"?(this.message=""+i+(s?`
 `+s:""),this.inner=s||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=ol[e]||r,this.inner=null)}return Dt(n).from(ll),t[e]=n,t},{});x.Syntax=SyntaxError;x.Type=TypeError;x.Range=RangeError;var vs=va.reduce(function(t,e){return t[e+"Error"]=x[e],t},{});function ul(t,e){if(!t||t instanceof Mt||t instanceof TypeError||t instanceof SyntaxError||!t.name||!vs[t.name])return t;var r=new vs[t.name](e||t.message,t);return"stack"in t&&Ue(r,"stack",{get:function(){return this.inner.stack}}),r}var nn=xi.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=x[e]),t},{});nn.ModifyError=Lr;nn.DexieError=Mt;nn.BulkError=Wt;function H(){}function lr(t){return t}function cl(t,e){return t==null||t===lr?e:function(r){return e(t(r))}}function ft(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function dl(t,e){return t===H?e:function(){var r=t.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?ft(n,this.onsuccess):n),i&&(this.onerror=this.onerror?ft(i,this.onerror):i),s!==void 0?s:r}}function hl(t,e){return t===H?e:function(){t.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?ft(r,this.onsuccess):r),n&&(this.onerror=this.onerror?ft(n,this.onerror):n)}}function fl(t,e){return t===H?e:function(r){var n=t.apply(this,arguments);ve(r,n);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ft(i,this.onsuccess):i),s&&(this.onerror=this.onerror?ft(s,this.onerror):s),n===void 0?a===void 0?void 0:a:ve(n,a)}}function pl(t,e){return t===H?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function Di(t,e){return t===H?e:function(){var r=t.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return r.then(function(){return e.apply(n,s)})}return e.apply(this,arguments)}}var Yt={},vl=100,gl=20,ya=100,Mi=typeof Promise=="undefined"?[]:function(){var t=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[t,Qt(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Qt(e),t]}(),Wn=Mi[0],Nr=Mi[1],zn=Mi[2],ma=Nr&&Nr.then,Sr=Wn&&Wn.constructor,ji=!!zn,Vn=!1,yl=zn?function(){zn.then(gr)}:V.setImmediate?setImmediate.bind(null,gr):V.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){gr(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(gr,0)},Xt=function(t,e){Ft.push([t,e]),Ur&&(yl(),Ur=!1)},Jn=!0,Ur=!0,lt=[],kr=[],Gn=null,Qn=lr,kt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ms,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{ms(t[0],t[1])}catch{}})}},k=kt,Ft=[],ut=0,Ir=[];function O(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=H,this._lib=!1;var e=this._PSD=k;if(Ce&&(this._stackHolder=vt(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Yt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Xn(this,this._value);return}this._state=null,this._value=null,++e.ref,wa(this,t)}var Yn={get:function(){var t=k,e=Kr;function r(n,i){var s=this,a=!t.global&&(t!==k||e!==Kr),o=a&&!Ke(),l=new O(function(u,c){$i(s,new _a(Fr(n,t,a,o),Fr(i,t,a,o),u,c,t))});return Ce&&Ta(l,this),l}return r.prototype=Yt,r},set:function(t){Ue(this,"then",t&&t.prototype===Yt?Yn:{get:function(){return t},set:Yn.set})}};Ct(O.prototype,{then:Yn,_then:function(t,e){$i(this,new _a(null,null,t,e,k))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],r=arguments[1];return typeof e=="function"?this.then(null,function(n){return n instanceof e?r(n):Cr(n)}):this.then(null,function(n){return n&&n.name===e?r(n):Cr(n)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),Cr(e)})},stack:{get:function(){if(this._stack)return this._stack;try{Vn=!0;var t=Aa(this,[],gl),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Vn=!1}}},timeout:function(t,e){var r=this;return t<1/0?new O(function(n,i){var s=setTimeout(function(){return i(new x.Timeout(e))},t);r.then(n,i).finally(clearTimeout.bind(null,s))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&Ue(O.prototype,Symbol.toStringTag,"Dexie.Promise");kt.env=Pa();function _a(t,e,r,n,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=r,this.reject=n,this.psd=i}Ct(O,{all:function(){var t=$e.apply(null,arguments).map(qr);return new O(function(e,r){t.length===0&&e([]);var n=t.length;t.forEach(function(i,s){return O.resolve(i).then(function(a){t[s]=a,--n||e(t)},r)})})},resolve:function(t){if(t instanceof O)return t;if(t&&typeof t.then=="function")return new O(function(r,n){t.then(r,n)});var e=new O(Yt,!0,t);return Ta(e,Gn),e},reject:Cr,race:function(){var t=$e.apply(null,arguments).map(qr);return new O(function(e,r){t.map(function(n){return O.resolve(n).then(e,r)})})},PSD:{get:function(){return k},set:function(t){return k=t}},totalEchoes:{get:function(){return Kr}},newPSD:Qe,usePSD:$t,scheduler:{get:function(){return Xt},set:function(t){Xt=t}},rejectionMapper:{get:function(){return Qn},set:function(t){Qn=t}},follow:function(t,e){return new O(function(r,n){return Qe(function(i,s){var a=k;a.unhandleds=[],a.onunhandled=s,a.finalize=ft(function(){var o=this;_l(function(){o.unhandleds.length===0?i():s(o.unhandleds[0])})},a.finalize),t()},e,r,n)})}});Sr&&(Sr.allSettled&&Ue(O,"allSettled",function(){var t=$e.apply(null,arguments).map(qr);return new O(function(e){t.length===0&&e([]);var r=t.length,n=new Array(r);t.forEach(function(i,s){return O.resolve(i).then(function(a){return n[s]={status:"fulfilled",value:a}},function(a){return n[s]={status:"rejected",reason:a}}).then(function(){return--r||e(n)})})})}),Sr.any&&typeof AggregateError!="undefined"&&Ue(O,"any",function(){var t=$e.apply(null,arguments).map(qr);return new O(function(e,r){t.length===0&&r(new AggregateError([]));var n=t.length,i=new Array(n);t.forEach(function(s,a){return O.resolve(s).then(function(o){return e(o)},function(o){i[a]=o,--n||r(new AggregateError(i))})})})}));function wa(t,e){try{e(function(r){if(t._state===null){if(r===t)throw new TypeError("A promise cannot be resolved with itself.");var n=t._lib&&ur();r&&typeof r.then=="function"?wa(t,function(i,s){r instanceof O?r._then(i,s):r.then(i,s)}):(t._state=!0,t._value=r,ba(t)),n&&cr()}},Xn.bind(null,t))}catch(r){Xn(t,r)}}function Xn(t,e){if(kr.push(e),t._state===null){var r=t._lib&&ur();e=Qn(e),t._state=!1,t._value=e,Ce&&e!==null&&typeof e=="object"&&!e._promise&&Zo(function(){var n=Ii(e,"stack");e._promise=t,Ue(e,"stack",{get:function(){return Vn?n&&(n.get?n.get.apply(e):n.value):t.stack}})}),wl(t),ba(t),r&&cr()}}function ba(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)$i(t,e[r]);var i=t._PSD;--i.ref||i.finalize(),ut===0&&(++ut,Xt(function(){--ut===0&&Bi()},[]))}function $i(t,e){if(t._state===null){t._listeners.push(e);return}var r=t._state?e.onFulfilled:e.onRejected;if(r===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++ut,Xt(ml,[r,t,e])}function ml(t,e,r){try{Gn=e;var n,i=e._value;e._state?n=t(i):(kr.length&&(kr=[]),n=t(i),kr.indexOf(i)===-1&&bl(e)),r.resolve(n)}catch(s){r.reject(s)}finally{Gn=null,--ut===0&&Bi(),--r.psd.ref||r.psd.finalize()}}function Aa(t,e,r){if(e.length===r)return e;var n="";if(t._state===!1){var i=t._value,s,a;i!=null?(s=i.name||"Error",a=i.message||i,n=Hn(i,0)):(s=i,a=""),e.push(s+(a?": "+a:"")+n)}return Ce&&(n=Hn(t._stackHolder,2),n&&e.indexOf(n)===-1&&e.push(n),t._prev&&Aa(t._prev,e,r)),e}function Ta(t,e){var r=e?e._numPrev+1:0;r<vl&&(t._prev=e,t._numPrev=r)}function gr(){ur()&&cr()}function ur(){var t=Jn;return Jn=!1,Ur=!1,t}function cr(){var t,e,r;do for(;Ft.length>0;)for(t=Ft,Ft=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}while(Ft.length>0);Jn=!0,Ur=!0}function Bi(){var t=lt;lt=[],t.forEach(function(n){n._PSD.onunhandled.call(null,n._value,n)});for(var e=Ir.slice(0),r=e.length;r;)e[--r]()}function _l(t){function e(){t(),Ir.splice(Ir.indexOf(e),1)}Ir.push(e),++ut,Xt(function(){--ut===0&&Bi()},[])}function wl(t){lt.some(function(e){return e._value===t._value})||lt.push(t)}function bl(t){for(var e=lt.length;e;)if(lt[--e]._value===t._value){lt.splice(e,1);return}}function Cr(t){return new O(Yt,!1,t)}function J(t,e){var r=k;return function(){var n=ur(),i=k;try{return Ye(r,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{Ye(i,!1),n&&cr()}}}var he={awaits:0,echoes:0,id:0},Al=0,xr=[],Tn=0,Kr=0,Tl=0;function Qe(t,e,r,n){var i=k,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++Tl;var a=kt.env;s.env=ji?{Promise:O,PromiseProp:{value:O,configurable:!0,writable:!0},all:O.all,race:O.race,allSettled:O.allSettled,any:O.any,resolve:O.resolve,reject:O.reject,nthen:gs(a.nthen,s),gthen:gs(a.gthen,s)}:{},e&&ve(s,e),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=$t(s,t,r,n);return s.ref===0&&s.finalize(),o}function jt(){return he.id||(he.id=++Al),++he.awaits,he.echoes+=ya,he.id}function Ke(){return he.awaits?(--he.awaits===0&&(he.id=0),he.echoes=he.awaits*ya,!0):!1}(""+ma).indexOf("[native code]")===-1&&(jt=Ke=H);function qr(t){return he.echoes&&t&&t.constructor===Sr?(jt(),t.then(function(e){return Ke(),e},function(e){return Ke(),ie(e)})):t}function Pl(t){++Kr,(!he.echoes||--he.echoes===0)&&(he.echoes=he.id=0),xr.push(k),Ye(t,!0)}function El(){var t=xr[xr.length-1];xr.pop(),Ye(t,!1)}function Ye(t,e){var r=k;if((e?he.echoes&&(!Tn++||t!==k):Tn&&(!--Tn||t!==k))&&Ea(e?Pl.bind(null,t):El),t!==k&&(k=t,r===kt&&(kt.env=Pa()),ji)){var n=kt.env.Promise,i=t.env;Nr.then=i.nthen,n.prototype.then=i.gthen,(r.global||t.global)&&(Object.defineProperty(V,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function Pa(){var t=V.Promise;return ji?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(V,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Nr.then,gthen:t.prototype.then}:{}}function $t(t,e,r,n,i){var s=k;try{return Ye(t,!0),e(r,n,i)}finally{Ye(s,!1)}}function Ea(t){ma.call(Wn,t)}function Fr(t,e,r,n){return typeof t!="function"?t:function(){var i=k;r&&jt(),Ye(e,!0);try{return t.apply(this,arguments)}finally{Ye(i,!1),n&&Ea(Ke)}}}function gs(t,e){return function(r,n){return t.call(this,Fr(r,e),Fr(n,e))}}var ys="unhandledrejection";function ms(t,e){var r;try{r=e.onuncatched(t)}catch{}if(r!==!1)try{var n,i={promise:e,reason:t};if(V.document&&document.createEvent?(n=document.createEvent("Event"),n.initEvent(ys,!0,!0),ve(n,i)):V.CustomEvent&&(n=new CustomEvent(ys,{detail:i}),ve(n,i)),n&&V.dispatchEvent&&(dispatchEvent(n),!V.PromiseRejectionEvent&&V.onunhandledrejection))try{V.onunhandledrejection(n)}catch{}Ce&&n&&!n.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var ie=O.reject;function Zn(t,e,r,n){if(!t.idbdb||!t._state.openComplete&&!k.letThrough&&!t._vip){if(t._state.openComplete)return ie(new x.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return ie(new x.DatabaseClosed);t.open().catch(H)}return t._state.dbReadyPromise.then(function(){return Zn(t,e,r,n)})}else{var i=t._createTransaction(e,r,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===Ri.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Zn(t,e,r,n)})):ie(s)}return i._promise(e,function(s,a){return Qe(function(){return k.trans=i,n(s,a,i)})}).then(function(s){return i._completion.then(function(){return s})})}}var _s="3.2.5",ot=String.fromCharCode(65535),ei=-1/0,xe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Oa="String expected.",zt=[],sn=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ol=sn,Sl=sn,Sa=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},an="__dbnames",Pn="readonly",En="readwrite";function pt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var ka={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function yr(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=or(e),delete e[t]),e}:function(e){return e}}var kl=function(){function t(){}return t.prototype._trans=function(e,r,n){var i=this._tx||k.trans,s=this.name;function a(l,u,c){if(!c.schema[s])throw new x.NotFound("Table "+s+" not part of transaction");return r(c.idbtrans,c)}var o=ur();try{return i&&i.db===this.db?i===k.trans?i._promise(e,a,n):Qe(function(){return i._promise(e,a,n)},{trans:i,transless:k.transless||k}):Zn(this.db,e,[this.name],a)}finally{o&&cr()}},t.prototype.get=function(e,r){var n=this;return e&&e.constructor===Object?this.where(e).first(r):this._trans("readonly",function(i){return n.core.get({trans:i,key:e}).then(function(s){return n.hook.reading.fire(s)})}).then(r)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(fe(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var r=ne(e);if(r.length===1)return this.where(r[0]).equals(e[r[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(d){if(d.compound&&r.every(function(f){return d.keyPath.indexOf(f)>=0})){for(var h=0;h<r.length;++h)if(r.indexOf(d.keyPath[h])===-1)return!1;return!0}return!1}).sort(function(d,h){return d.keyPath.length-h.keyPath.length})[0];if(n&&this.db._maxKey!==ot){var i=n.keyPath.slice(0,r.length);return this.where(i).equals(i.map(function(d){return e[d]}))}!n&&Ce&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+r.join("+")+"]"));var s=this.schema.idxByName,a=this.db._deps.indexedDB;function o(d,h){try{return a.cmp(d,h)===0}catch{return!1}}var l=r.reduce(function(d,h){var f=d[0],p=d[1],v=s[h],y=e[h];return[f||v,f||!v?pt(p,v&&v.multi?function(b){var _=Le(b,h);return fe(_)&&_.some(function(g){return o(y,g)})}:function(b){return o(y,Le(b,h))}):p]},[null,null]),u=l[0],c=l[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(c):n?this.filter(c):this.where(r).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,fe(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var r=function(n){if(!n)return n;var i=Object.create(e.prototype);for(var s in n)if(be(n,s))try{i[s]=n[s]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),e},t.prototype.defineClass=function(){function e(r){ve(this,r)}return this.mapToClass(e)},t.prototype.add=function(e,r){var n=this,i=this.schema.primKey,s=i.auto,a=i.keyPath,o=e;return a&&s&&(o=yr(a)(e)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"add",keys:r!=null?[r]:null,values:[o]})}).then(function(l){return l.numFailures?O.reject(l.failures[0]):l.lastResult}).then(function(l){if(a)try{Ee(e,a,l)}catch{}return l})},t.prototype.update=function(e,r){if(typeof e=="object"&&!fe(e)){var n=Le(e,this.schema.primKey.keyPath);if(n===void 0)return ie(new x.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?ne(r).forEach(function(i){Ee(e,i,r[i])}):r(e,{value:e,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}else return this.where(":id").equals(e).modify(r)},t.prototype.put=function(e,r){var n=this,i=this.schema.primKey,s=i.auto,a=i.keyPath,o=e;return a&&s&&(o=yr(a)(e)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"put",values:[o],keys:r!=null?[r]:null})}).then(function(l){return l.numFailures?O.reject(l.failures[0]):l.lastResult}).then(function(l){if(a)try{Ee(e,a,l)}catch{}return l})},t.prototype.delete=function(e){var r=this;return this._trans("readwrite",function(n){return r.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?O.reject(n.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(r){return e.core.mutate({trans:r,type:"deleteRange",range:ka})}).then(function(r){return r.numFailures?O.reject(r.failures[0]):void 0})},t.prototype.bulkGet=function(e){var r=this;return this._trans("readonly",function(n){return r.core.getMany({keys:e,trans:n}).then(function(i){return i.map(function(s){return r.hook.reading.fire(s)})})})},t.prototype.bulkAdd=function(e,r,n){var i=this,s=Array.isArray(r)?r:void 0;n=n||(s?void 0:r);var a=n?n.allKeys:void 0;return this._trans("readwrite",function(o){var l=i.schema.primKey,u=l.auto,c=l.keyPath;if(c&&s)throw new x.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new x.InvalidArgument("Arguments objects and keys must have the same length");var d=e.length,h=c&&u?e.map(yr(c)):e;return i.core.mutate({trans:o,type:"add",keys:s,values:h,wantResults:a}).then(function(f){var p=f.numFailures,v=f.results,y=f.lastResult,b=f.failures,_=a?v:y;if(p===0)return _;throw new Wt(i.name+".bulkAdd(): "+p+" of "+d+" operations failed",b)})})},t.prototype.bulkPut=function(e,r,n){var i=this,s=Array.isArray(r)?r:void 0;n=n||(s?void 0:r);var a=n?n.allKeys:void 0;return this._trans("readwrite",function(o){var l=i.schema.primKey,u=l.auto,c=l.keyPath;if(c&&s)throw new x.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new x.InvalidArgument("Arguments objects and keys must have the same length");var d=e.length,h=c&&u?e.map(yr(c)):e;return i.core.mutate({trans:o,type:"put",keys:s,values:h,wantResults:a}).then(function(f){var p=f.numFailures,v=f.results,y=f.lastResult,b=f.failures,_=a?v:y;if(p===0)return _;throw new Wt(i.name+".bulkPut(): "+p+" of "+d+" operations failed",b)})})},t.prototype.bulkDelete=function(e){var r=this,n=e.length;return this._trans("readwrite",function(i){return r.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var s=i.numFailures,a=i.lastResult,o=i.failures;if(s===0)return a;throw new Wt(r.name+".bulkDelete(): "+s+" of "+n+" operations failed",o)})},t}();function dr(t){var e={},r=function(o,l){if(l){for(var u=arguments.length,c=new Array(u-1);--u;)c[u-1]=arguments[u];return e[o].subscribe.apply(null,c),t}else if(typeof o=="string")return e[o]};r.addEventType=s;for(var n=1,i=arguments.length;n<i;++n)s(arguments[n]);return r;function s(o,l,u){if(typeof o=="object")return a(o);l||(l=pl),u||(u=H);var c={subscribers:[],fire:u,subscribe:function(d){c.subscribers.indexOf(d)===-1&&(c.subscribers.push(d),c.fire=l(c.fire,d))},unsubscribe:function(d){c.subscribers=c.subscribers.filter(function(h){return h!==d}),c.fire=c.subscribers.reduce(l,u)}};return e[o]=r[o]=c,c}function a(o){ne(o).forEach(function(l){var u=o[l];if(fe(u))s(l,o[l][0],o[l][1]);else if(u==="asap")var c=s(l,lr,function(){for(var h=arguments.length,f=new Array(h);h--;)f[h]=arguments[h];c.subscribers.forEach(function(p){la(function(){p.apply(null,f)})})});else throw new x.InvalidArgument("Invalid event config")})}}function hr(t,e){return Dt(e).from({prototype:t}),e}function Il(t){return hr(kl.prototype,function(r,n,i){this.db=t,this._tx=i,this.name=r,this.schema=n,this.hook=t._allTables[r]?t._allTables[r].hook:dr(null,{creating:[dl,H],reading:[cl,lr],updating:[fl,H],deleting:[hl,H]})})}function yt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function On(t,e){t.filter=pt(t.filter,e)}function Sn(t,e,r){var n=t.replayFilter;t.replayFilter=n?function(){return pt(n(),e())}:e,t.justLimit=r&&!n}function Cl(t,e){t.isMatch=pt(t.isMatch,e)}function Rr(t,e){if(t.isPrimKey)return e.primaryKey;var r=e.getIndexByKeyPath(t.index);if(!r)throw new x.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return r}function ws(t,e,r){var n=Rr(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:n,range:t.range}})}function mr(t,e,r,n){var i=t.replayFilter?pt(t.filter,t.replayFilter()):t.filter;if(t.or){var s={},a=function(o,l,u){if(!i||i(l,u,function(h){return l.stop(h)},function(h){return l.fail(h)})){var c=l.primaryKey,d=""+c;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(c)),be(s,d)||(s[d]=!0,e(o,l,u))}};return Promise.all([t.or._iterate(a,r),bs(ws(t,n,r),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}else return bs(ws(t,n,r),pt(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function bs(t,e,r,n){var i=n?function(a,o,l){return r(n(a),o,l)}:r,s=J(i);return t.then(function(a){if(a)return a.start(function(){var o=function(){return a.continue()};(!e||e(a,function(l){return o=l},function(l){a.stop(l),o=H},function(l){a.fail(l),o=H}))&&s(a.value,a,function(l){return o=l}),o()})})}function pe(t,e){try{var r=As(t),n=As(e);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return Rl(Ts(t),Ts(e));case"Array":return xl(t,e)}}catch{}return NaN}function xl(t,e){for(var r=t.length,n=e.length,i=r<n?r:n,s=0;s<i;++s){var a=pe(t[s],e[s]);if(a!==0)return a}return r===n?0:r<n?-1:1}function Rl(t,e){for(var r=t.length,n=e.length,i=r<n?r:n,s=0;s<i;++s)if(t[s]!==e[s])return t[s]<e[s]?-1:1;return r===n?0:r<n?-1:1}function As(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var r=qn(t);return r==="ArrayBuffer"?"binary":r}function Ts(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var Dl=function(){function t(){}return t.prototype._read=function(e,r){var n=this._ctx;return n.error?n.table._trans(null,ie.bind(null,n.error)):n.table._trans("readonly",e).then(r)},t.prototype._write=function(e){var r=this._ctx;return r.error?r.table._trans(null,ie.bind(null,r.error)):r.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var r=this._ctx;r.algorithm=pt(r.algorithm,e)},t.prototype._iterate=function(e,r){return mr(this._ctx,e,r,this._ctx.table.core)},t.prototype.clone=function(e){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&ve(n,e),r._ctx=n,r},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var r=this._ctx;return this._read(function(n){return mr(r,e,n,r.table.core)})},t.prototype.count=function(e){var r=this;return this._read(function(n){var i=r._ctx,s=i.table.core;if(yt(i,!0))return s.count({trans:n,query:{index:Rr(i,s.schema),range:i.range}}).then(function(o){return Math.min(o,i.limit)});var a=0;return mr(i,function(){return++a,!1},n,s).then(function(){return a})}).then(e)},t.prototype.sortBy=function(e,r){var n=e.split(".").reverse(),i=n[0],s=n.length-1;function a(u,c){return c?a(u[n[c]],c-1):u[i]}var o=this._ctx.dir==="next"?1:-1;function l(u,c){var d=a(u,s),h=a(c,s);return d<h?-o:d>h?o:0}return this.toArray(function(u){return u.sort(l)}).then(r)},t.prototype.toArray=function(e){var r=this;return this._read(function(n){var i=r._ctx;if(i.dir==="next"&&yt(i,!0)&&i.limit>0){var s=i.valueMapper,a=Rr(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:a,range:i.range}}).then(function(l){var u=l.result;return s?u.map(s):u})}else{var o=[];return mr(i,function(l){return o.push(l)},n,i.table.core).then(function(){return o})}},e)},t.prototype.offset=function(e){var r=this._ctx;return e<=0?this:(r.offset+=e,yt(r)?Sn(r,function(){var n=e;return function(i,s){return n===0?!0:n===1?(--n,!1):(s(function(){i.advance(n),n=0}),!1)}}):Sn(r,function(){var n=e;return function(){return--n<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Sn(this._ctx,function(){var r=e;return function(n,i,s){return--r<=0&&i(s),r>=0}},!0),this},t.prototype.until=function(e,r){return On(this._ctx,function(n,i,s){return e(n.value)?(i(s),r):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(r){return r[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return On(this._ctx,function(r){return e(r.value)}),Cl(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,s){n.push(s.key)}).then(function(){return n}).then(e)},t.prototype.primaryKeys=function(e){var r=this._ctx;if(r.dir==="next"&&yt(r,!0)&&r.limit>0)return this._read(function(i){var s=Rr(r,r.table.core.schema);return r.table.core.query({trans:i,values:!1,limit:r.limit,query:{index:s,range:r.range}})}).then(function(i){var s=i.result;return s}).then(e);r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,s){n.push(s.primaryKey)}).then(function(){return n}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(r){return r[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,r=e.index&&e.table.schema.idxByName[e.index];if(!r||!r.multi)return this;var n={};return On(this._ctx,function(i){var s=i.primaryKey.toString(),a=be(n,s);return n[s]=!0,!a}),this},t.prototype.modify=function(e){var r=this,n=this._ctx;return this._write(function(i){var s;if(typeof e=="function")s=e;else{var a=ne(e),o=a.length;s=function(b){for(var _=!1,g=0;g<o;++g){var w=a[g],m=e[w];Le(b,w)!==m&&(Ee(b,w,m),_=!0)}return _}}var l=n.table.core,u=l.schema.primaryKey,c=u.outbound,d=u.extractKey,h=r.db._options.modifyChunkSize||200,f=[],p=0,v=[],y=function(b,_){var g=_.failures,w=_.numFailures;p+=b-w;for(var m=0,A=ne(g);m<A.length;m++){var T=A[m];f.push(g[T])}};return r.clone().primaryKeys().then(function(b){var _=function(g){var w=Math.min(h,b.length-g);return l.getMany({trans:i,keys:b.slice(g,g+w),cache:"immutable"}).then(function(m){for(var A=[],T=[],P=c?[]:null,S=[],I=0;I<w;++I){var U=m[I],K={value:or(U),primKey:b[g+I]};s.call(K,K.value,K)!==!1&&(K.value==null?S.push(b[g+I]):!c&&pe(d(U),d(K.value))!==0?(S.push(b[g+I]),A.push(K.value)):(T.push(K.value),c&&P.push(b[g+I])))}var B=yt(n)&&n.limit===1/0&&(typeof e!="function"||e===kn)&&{index:n.index,range:n.range};return Promise.resolve(A.length>0&&l.mutate({trans:i,type:"add",values:A}).then(function(G){for(var C in G.failures)S.splice(parseInt(C),1);y(A.length,G)})).then(function(){return(T.length>0||B&&typeof e=="object")&&l.mutate({trans:i,type:"put",keys:P,values:T,criteria:B,changeSpec:typeof e!="function"&&e}).then(function(G){return y(T.length,G)})}).then(function(){return(S.length>0||B&&e===kn)&&l.mutate({trans:i,type:"delete",keys:S,criteria:B}).then(function(G){return y(S.length,G)})}).then(function(){return b.length>g+w&&_(g+h)})})};return _(0).then(function(){if(f.length>0)throw new Lr("Error modifying one or more objects",f,p,v);return b.length})})})},t.prototype.delete=function(){var e=this._ctx,r=e.range;return yt(e)&&(e.isPrimKey&&!Sl||r.type===3)?this._write(function(n){var i=e.table.core.schema.primaryKey,s=r;return e.table.core.count({trans:n,query:{index:i,range:s}}).then(function(a){return e.table.core.mutate({trans:n,type:"deleteRange",range:s}).then(function(o){var l=o.failures;o.lastResult,o.results;var u=o.numFailures;if(u)throw new Lr("Could not delete some values",Object.keys(l).map(function(c){return l[c]}),a-u);return a-u})})}):this.modify(kn)},t}(),kn=function(t,e){return e.value=null};function Ml(t){return hr(Dl.prototype,function(r,n){this.db=t;var i=ka,s=null;if(n)try{i=n()}catch(u){s=u}var a=r._ctx,o=a.table,l=o.hook.reading.fire;this._ctx={table:o,index:a.index,isPrimKey:!a.index||o.schema.primKey.keyPath&&a.index===o.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:s,or:a.or,valueMapper:l!==lr?l:null}})}function jl(t,e){return t<e?-1:t===e?0:1}function $l(t,e){return t>e?-1:t===e?0:1}function we(t,e,r){var n=t instanceof Ca?new t.Collection(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function mt(t){return new t.Collection(t,function(){return Ia("")}).limit(0)}function Bl(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function Ll(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function Nl(t,e,r,n,i,s){for(var a=Math.min(t.length,n.length),o=-1,l=0;l<a;++l){var u=e[l];if(u!==n[l])return i(t[l],r[l])<0?t.substr(0,l)+r[l]+r.substr(l+1):i(t[l],n[l])<0?t.substr(0,l)+n[l]+r.substr(l+1):o>=0?t.substr(0,o)+e[o]+r.substr(o+1):null;i(t[l],u)<0&&(o=l)}return a<n.length&&s==="next"?t+r.substr(t.length):a<t.length&&s==="prev"?t.substr(0,r.length):o<0?null:t.substr(0,o)+n[o]+r.substr(o+1)}function _r(t,e,r,n){var i,s,a,o,l,u,c,d=r.length;if(!r.every(function(v){return typeof v=="string"}))return we(t,Oa);function h(v){i=Bl(v),s=Ll(v),a=v==="next"?jl:$l;var y=r.map(function(b){return{lower:s(b),upper:i(b)}}).sort(function(b,_){return a(b.lower,_.lower)});o=y.map(function(b){return b.upper}),l=y.map(function(b){return b.lower}),u=v,c=v==="next"?"":n}h("next");var f=new t.Collection(t,function(){return He(o[0],l[d-1]+n)});f._ondirectionchange=function(v){h(v)};var p=0;return f._addAlgorithm(function(v,y,b){var _=v.key;if(typeof _!="string")return!1;var g=s(_);if(e(g,l,p))return!0;for(var w=null,m=p;m<d;++m){var A=Nl(_,g,o[m],l[m],a,u);A===null&&w===null?p=m+1:(w===null||a(w,A)>0)&&(w=A)}return y(w!==null?function(){v.continue(w+c)}:b),!1}),f}function He(t,e,r,n){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:n}}function Ia(t){return{type:1,lower:t,upper:t}}var Ca=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,r,n,i){n=n!==!1,i=i===!0;try{return this._cmp(e,r)>0||this._cmp(e,r)===0&&(n||i)&&!(n&&i)?mt(this):new this.Collection(this,function(){return He(e,r,!n,!i)})}catch{return we(this,xe)}},t.prototype.equals=function(e){return e==null?we(this,xe):new this.Collection(this,function(){return Ia(e)})},t.prototype.above=function(e){return e==null?we(this,xe):new this.Collection(this,function(){return He(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?we(this,xe):new this.Collection(this,function(){return He(e,void 0,!1)})},t.prototype.below=function(e){return e==null?we(this,xe):new this.Collection(this,function(){return He(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?we(this,xe):new this.Collection(this,function(){return He(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?we(this,Oa):this.between(e,e+ot,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):_r(this,function(r,n){return r.indexOf(n[0])===0},[e],ot)},t.prototype.equalsIgnoreCase=function(e){return _r(this,function(r,n){return r===n[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=$e.apply(Pt,arguments);return e.length===0?mt(this):_r(this,function(r,n){return n.indexOf(r)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=$e.apply(Pt,arguments);return e.length===0?mt(this):_r(this,function(r,n){return n.some(function(i){return r.indexOf(i)===0})},e,ot)},t.prototype.anyOf=function(){var e=this,r=$e.apply(Pt,arguments),n=this._cmp;try{r.sort(n)}catch{return we(this,xe)}if(r.length===0)return mt(this);var i=new this.Collection(this,function(){return He(r[0],r[r.length-1])});i._ondirectionchange=function(a){n=a==="next"?e._ascending:e._descending,r.sort(n)};var s=0;return i._addAlgorithm(function(a,o,l){for(var u=a.key;n(u,r[s])>0;)if(++s,s===r.length)return o(l),!1;return n(u,r[s])===0?!0:(o(function(){a.continue(r[s])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[ei,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=$e.apply(Pt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return we(this,xe)}var r=e.reduce(function(n,i){return n?n.concat([[n[n.length-1][1],i]]):[[ei,i]]},null);return r.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,r){var n=this,i=this._cmp,s=this._ascending,a=this._descending,o=this._min,l=this._max;if(e.length===0)return mt(this);if(!e.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&s(m[0],m[1])<=0}))return we(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",x.InvalidArgument);var u=!r||r.includeLowers!==!1,c=r&&r.includeUppers===!0;function d(m,A){for(var T=0,P=m.length;T<P;++T){var S=m[T];if(i(A[0],S[1])<0&&i(A[1],S[0])>0){S[0]=o(S[0],A[0]),S[1]=l(S[1],A[1]);break}}return T===P&&m.push(A),m}var h=s;function f(m,A){return h(m[0],A[0])}var p;try{p=e.reduce(d,[]),p.sort(f)}catch{return we(this,xe)}var v=0,y=c?function(m){return s(m,p[v][1])>0}:function(m){return s(m,p[v][1])>=0},b=u?function(m){return a(m,p[v][0])>0}:function(m){return a(m,p[v][0])>=0};function _(m){return!y(m)&&!b(m)}var g=y,w=new this.Collection(this,function(){return He(p[0][0],p[p.length-1][1],!u,!c)});return w._ondirectionchange=function(m){m==="next"?(g=y,h=s):(g=b,h=a),p.sort(f)},w._addAlgorithm(function(m,A,T){for(var P=m.key;g(P);)if(++v,v===p.length)return A(T),!1;return _(P)?!0:(n._cmp(P,p[v][1])===0||n._cmp(P,p[v][0])===0||A(function(){h===s?m.continue(p[v][0]):m.continue(p[v][1])}),!1)}),w},t.prototype.startsWithAnyOf=function(){var e=$e.apply(Pt,arguments);return e.every(function(r){return typeof r=="string"})?e.length===0?mt(this):this.inAnyRange(e.map(function(r){return[r,r+ot]})):we(this,"startsWithAnyOf() only works with strings")},t}();function Ul(t){return hr(Ca.prototype,function(r,n,i){this.db=t,this._ctx={table:r,index:n===":id"?null:n,or:i};var s=t._deps.indexedDB;if(!s)throw new x.MissingAPI;this._cmp=this._ascending=s.cmp.bind(s),this._descending=function(a,o){return s.cmp(o,a)},this._max=function(a,o){return s.cmp(a,o)>0?a:o},this._min=function(a,o){return s.cmp(a,o)<0?a:o},this._IDBKeyRange=t._deps.IDBKeyRange})}function Se(t){return J(function(e){return Zt(e),t(e.target.error),!1})}function Zt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var er="storagemutated",Ge="x-storagemutated-1",Xe=dr(null,er),Kl=function(){function t(){}return t.prototype._lock=function(){return qt(!k.global),++this._reculock,this._reculock===1&&!k.global&&(k.lockOwnerFor=this),this},t.prototype._unlock=function(){if(qt(!k.global),--this._reculock===0)for(k.global||(k.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{$t(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&k.lockOwnerFor!==this},t.prototype.create=function(e){var r=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if(qt(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new x.DatabaseClosed(i);case"MissingAPIError":throw new x.MissingAPI(i.message,i);default:throw new x.OpenFailed(i)}if(!this.active)throw new x.TransactionInactive;return qt(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=J(function(s){Zt(s),r._reject(e.error)}),e.onabort=J(function(s){Zt(s),r.active&&r._reject(new x.Abort(e.error)),r.active=!1,r.on("abort").fire(s)}),e.oncomplete=J(function(){r.active=!1,r._resolve(),"mutatedParts"in e&&Xe.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,r,n){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return ie(new x.ReadOnly("Transaction is readonly"));if(!this.active)return ie(new x.TransactionInactive);if(this._locked())return new O(function(a,o){i._blockedFuncs.push([function(){i._promise(e,r,n).then(a,o)},k])});if(n)return Qe(function(){var a=new O(function(o,l){i._lock();var u=r(o,l,i);u&&u.then&&u.then(o,l)});return a.finally(function(){return i._unlock()}),a._lib=!0,a});var s=new O(function(a,o){var l=r(a,o,i);l&&l.then&&l.then(a,o)});return s._lib=!0,s},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var r=this._root(),n=O.resolve(e);if(r._waitingFor)r._waitingFor=r._waitingFor.then(function(){return n});else{r._waitingFor=n,r._waitingQueue=[];var i=r.idbtrans.objectStore(r.storeNames[0]);(function a(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(i.get(-1/0).onsuccess=a)})()}var s=r._waitingFor;return new O(function(a,o){n.then(function(l){return r._waitingQueue.push(J(a.bind(null,l)))},function(l){return r._waitingQueue.push(J(o.bind(null,l)))}).finally(function(){r._waitingFor===s&&(r._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new x.Abort))},t.prototype.table=function(e){var r=this._memoizedTables||(this._memoizedTables={});if(be(r,e))return r[e];var n=this.schema[e];if(!n)throw new x.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,n,this);return i.core=this.db.core.table(e),r[e]=i,i},t}();function ql(t){return hr(Kl.prototype,function(r,n,i,s,a){var o=this;this.db=t,this.mode=r,this.storeNames=n,this.schema=i,this.chromeTransactionDurability=s,this.idbtrans=null,this.on=dr(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new O(function(l,u){o._resolve=l,o._reject=u}),this._completion.then(function(){o.active=!1,o.on.complete.fire()},function(l){var u=o.active;return o.active=!1,o.on.error.fire(l),o.parent?o.parent._reject(l):u&&o.idbtrans&&o.idbtrans.abort(),ie(l)})})}function ti(t,e,r,n,i,s,a){return{name:t,keyPath:e,unique:r,multi:n,auto:i,compound:s,src:(r&&!a?"&":"")+(n?"*":"")+(i?"++":"")+xa(e)}}function xa(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Ra(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:ua(r,function(n){return[n.name,n]})}}function Fl(t){return t.length===1?t[0]:t}var tr=function(t){try{return t.only([[]]),tr=function(){return[[]]},[[]]}catch{return tr=function(){return ot},ot}};function ri(t){return t==null?function(){}:typeof t=="string"?Hl(t):function(e){return Le(e,t)}}function Hl(t){var e=t.split(".");return e.length===1?function(r){return r[t]}:function(r){return Le(r,t)}}function Ps(t){return[].slice.call(t)}var Wl=0;function Vt(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function zl(t,e,r){function n(d,h){var f=Ps(d.objectStoreNames);return{schema:{name:d.name,tables:f.map(function(p){return h.objectStore(p)}).map(function(p){var v=p.keyPath,y=p.autoIncrement,b=fe(v),_=v==null,g={},w={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_,compound:b,keyPath:v,autoIncrement:y,unique:!0,extractKey:ri(v)},indexes:Ps(p.indexNames).map(function(m){return p.index(m)}).map(function(m){var A=m.name,T=m.unique,P=m.multiEntry,S=m.keyPath,I=fe(S),U={name:A,compound:I,keyPath:S,unique:T,multiEntry:P,extractKey:ri(S)};return g[Vt(S)]=U,U}),getIndexByKeyPath:function(m){return g[Vt(m)]}};return g[":id"]=w.primaryKey,v!=null&&(g[Vt(v)]=w.primaryKey),w})},hasGetAll:f.length>0&&"getAll"in h.objectStore(f[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(d){if(d.type===3)return null;if(d.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=d.lower,f=d.upper,p=d.lowerOpen,v=d.upperOpen,y=h===void 0?f===void 0?null:e.upperBound(f,!!v):f===void 0?e.lowerBound(h,!!p):e.bound(h,f,!!p,!!v);return y}function s(d){var h=d.name;function f(y){var b=y.trans,_=y.type,g=y.keys,w=y.values,m=y.range;return new Promise(function(A,T){A=J(A);var P=b.objectStore(h),S=P.keyPath==null,I=_==="put"||_==="add";if(!I&&_!=="delete"&&_!=="deleteRange")throw new Error("Invalid operation type: "+_);var U=(g||w||{length:1}).length;if(g&&w&&g.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(U===0)return A({numFailures:0,failures:{},results:[],lastResult:void 0});var K,B=[],G=[],C=0,Q=function(le){++C,Zt(le)};if(_==="deleteRange"){if(m.type===4)return A({numFailures:C,failures:G,results:[],lastResult:void 0});m.type===3?B.push(K=P.clear()):B.push(K=P.delete(i(m)))}else{var X=I?S?[w,g]:[w,null]:[g,null],oe=X[0],ee=X[1];if(I)for(var te=0;te<U;++te)B.push(K=ee&&ee[te]!==void 0?P[_](oe[te],ee[te]):P[_](oe[te])),K.onerror=Q;else for(var te=0;te<U;++te)B.push(K=P[_](oe[te])),K.onerror=Q}var ce=function(le){var z=le.target.result;B.forEach(function(Z,ue){return Z.error!=null&&(G[ue]=Z.error)}),A({numFailures:C,failures:G,results:_==="delete"?g:B.map(function(Z){return Z.result}),lastResult:z})};K.onerror=function(le){Q(le),ce(le)},K.onsuccess=ce})}function p(y){var b=y.trans,_=y.values,g=y.query,w=y.reverse,m=y.unique;return new Promise(function(A,T){A=J(A);var P=g.index,S=g.range,I=b.objectStore(h),U=P.isPrimaryKey?I:I.index(P.name),K=w?m?"prevunique":"prev":m?"nextunique":"next",B=_||!("openKeyCursor"in U)?U.openCursor(i(S),K):U.openKeyCursor(i(S),K);B.onerror=Se(T),B.onsuccess=J(function(G){var C=B.result;if(!C){A(null);return}C.___id=++Wl,C.done=!1;var Q=C.continue.bind(C),X=C.continuePrimaryKey;X&&(X=X.bind(C));var oe=C.advance.bind(C),ee=function(){throw new Error("Cursor not started")},te=function(){throw new Error("Cursor not stopped")};C.trans=b,C.stop=C.continue=C.continuePrimaryKey=C.advance=ee,C.fail=J(T),C.next=function(){var ce=this,le=1;return this.start(function(){return le--?ce.continue():ce.stop()}).then(function(){return ce})},C.start=function(ce){var le=new Promise(function(Z,ue){Z=J(Z),B.onerror=Se(ue),C.fail=ue,C.stop=function($){C.stop=C.continue=C.continuePrimaryKey=C.advance=te,Z($)}}),z=function(){if(B.result)try{ce()}catch(Z){C.fail(Z)}else C.done=!0,C.start=function(){throw new Error("Cursor behind last entry")},C.stop()};return B.onsuccess=J(function(Z){B.onsuccess=z,z()}),C.continue=Q,C.continuePrimaryKey=X,C.advance=oe,z(),le},A(C)},T)})}function v(y){return function(b){return new Promise(function(_,g){_=J(_);var w=b.trans,m=b.values,A=b.limit,T=b.query,P=A===1/0?void 0:A,S=T.index,I=T.range,U=w.objectStore(h),K=S.isPrimaryKey?U:U.index(S.name),B=i(I);if(A===0)return _({result:[]});if(y){var G=m?K.getAll(B,P):K.getAllKeys(B,P);G.onsuccess=function(oe){return _({result:oe.target.result})},G.onerror=Se(g)}else{var C=0,Q=m||!("openKeyCursor"in K)?K.openCursor(B):K.openKeyCursor(B),X=[];Q.onsuccess=function(oe){var ee=Q.result;if(!ee)return _({result:X});if(X.push(m?ee.value:ee.primaryKey),++C===A)return _({result:X});ee.continue()},Q.onerror=Se(g)}})}}return{name:h,schema:d,mutate:f,getMany:function(y){var b=y.trans,_=y.keys;return new Promise(function(g,w){g=J(g);for(var m=b.objectStore(h),A=_.length,T=new Array(A),P=0,S=0,I,U=function(C){var Q=C.target;(T[Q._pos]=Q.result)!=null,++S===P&&g(T)},K=Se(w),B=0;B<A;++B){var G=_[B];G!=null&&(I=m.get(_[B]),I._pos=B,I.onsuccess=U,I.onerror=K,++P)}P===0&&g(T)})},get:function(y){var b=y.trans,_=y.key;return new Promise(function(g,w){g=J(g);var m=b.objectStore(h),A=m.get(_);A.onsuccess=function(T){return g(T.target.result)},A.onerror=Se(w)})},query:v(l),openCursor:p,count:function(y){var b=y.query,_=y.trans,g=b.index,w=b.range;return new Promise(function(m,A){var T=_.objectStore(h),P=g.isPrimaryKey?T:T.index(g.name),S=i(w),I=S?P.count(S):P.count();I.onsuccess=J(function(U){return m(U.target.result)}),I.onerror=Se(A)})}}}var a=n(t,r),o=a.schema,l=a.hasGetAll,u=o.tables.map(function(d){return s(d)}),c={};return u.forEach(function(d){return c[d.name]=d}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(d){var h=c[d];if(!h)throw new Error("Table '"+d+"' not found");return c[d]},MIN_KEY:-1/0,MAX_KEY:tr(e),schema:o}}function Vl(t,e){return e.reduce(function(r,n){var i=n.create;return q(q({},r),i(r))},t)}function Jl(t,e,r,n){var i=r.IDBKeyRange;r.indexedDB;var s=Vl(zl(e,i,n),t.dbcore);return{dbcore:s}}function Li(t,e){var r=t._novip,n=e.db,i=Jl(r._middlewares,n,r._deps,e);r.core=i.dbcore,r.tables.forEach(function(s){var a=s.name;r.core.schema.tables.some(function(o){return o.name===a})&&(s.core=r.core.table(a),r[a]instanceof r.Table&&(r[a].core=s.core))})}function Hr(t,e,r,n){var i=t._novip;r.forEach(function(s){var a=n[s];e.forEach(function(o){var l=Ii(o,s);(!l||"value"in l&&l.value===void 0)&&(o===i.Transaction.prototype||o instanceof i.Transaction?Ue(o,s,{get:function(){return this.table(s)},set:function(u){aa(this,s,{value:u,writable:!0,configurable:!0,enumerable:!0})}}):o[s]=new i.Table(s,a))})})}function ni(t,e){var r=t._novip;e.forEach(function(n){for(var i in n)n[i]instanceof r.Table&&delete n[i]})}function Gl(t,e){return t._cfg.version-e._cfg.version}function Ql(t,e,r,n){var i=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,i);s.create(r),s._completion.catch(n);var a=s._reject.bind(s),o=k.transless||k;Qe(function(){k.trans=s,k.transless=o,e===0?(ne(i).forEach(function(l){Ni(r,l,i[l].primKey,i[l].indexes)}),Li(t,r),O.follow(function(){return t.on.populate.fire(s)}).catch(a)):Yl(t,e,s,r).catch(a)})}function Yl(t,e,r,n){var i=t._novip,s=[],a=i._versions,o=i._dbSchema=Ui(i,i.idbdb,n),l=!1,u=a.filter(function(d){return d._cfg.version>=e});u.forEach(function(d){s.push(function(){var h=o,f=d._cfg.dbschema;si(i,h,n),si(i,f,n),o=i._dbSchema=f;var p=Da(h,f);p.add.forEach(function(w){Ni(n,w[0],w[1].primKey,w[1].indexes)}),p.change.forEach(function(w){if(w.recreate)throw new x.Upgrade("Not yet support for changing primary key");var m=n.objectStore(w.name);w.add.forEach(function(A){return ii(m,A)}),w.change.forEach(function(A){m.deleteIndex(A.name),ii(m,A)}),w.del.forEach(function(A){return m.deleteIndex(A)})});var v=d._cfg.contentUpgrade;if(v&&d._cfg.version>e){Li(i,n),r._memoizedTables={},l=!0;var y=ca(f);p.del.forEach(function(w){y[w]=h[w]}),ni(i,[i.Transaction.prototype]),Hr(i,[i.Transaction.prototype],ne(y),y),r.schema=y;var b=Ci(v);b&&jt();var _,g=O.follow(function(){if(_=v(r),_&&b){var w=Ke.bind(null,null);_.then(w,w)}});return _&&typeof _.then=="function"?O.resolve(_):g.then(function(){return _})}}),s.push(function(h){if(!l||!Ol){var f=d._cfg.dbschema;Zl(f,h)}ni(i,[i.Transaction.prototype]),Hr(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),r.schema=i._dbSchema})});function c(){return s.length?O.resolve(s.shift()(r.idbtrans)).then(c):O.resolve()}return c().then(function(){Xl(o,n)})}function Da(t,e){var r={del:[],add:[],change:[]},n;for(n in t)e[n]||r.del.push(n);for(n in e){var i=t[n],s=e[n];if(!i)r.add.push([n,s]);else{var a={name:n,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||i.primKey.auto!==s.primKey.auto&&!sn)a.recreate=!0,r.change.push(a);else{var o=i.idxByName,l=s.idxByName,u=void 0;for(u in o)l[u]||a.del.push(u);for(u in l){var c=o[u],d=l[u];c?c.src!==d.src&&a.change.push(d):a.add.push(d)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}}return r}function Ni(t,e,r,n){var i=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(function(s){return ii(i,s)}),i}function Xl(t,e){ne(t).forEach(function(r){e.db.objectStoreNames.contains(r)||Ni(e,r,t[r].primKey,t[r].indexes)})}function Zl(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(r){return t[r]==null&&e.db.deleteObjectStore(r)})}function ii(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Ui(t,e,r){var n={},i=rn(e.objectStoreNames,0);return i.forEach(function(s){for(var a=r.objectStore(s),o=a.keyPath,l=ti(xa(o),o||"",!1,!1,!!a.autoIncrement,o&&typeof o!="string",!0),u=[],c=0;c<a.indexNames.length;++c){var d=a.index(a.indexNames[c]);o=d.keyPath;var h=ti(d.name,o,!!d.unique,!!d.multiEntry,!1,o&&typeof o!="string",!1);u.push(h)}n[s]=Ra(s,l,u)}),n}function eu(t,e,r){var n=t._novip;n.verno=e.version/10;var i=n._dbSchema=Ui(n,e,r);n._storeNames=rn(e.objectStoreNames,0),Hr(n,[n._allTables],ne(i),i)}function tu(t,e){var r=Ui(t,t.idbdb,e),n=Da(r,t._dbSchema);return!(n.add.length||n.change.some(function(i){return i.add.length||i.change.length}))}function si(t,e,r){for(var n=t._novip,i=r.db.objectStoreNames,s=0;s<i.length;++s){var a=i[s],o=r.objectStore(a);n._hasGetAll="getAll"in o;for(var l=0;l<o.indexNames.length;++l){var u=o.indexNames[l],c=o.index(u).keyPath,d=typeof c=="string"?c:"["+rn(c).join("+")+"]";if(e[a]){var h=e[a].idxByName[d];h&&(h.name=u,delete e[a].idxByName[d],e[a].idxByName[u]=h)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&V.WorkerGlobalScope&&V instanceof V.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function ru(t){return t.split(",").map(function(e,r){e=e.trim();var n=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return ti(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),fe(i),r===0)})}var nu=function(){function t(){}return t.prototype._parseStoresSpec=function(e,r){ne(e).forEach(function(n){if(e[n]!==null){var i=ru(e[n]),s=i.shift();if(s.multi)throw new x.Schema("Primary key cannot be multi-valued");i.forEach(function(a){if(a.auto)throw new x.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new x.Schema("Index must have a name and cannot be an empty string")}),r[n]=Ra(n,s,i)}})},t.prototype.stores=function(e){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?ve(this._cfg.storesSource,e):e;var n=r._versions,i={},s={};return n.forEach(function(a){ve(i,a._cfg.storesSource),s=a._cfg.dbschema={},a._parseStoresSpec(i,s)}),r._dbSchema=s,ni(r,[r._allTables,r,r.Transaction.prototype]),Hr(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],ne(s),s),r._storeNames=ne(s),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Di(this._cfg.contentUpgrade||H,e),this},t}();function iu(t){return hr(nu.prototype,function(r){this.db=t,this._cfg={version:r,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Ki(t,e){var r=t._dbNamesDB;return r||(r=t._dbNamesDB=new Wi(an,{addons:[],indexedDB:t,IDBKeyRange:e}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function qi(t){return t&&typeof t.databases=="function"}function su(t){var e=t.indexedDB,r=t.IDBKeyRange;return qi(e)?Promise.resolve(e.databases()).then(function(n){return n.map(function(i){return i.name}).filter(function(i){return i!==an})}):Ki(e,r).toCollection().primaryKeys()}function au(t,e){var r=t.indexedDB,n=t.IDBKeyRange;!qi(r)&&e!==an&&Ki(r,n).put({name:e}).catch(H)}function ou(t,e){var r=t.indexedDB,n=t.IDBKeyRange;!qi(r)&&e!==an&&Ki(r,n).delete(e).catch(H)}function ai(t){return Qe(function(){return k.letThrough=!0,t()})}function lu(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(r){var n=function(){return indexedDB.databases().finally(r)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)})}function uu(t){var e=t._state,r=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?ie(e.dbOpenError):t});Ce&&(e.openCanceller._stackHolder=vt()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var n=e.openCanceller;function i(){if(e.openCanceller!==n)throw new x.DatabaseClosed("db.open() was cancelled")}var s=e.dbReadyResolve,a=null,o=!1,l=function(){return new O(function(u,c){if(i(),!r)throw new x.MissingAPI;var d=t.name,h=e.autoSchema?r.open(d):r.open(d,Math.round(t.verno*10));if(!h)throw new x.MissingAPI;h.onerror=Se(c),h.onblocked=J(t._fireOnBlocked),h.onupgradeneeded=J(function(f){if(a=h.transaction,e.autoSchema&&!t._options.allowEmptyDB){h.onerror=Zt,a.abort(),h.result.close();var p=r.deleteDatabase(d);p.onsuccess=p.onerror=J(function(){c(new x.NoSuchDatabase("Database "+d+" doesnt exist"))})}else{a.onerror=Se(c);var v=f.oldVersion>Math.pow(2,62)?0:f.oldVersion;o=v<1,t._novip.idbdb=h.result,Ql(t,v/10,a,c)}},c),h.onsuccess=J(function(){a=null;var f=t._novip.idbdb=h.result,p=rn(f.objectStoreNames);if(p.length>0)try{var v=f.transaction(Fl(p),"readonly");e.autoSchema?eu(t,f,v):(si(t,t._dbSchema,v),tu(t,v)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Li(t,v)}catch{}zt.push(t),f.onversionchange=J(function(y){e.vcFired=!0,t.on("versionchange").fire(y)}),f.onclose=J(function(y){t.on("close").fire(y)}),o&&au(t._deps,d),u()},c)}).catch(function(u){return u&&u.name==="UnknownError"&&e.PR1398_maxLoop>0?(e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l()):O.reject(u)})};return O.race([n,(typeof navigator=="undefined"?O.resolve():lu()).then(l)]).then(function(){return i(),e.onReadyBeingFired=[],O.resolve(ai(function(){return t.on.ready.fire(t.vip)})).then(function u(){if(e.onReadyBeingFired.length>0){var c=e.onReadyBeingFired.reduce(Di,H);return e.onReadyBeingFired=[],O.resolve(ai(function(){return c(t.vip)})).then(u)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(u){e.dbOpenError=u;try{a&&a.abort()}catch{}return n===e.openCanceller&&t._close(),ie(u)}).finally(function(){e.openComplete=!0,s()})}function oi(t){var e=function(a){return t.next(a)},r=function(a){return t.throw(a)},n=s(e),i=s(r);function s(a){return function(o){var l=a(o),u=l.value;return l.done?u:!u||typeof u.then!="function"?fe(u)?Promise.all(u).then(n,i):n(u):u.then(n,i)}}return s(e)()}function cu(t,e,r){var n=arguments.length;if(n<2)throw new x.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var s=da(i);return[t,s,r]}function Ma(t,e,r,n,i){return O.resolve().then(function(){var s=k.transless||k,a=t._createTransaction(e,r,t._dbSchema,n),o={trans:a,transless:s};if(n)a.idbtrans=n.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===Ri.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Ma(t,e,r,null,i)})):ie(d)}var l=Ci(i);l&&jt();var u,c=O.follow(function(){if(u=i.call(a,a),u)if(l){var d=Ke.bind(null,null);u.then(d,d)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=oi(u))},o);return(u&&typeof u.then=="function"?O.resolve(u).then(function(d){return a.active?d:ie(new x.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):c.then(function(){return u})).then(function(d){return n&&a._resolve(),a._completion.then(function(){return d})}).catch(function(d){return a._reject(d),ie(d)})})}function wr(t,e,r){for(var n=fe(t)?t.slice():[t],i=0;i<r;++i)n.push(e);return n}function du(t){return q(q({},t),{table:function(e){var r=t.table(e),n=r.schema,i={},s=[];function a(v,y,b){var _=Vt(v),g=i[_]=i[_]||[],w=v==null?0:typeof v=="string"?1:v.length,m=y>0,A=q(q({},b),{isVirtual:m,keyTail:y,keyLength:w,extractKey:ri(v),unique:!m&&b.unique});if(g.push(A),A.isPrimaryKey||s.push(A),w>1){var T=w===2?v[0]:v.slice(0,w-1);a(T,y+1,b)}return g.sort(function(P,S){return P.keyTail-S.keyTail}),A}var o=a(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[o];for(var l=0,u=n.indexes;l<u.length;l++){var c=u[l];a(c.keyPath,0,c)}function d(v){var y=i[Vt(v)];return y&&y[0]}function h(v,y){return{type:v.type===1?2:v.type,lower:wr(v.lower,v.lowerOpen?t.MAX_KEY:t.MIN_KEY,y),lowerOpen:!0,upper:wr(v.upper,v.upperOpen?t.MIN_KEY:t.MAX_KEY,y),upperOpen:!0}}function f(v){var y=v.query.index;return y.isVirtual?q(q({},v),{query:{index:y,range:h(v.query.range,y.keyTail)}}):v}var p=q(q({},r),{schema:q(q({},n),{primaryKey:o,indexes:s,getIndexByKeyPath:d}),count:function(v){return r.count(f(v))},query:function(v){return r.query(f(v))},openCursor:function(v){var y=v.query.index,b=y.keyTail,_=y.isVirtual,g=y.keyLength;if(!_)return r.openCursor(v);function w(m){function A(P){P!=null?m.continue(wr(P,v.reverse?t.MAX_KEY:t.MIN_KEY,b)):v.unique?m.continue(m.key.slice(0,g).concat(v.reverse?t.MIN_KEY:t.MAX_KEY,b)):m.continue()}var T=Object.create(m,{continue:{value:A},continuePrimaryKey:{value:function(P,S){m.continuePrimaryKey(wr(P,t.MAX_KEY,b),S)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var P=m.key;return g===1?P[0]:P.slice(0,g)}},value:{get:function(){return m.value}}});return T}return r.openCursor(f(v)).then(function(m){return m&&w(m)})}});return p}})}var hu={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:du};function Fi(t,e,r,n){return r=r||{},n=n||"",ne(t).forEach(function(i){if(!be(e,i))r[n+i]=void 0;else{var s=t[i],a=e[i];if(typeof s=="object"&&typeof a=="object"&&s&&a){var o=qn(s),l=qn(a);o!==l?r[n+i]=e[i]:o==="Object"?Fi(s,a,r,n+i+"."):s!==a&&(r[n+i]=e[i])}else s!==a&&(r[n+i]=e[i])}}),ne(e).forEach(function(i){be(t,i)||(r[n+i]=e[i])}),r}function fu(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var pu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return q(q({},t),{table:function(e){var r=t.table(e),n=r.schema.primaryKey,i=q(q({},r),{mutate:function(s){var a=k.trans,o=a.table(e).hook,l=o.deleting,u=o.creating,c=o.updating;switch(s.type){case"add":if(u.fire===H)break;return a._promise("readwrite",function(){return d(s)},!0);case"put":if(u.fire===H&&c.fire===H)break;return a._promise("readwrite",function(){return d(s)},!0);case"delete":if(l.fire===H)break;return a._promise("readwrite",function(){return d(s)},!0);case"deleteRange":if(l.fire===H)break;return a._promise("readwrite",function(){return h(s)},!0)}return r.mutate(s);function d(p){var v=k.trans,y=p.keys||fu(n,p);if(!y)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?q(q({},p),{keys:y}):q({},p),p.type!=="delete"&&(p.values=Un([],p.values,!0)),p.keys&&(p.keys=Un([],p.keys,!0)),vu(r,p,y).then(function(b){var _=y.map(function(g,w){var m=b[w],A={onerror:null,onsuccess:null};if(p.type==="delete")l.fire.call(A,g,m,v);else if(p.type==="add"||m===void 0){var T=u.fire.call(A,g,p.values[w],v);g==null&&T!=null&&(g=T,p.keys[w]=g,n.outbound||Ee(p.values[w],n.keyPath,g))}else{var P=Fi(m,p.values[w]),S=c.fire.call(A,P,g,m,v);if(S){var I=p.values[w];Object.keys(S).forEach(function(U){be(I,U)?I[U]=S[U]:Ee(I,U,S[U])})}}return A});return r.mutate(p).then(function(g){for(var w=g.failures,m=g.results,A=g.numFailures,T=g.lastResult,P=0;P<y.length;++P){var S=m?m[P]:y[P],I=_[P];S==null?I.onerror&&I.onerror(w[P]):I.onsuccess&&I.onsuccess(p.type==="put"&&b[P]?p.values[P]:S)}return{failures:w,results:m,numFailures:A,lastResult:T}}).catch(function(g){return _.forEach(function(w){return w.onerror&&w.onerror(g)}),Promise.reject(g)})})}function h(p){return f(p.trans,p.range,1e4)}function f(p,v,y){return r.query({trans:p,values:!1,query:{index:n,range:v},limit:y}).then(function(b){var _=b.result;return d({type:"delete",keys:_,trans:p}).then(function(g){return g.numFailures>0?Promise.reject(g.failures[0]):_.length<y?{failures:[],numFailures:0,lastResult:void 0}:f(p,q(q({},v),{lower:_[_.length-1],lowerOpen:!0}),y)})})}}});return i}})}};function vu(t,e,r){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:r,cache:"immutable"})}function ja(t,e,r){try{if(!e||e.keys.length<t.length)return null;for(var n=[],i=0,s=0;i<e.keys.length&&s<t.length;++i)pe(e.keys[i],t[s])===0&&(n.push(r?or(e.values[i]):e.values[i]),++s);return n.length===t.length?n:null}catch{return null}}var gu={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var r=t.table(e);return q(q({},r),{getMany:function(n){if(!n.cache)return r.getMany(n);var i=ja(n.keys,n.trans._cache,n.cache==="clone");return i?O.resolve(i):r.getMany(n).then(function(s){return n.trans._cache={keys:n.keys,values:n.cache==="clone"?or(s):s},s})},mutate:function(n){return n.type!=="add"&&(n.trans._cache=null),r.mutate(n)}})}}}},In;function Hi(t){return!("from"in t)}var je=function(t,e){if(this)ve(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var r=new je;return t&&"d"in t&&ve(r,t),r}};Ct(je.prototype,(In={add:function(t){return Wr(this,t),this},addKey:function(t){return rr(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(r){return rr(e,r,r)}),this}},In[Fn]=function(){return li(this)},In));function rr(t,e,r){var n=pe(e,r);if(!isNaN(n)){if(n>0)throw RangeError();if(Hi(t))return ve(t,{from:e,to:r,d:1});var i=t.l,s=t.r;if(pe(r,t.from)<0)return i?rr(i,e,r):t.l={from:e,to:r,d:1,l:null,r:null},Es(t);if(pe(e,t.to)>0)return s?rr(s,e,r):t.r={from:e,to:r,d:1,l:null,r:null},Es(t);pe(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),pe(r,t.to)>0&&(t.to=r,t.r=null,t.d=t.l?t.l.d+1:1);var a=!t.r;i&&!t.l&&Wr(t,i),s&&a&&Wr(t,s)}}function Wr(t,e){function r(n,i){var s=i.from,a=i.to,o=i.l,l=i.r;rr(n,s,a),o&&r(n,o),l&&r(n,l)}Hi(e)||r(t,e)}function yu(t,e){var r=li(e),n=r.next();if(n.done)return!1;for(var i=n.value,s=li(t),a=s.next(i.from),o=a.value;!n.done&&!a.done;){if(pe(o.from,i.to)<=0&&pe(o.to,i.from)>=0)return!0;pe(i.from,o.from)<0?i=(n=r.next(o.from)).value:o=(a=s.next(i.from)).value}return!1}function li(t){var e=Hi(t)?null:{s:0,n:t};return{next:function(r){for(var n=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,n)for(;e.n.l&&pe(r,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!n||pe(r,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Es(t){var e,r,n=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((r=t.l)===null||r===void 0?void 0:r.d)||0),i=n>1?"r":n<-1?"l":"";if(i){var s=i==="r"?"l":"r",a=q({},t),o=t[i];t.from=o.from,t.to=o.to,t[i]=o[i],a[i]=o[s],t[s]=a,a.d=Os(a)}t.d=Os(t)}function Os(t){var e=t.r,r=t.l;return(e?r?Math.max(e.d,r.d):e.d:r?r.d:0)+1}var mu={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,r=new je(t.MIN_KEY,t.MAX_KEY);return q(q({},t),{table:function(n){var i=t.table(n),s=i.schema,a=s.primaryKey,o=a.extractKey,l=a.outbound,u=q(q({},i),{mutate:function(h){var f=h.trans,p=f.mutatedParts||(f.mutatedParts={}),v=function(T){var P="idb://"+e+"/"+n+"/"+T;return p[P]||(p[P]=new je)},y=v(""),b=v(":dels"),_=h.type,g=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[],w=g[0],m=g[1],A=h.trans._cache;return i.mutate(h).then(function(T){if(fe(w)){_!=="delete"&&(w=T.results),y.addKeys(w);var P=ja(w,A);!P&&_!=="add"&&b.addKeys(w),(P||m)&&_u(v,s,P,m)}else if(w){var S={from:w.lower,to:w.upper};b.add(S),y.add(S)}else y.add(r),b.add(r),s.indexes.forEach(function(I){return v(I.name).add(r)});return T})}}),c=function(h){var f,p,v=h.query,y=v.index,b=v.range;return[y,new je((f=b.lower)!==null&&f!==void 0?f:t.MIN_KEY,(p=b.upper)!==null&&p!==void 0?p:t.MAX_KEY)]},d={get:function(h){return[a,new je(h.key)]},getMany:function(h){return[a,new je().addKeys(h.keys)]},count:c,query:c,openCursor:c};return ne(d).forEach(function(h){u[h]=function(f){var p=k.subscr;if(p){var v=function(A){var T="idb://"+e+"/"+n+"/"+A;return p[T]||(p[T]=new je)},y=v(""),b=v(":dels"),_=d[h](f),g=_[0],w=_[1];if(v(g.name||"").add(w),!g.isPrimaryKey)if(h==="count")b.add(r);else{var m=h==="query"&&l&&f.values&&i.query(q(q({},f),{values:!1}));return i[h].apply(this,arguments).then(function(A){if(h==="query"){if(l&&f.values)return m.then(function(I){var U=I.result;return y.addKeys(U),A});var T=f.values?A.result.map(o):A.result;f.values?y.addKeys(T):b.addKeys(T)}else if(h==="openCursor"){var P=A,S=f.values;return P&&Object.create(P,{key:{get:function(){return b.addKey(P.primaryKey),P.key}},primaryKey:{get:function(){var I=P.primaryKey;return b.addKey(I),I}},value:{get:function(){return S&&y.addKey(P.primaryKey),P.value}}})}return A})}}return i[h].apply(this,arguments)}}),u}})}};function _u(t,e,r,n){function i(s){var a=t(s.name||"");function o(u){return u!=null?s.extractKey(u):null}var l=function(u){return s.multiEntry&&fe(u)?u.forEach(function(c){return a.addKey(c)}):a.addKey(u)};(r||n).forEach(function(u,c){var d=r&&o(r[c]),h=n&&o(n[c]);pe(d,h)!==0&&(d!=null&&l(d),h!=null&&l(h))})}e.indexes.forEach(i)}var Wi=function(){function t(e,r){var n=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=r=q({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var s=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:H,dbReadyPromise:null,cancelOpen:H,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};a.dbReadyPromise=new O(function(o){a.dbReadyResolve=o}),a.openCanceller=new O(function(o,l){a.cancelOpen=l}),this._state=a,this.name=e,this.on=dr(this,"populate","blocked","versionchange","close",{ready:[Di,H]}),this.on.ready.subscribe=oa(this.on.ready.subscribe,function(o){return function(l,u){t.vip(function(){var c=n._state;if(c.openComplete)c.dbOpenError||O.resolve().then(l),u&&o(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&o(l);else{o(l);var d=n;u||o(function h(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(h)})}})}}),this.Collection=Ml(this),this.Table=Il(this),this.Transaction=ql(this),this.Version=iu(this),this.WhereClause=Ul(this),this.on("versionchange",function(o){o.newVersion>0?console.warn("Another connection wants to upgrade database '"+n.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+n.name+"'. Closing db now to resume the delete request."),n.close()}),this.on("blocked",function(o){!o.newVersion||o.newVersion<o.oldVersion?console.warn("Dexie.delete('"+n.name+"') was blocked"):console.warn("Upgrade '"+n.name+"' blocked by other connection holding version "+o.oldVersion/10)}),this._maxKey=tr(r.IDBKeyRange),this._createTransaction=function(o,l,u,c){return new n.Transaction(o,l,u,n._options.chromeTransactionDurability,c)},this._fireOnBlocked=function(o){n.on("blocked").fire(o),zt.filter(function(l){return l.name===n.name&&l!==n&&!l._state.vcFired}).map(function(l){return l.on("versionchange").fire(o)})},this.use(hu),this.use(pu),this.use(mu),this.use(gu),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(function(o){return o(n)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new x.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new x.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var r=this._versions,n=r.filter(function(i){return i._cfg.version===e})[0];return n||(n=new this.Version(e),r.push(n),r.sort(Gl),n.stores({}),this._state.autoSchema=!1,n)},t.prototype._whenReady=function(e){var r=this;return this.idbdb&&(this._state.openComplete||k.letThrough||this._vip)?e():new O(function(n,i){if(r._state.openComplete)return i(new x.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._options.autoOpen){i(new x.DatabaseClosed);return}r.open().catch(H)}r._state.dbReadyPromise.then(n,i)}).then(e)},t.prototype.use=function(e){var r=e.stack,n=e.create,i=e.level,s=e.name;s&&this.unuse({stack:r,name:s});var a=this._middlewares[r]||(this._middlewares[r]=[]);return a.push({stack:r,create:n,level:i==null?10:i,name:s}),a.sort(function(o,l){return o.level-l.level}),this},t.prototype.unuse=function(e){var r=e.stack,n=e.name,i=e.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(s){return i?s.create!==i:n?s.name!==n:!1})),this},t.prototype.open=function(){return uu(this)},t.prototype._close=function(){var e=this._state,r=zt.indexOf(this);if(r>=0&&zt.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new O(function(n){e.dbReadyResolve=n}),e.openCanceller=new O(function(n,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new x.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,r=arguments.length>0,n=this._state;return new O(function(i,s){var a=function(){e.close();var o=e._deps.indexedDB.deleteDatabase(e.name);o.onsuccess=J(function(){ou(e._deps,e.name),i()}),o.onerror=Se(s),o.onblocked=e._fireOnBlocked};if(r)throw new x.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(a):a()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return ne(this._allTables).map(function(r){return e._allTables[r]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=cu.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,r,n){var i=this,s=k.trans;(!s||s.db!==this||e.indexOf("!")!==-1)&&(s=null);var a=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var o,l;try{if(l=r.map(function(c){var d=c instanceof i.Table?c.name:c;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),e=="r"||e===Pn)o=Pn;else if(e=="rw"||e==En)o=En;else throw new x.InvalidArgument("Invalid transaction mode: "+e);if(s){if(s.mode===Pn&&o===En)if(a)s=null;else throw new x.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s&&l.forEach(function(c){if(s&&s.storeNames.indexOf(c)===-1)if(a)s=null;else throw new x.SubTransaction("Table "+c+" not included in parent transaction.")}),a&&s&&!s.active&&(s=null)}}catch(c){return s?s._promise(null,function(d,h){h(c)}):ie(c)}var u=Ma.bind(null,this,o,l,s,n);return s?s._promise(o,u,"lock"):k.trans?$t(k.transless,function(){return i._whenReady(u)}):this._whenReady(u)},t.prototype.table=function(e){if(!be(this._allTables,e))throw new x.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),wu=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",bu=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,r,n){return this._subscribe(!e||typeof e=="function"?{next:e,error:r,complete:n}:e)},t.prototype[wu]=function(){return this},t}();function $a(t,e){return ne(e).forEach(function(r){var n=t[r]||(t[r]=new je);Wr(n,e[r])}),t}function Au(t){var e=!1,r=void 0,n=new bu(function(i){var s=Ci(t);function a(y){s&&jt();var b=function(){return Qe(t,{subscr:y,trans:null})},_=k.trans?$t(k.transless,b):b();return s&&_.then(Ke,Ke),_}var o=!1,l={},u={},c={get closed(){return o},unsubscribe:function(){o=!0,Xe.storagemutated.unsubscribe(p)}};i.start&&i.start(c);var d=!1,h=!1;function f(){return ne(u).some(function(y){return l[y]&&yu(l[y],u[y])})}var p=function(y){$a(l,y),f()&&v()},v=function(){if(!(d||o)){l={};var y={},b=a(y);h||(Xe(er,p),h=!0),d=!0,Promise.resolve(b).then(function(_){e=!0,r=_,d=!1,!o&&(f()?v():(l={},u=y,i.next&&i.next(_)))},function(_){d=!1,e=!1,i.error&&i.error(_),c.unsubscribe()})}};return v(),c});return n.hasValue=function(){return e},n.getValue=function(){return r},n}var ui;try{ui={indexedDB:V.indexedDB||V.mozIndexedDB||V.webkitIndexedDB||V.msIndexedDB,IDBKeyRange:V.IDBKeyRange||V.webkitIDBKeyRange}}catch{ui={indexedDB:null,IDBKeyRange:null}}var st=Wi;Ct(st,q(q({},nn),{delete:function(t){var e=new st(t,{addons:[]});return e.delete()},exists:function(t){return new st(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return su(st.dependencies).then(t)}catch{return ie(new x.MissingAPI)}},defineClass:function(){function t(e){ve(this,e)}return t},ignoreTransaction:function(t){return k.trans?$t(k.transless,t):t()},vip:ai,async:function(t){return function(){try{var e=oi(t.apply(this,arguments));return!e||typeof e.then!="function"?O.resolve(e):e}catch(r){return ie(r)}}},spawn:function(t,e,r){try{var n=oi(t.apply(r,e||[]));return!n||typeof n.then!="function"?O.resolve(n):n}catch(i){return ie(i)}},currentTransaction:{get:function(){return k.trans||null}},waitFor:function(t,e){var r=O.resolve(typeof t=="function"?st.ignoreTransaction(t):t).timeout(e||6e4);return k.trans?k.trans.waitFor(r):r},Promise:O,debug:{get:function(){return Ce},set:function(t){fa(t,t==="dexie"?function(){return!0}:Sa)}},derive:Dt,extend:ve,props:Ct,override:oa,Events:dr,on:Xe,liveQuery:Au,extendObservabilitySet:$a,getByKeyPath:Le,setByKeyPath:Ee,delByKeyPath:el,shallowClone:ca,deepClone:or,getObjectDiff:Fi,cmp:pe,asap:la,minKey:ei,addons:[],connections:zt,errnames:Ri,dependencies:ui,semVer:_s,version:_s.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,r){return t+e/Math.pow(10,r*2)})}));st.maxKey=tr(st.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(Xe(er,function(t){if(!Be){var e;sn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Ge,!0,!0,t)):e=new CustomEvent(Ge,{detail:t}),Be=!0,dispatchEvent(e),Be=!1}}),addEventListener(Ge,function(t){var e=t.detail;Be||zr(e)}));function zr(t){var e=Be;try{Be=!0,Xe.storagemutated.fire(t)}finally{Be=e}}var Be=!1;if(typeof BroadcastChannel!="undefined"){var br=new BroadcastChannel(Ge);typeof br.unref=="function"&&br.unref(),Xe(er,function(t){Be||br.postMessage(t)}),br.onmessage=function(t){t.data&&zr(t.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){Xe(er,function(t){try{Be||(typeof localStorage!="undefined"&&localStorage.setItem(Ge,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&Un([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:Ge,changedParts:t})}))}catch{}}),typeof addEventListener!="undefined"&&addEventListener("storage",function(t){if(t.key===Ge){var e=JSON.parse(t.newValue);e&&zr(e.changedParts)}});var Ss=self.document&&navigator.serviceWorker;Ss&&Ss.addEventListener("message",Tu)}function Tu(t){var e=t.data;e&&e.type===Ge&&zr(e.changedParts)}O.rejectionMapper=ul;fa(Ce,Sa);const M=new Wi("myDatabase");M.version(2.2).stores({HABIT_METADATA:`++HABIT_ID,
    HABIT_LABEL,
    QUESTION,
    DESCRIPTION,
    IS_ADDITIVE,
    HAS_OPTION,
    CAN_MULTISELECT,
    IS_TIME_ENTRY,
    Is_DURATION_ENTRY,
    DEFAULT_VALUE,
    DEFAULT_OPTION_ID,
    UNIT,
    COLOR,
    EMOJI,
    NO_OF_ENTRIES_PERDAY,
    HAS_AP`,OPTION_METADATA:`++OPTION_ID,
    HABIT_ID,
    OPTION_LABEL,
    OPTION_DESC,
    OPTION_VALUE,
    OPTION_COLOR,
    OPTION_EMOJI,
    FREQUENCY_TOTAL`,CHECKMARKS_TRACKER:`++CMT_ID,
    [HABIT_ID+DATE],
    OPTION_ID,
    CONSTANT_VALUE,
    TIME_ENTRY,
    NOTES,
    FROM_TIME,
    UPTO_TIME,
    DURATION`,HABIT_REMINDER_METADATA:`++HR_ID,
    HABIT_ID,
    FREQUENCY_NUM,
    FREQUENCY_INTERVAL,
    REMIDER_HR,
    REMIDER_MIN,
    REMIDER_DAY`,HABIT_PERFORMANCE:`++HP_ID,
    [HABIT_ID+PERIODICITY+REF_DATE],
    TARGET,
    SCORE,
    PERCENTAGE,
    MINUTES_SPEND,
    TIME_SCORE`,AP_PERFORMANCE:`++APP_ID,
    [AP_ID+PERIODICITY+REF_DATE],
    SCORE`,ADDITIONAL_PROMPT:`++AP_ID,
    HABIT_ID,
    PROMPT_LABEL,
    HAS_NUM,
    IS_NUM_ADDITIVE,
    IS_ADDED_IN_MAIN,
    IS_SUBTRACTED_IN_MAIN,
    HAS_NOTES,
    CAN_MULTISELECT,
    HAS_OPTION,
    IS_MANDATORY,
    DEFAULT_VALUE`,ADDITIONAL_PROMPT_ANSWERS:`++APA_ID,
    [AP_ID+CMT_ID],
    OPTION_ID,
    NUM_VALUE,
    NOTES`,TARGET_AND_TITLE:`++TT_ID,
    HABIT_ID,
    TITLE,
    EMOJI,
    MIN_SCORE,
    MAX_SCORE,
    TIME_PERIOD`,AP_OPT_METADATA:`++OPTION_ID,
    AP_ID,
    OPTION_LABEL,
    OPTION_DESC,
    OPTION_VALUE,
    OPTION_COLOR,
    OPTION_EMOJI,
    FREQUENCY_TOTAL`,OPTION_SCORE:`++OPT_SRC_ID,
    OPTION_ID,
    FOR_MONTH,
    FREQUENCY`,AP_OPT_SCORE:`++OPT_SRC_ID,
    OPTION_ID,
    FOR_MONTH,
    FREQUENCY`});const Pu=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=(...r)=>ar(()=>Promise.resolve().then(function(){return Bt}),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class zi extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class Eu extends zi{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ks extends zi{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Is extends zi{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ci;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ci||(ci={}));var Ou=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};class Su{constructor(e,{headers:r={},customFetch:n,region:i=ci.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=Pu(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return Ou(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region);const u=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,u.searchParams.set("forceFunctionRegion",l));let c;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob!="undefined"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData!="undefined"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const d=yield this.fetch(u.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:c}).catch(v=>{throw new Eu(v)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new ks(d);if(!d.ok)throw new Is(d);let f=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null,response:d}}catch(i){return{data:null,error:i,response:i instanceof Is||i instanceof ks?i.context:void 0}}})}}var Ae=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ku(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}),e}var ye={},Vi={},on={},fr={},ln={},un={},Iu=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")},xt=Iu();const Cu=xt.fetch;var Ba=xt.fetch.bind(xt);const La=xt.Headers,xu=xt.Request,Ru=xt.Response;var Bt=Object.freeze(Object.defineProperty({__proto__:null,fetch:Cu,default:Ba,Headers:La,Request:xu,Response:Ru},Symbol.toStringTag,{value:"Module"})),Du=ku(Bt),cn={};Object.defineProperty(cn,"__esModule",{value:!0});class Mu extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}cn.default=Mu;var Na=Ae&&Ae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(un,"__esModule",{value:!0});const ju=Na(Du),$u=Na(cn);class Bu{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch=="undefined"?this.fetch=ju.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=Object.assign({},this.headers),this.headers[e]=r,this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let u=null,c=null,d=null,h=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const b=await s.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=b:c=JSON.parse(b))}const v=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),y=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");v&&y&&y.length>1&&(d=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,h=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const v=await s.text();try{u=JSON.parse(v),Array.isArray(u)&&s.status===404&&(c=[],u=null,h=200,f="OK")}catch{s.status===404&&v===""?(h=204,f="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&((l=u==null?void 0:u.details)===null||l===void 0?void 0:l.includes("0 rows"))&&(u=null,h=200,f="OK"),u&&this.shouldThrowOnError)throw new $u.default(u)}return{error:u,data:c,count:d,status:h,statusText:f}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,r)}returns(){return this}overrideTypes(){return this}}un.default=Bu;var Lu=Ae&&Ae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ln,"__esModule",{value:!0});const Nu=Lu(un);class Uu extends Nu.default{select(e){let r=!1;const n=(e!=null?e:"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n=="undefined"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i=="undefined"?"offset":`${i}.offset`,a=typeof i=="undefined"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}ln.default=Uu;var Ku=Ae&&Ae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fr,"__esModule",{value:!0});const qu=Ku(ln);class Fu extends qu.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${a}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}}fr.default=Fu;var Hu=Ae&&Ae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(on,"__esModule",{value:!0});const Ut=Hu(fr);class Wu{constructor(e,{headers:r={},schema:n,fetch:i}){this.url=e,this.headers=r,this.schema=n,this.fetch=i}select(e,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let s=!1;const a=(e!=null?e:"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new Ut.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:r,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ut.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Ut.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new Ut.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const r="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Ut.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}on.default=Wu;var dn={},hn={};Object.defineProperty(hn,"__esModule",{value:!0});hn.version=void 0;hn.version="0.0.0-automated";Object.defineProperty(dn,"__esModule",{value:!0});dn.DEFAULT_HEADERS=void 0;const zu=hn;dn.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${zu.version}`};var Ua=Ae&&Ae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Vi,"__esModule",{value:!0});const Vu=Ua(on),Ju=Ua(fr),Gu=dn;class Ji{constructor(e,{headers:r={},schema:n,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Gu.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(e){const r=new URL(`${this.url}/${e}`);return new Vu.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ji(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;n||i?(a=n?"HEAD":"GET",Object.entries(r).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{o.searchParams.append(c,d)})):(a="POST",l=r);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new Ju.default({method:a,url:o,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}Vi.default=Ji;var Lt=Ae&&Ae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ye,"__esModule",{value:!0});ye.PostgrestError=ye.PostgrestBuilder=ye.PostgrestTransformBuilder=ye.PostgrestFilterBuilder=ye.PostgrestQueryBuilder=ye.PostgrestClient=void 0;const Ka=Lt(Vi);ye.PostgrestClient=Ka.default;const qa=Lt(on);ye.PostgrestQueryBuilder=qa.default;const Fa=Lt(fr);ye.PostgrestFilterBuilder=Fa.default;const Ha=Lt(ln);ye.PostgrestTransformBuilder=Ha.default;const Wa=Lt(un);ye.PostgrestBuilder=Wa.default;const za=Lt(cn);ye.PostgrestError=za.default;var Qu=ye.default={PostgrestClient:Ka.default,PostgrestQueryBuilder:qa.default,PostgrestFilterBuilder:Fa.default,PostgrestTransformBuilder:Ha.default,PostgrestBuilder:Wa.default,PostgrestError:za.default};const{PostgrestClient:Yu,PostgrestQueryBuilder:tp,PostgrestFilterBuilder:rp,PostgrestTransformBuilder:np,PostgrestBuilder:ip,PostgrestError:sp}=Qu;function Xu(){if(typeof WebSocket!="undefined")return WebSocket;if(typeof global.WebSocket!="undefined")return global.WebSocket;if(typeof window.WebSocket!="undefined")return window.WebSocket;if(typeof self.WebSocket!="undefined")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Zu=Xu(),ec="2.11.15",tc=`realtime-js/${ec}`,rc="1.0.0",Va=1e4,nc=1e3;var Jt;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Jt||(Jt={}));var de;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(de||(de={}));var Pe;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Pe||(Pe={}));var di;(function(t){t.websocket="websocket"})(di||(di={}));var at;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(at||(at={}));class ic{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(e.slice(a,a+i));a=a+i;const l=n.decode(e.slice(a,a+s));a=a+s;const u=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class Ja{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var W;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(W||(W={}));const Cs=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,a)=>(s[a]=sc(a,t,e,i),s),{})},sc=(t,e,r,n)=>{const i=e.find(o=>o.name===t),s=i==null?void 0:i.type,a=r[t];return s&&!n.includes(s)?Ga(s,a):hi(a)},Ga=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return uc(e,r)}switch(t){case W.bool:return ac(e);case W.float4:case W.float8:case W.int2:case W.int4:case W.int8:case W.numeric:case W.oid:return oc(e);case W.json:case W.jsonb:return lc(e);case W.timestamp:return cc(e);case W.abstime:case W.date:case W.daterange:case W.int4range:case W.int8range:case W.money:case W.reltime:case W.text:case W.time:case W.timestamptz:case W.timetz:case W.tsrange:case W.tstzrange:return hi(e);default:return hi(e)}},hi=t=>t,ac=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},oc=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},lc=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},uc=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let s;const a=t.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>Ga(e,o))}return t},cc=t=>typeof t=="string"?t.replace(" ","T"):t,Qa=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Cn{constructor(e,r,n={},i=Va){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var xs;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(xs||(xs={}));class Gt{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Gt.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=Gt.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Gt.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const s=this.cloneDeep(e),a=this.transformState(r),o={},l={};return this.map(s,(u,c)=>{a[u]||(l[u]=c)}),this.map(a,(u,c)=>{const d=s[u];if(d){const h=c.map(y=>y.presence_ref),f=d.map(y=>y.presence_ref),p=c.filter(y=>f.indexOf(y.presence_ref)<0),v=d.filter(y=>h.indexOf(y.presence_ref)<0);p.length>0&&(o[u]=p),v.length>0&&(l[u]=v)}else o[u]=c}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(e,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var u;const c=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),c.length>0){const d=e[o].map(f=>f.presence_ref),h=c.filter(f=>d.indexOf(f.presence_ref)<0);e[o].unshift(...h)}n(o,c,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const c=l.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[o]=u,i(o,u,l),u.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Rs;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Rs||(Rs={}));var Ds;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ds||(Ds={}));var De;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(De||(De={}));class Gi{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=de.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Cn(this,Pe.join,this.params,this.timeout),this.rejoinTimer=new Ja(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=de.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=de.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=de.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this._isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=de.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Pe.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Gt(this),this.broadcastEndpointURL=Qa(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==de.closed){const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(c=>e==null?void 0:e(De.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(De.CLOSED));const l={},u={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(c=>c.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),c===void 0){e==null||e(De.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,f=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,p=[];for(let v=0;v<f;v++){const y=h[v],{filter:{event:b,schema:_,table:g,filter:w}}=y,m=c&&c[v];if(m&&m.event===b&&m.schema===_&&m.table===g&&m.filter===w)p.push(Object.assign(Object.assign({},y),{id:m.id}));else{this.unsubscribe(),this.state=de.errored,e==null||e(De.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(De.SUBSCRIBED);return}}).receive("error",c=>{this.state=de.errored,e==null||e(De.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(De.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:a}=e,o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",l={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=de.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Pe.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Cn(this,Pe.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Cn(this,e,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:c}=Pe;if(n&&[o,l,u,c].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var p,v,y;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(v=f.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===a}).map(f=>f.callback(h,n)):(s=this.bindings[a])===null||s===void 0||s.filter(f=>{var p,v,y,b,_,g;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const w=f.id,m=(p=f.filter)===null||p===void 0?void 0:p.event;return w&&((v=r.ids)===null||v===void 0?void 0:v.includes(w))&&(m==="*"||(m==null?void 0:m.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const w=(_=(b=f==null?void 0:f.filter)===null||b===void 0?void 0:b.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return w==="*"||w===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:v,table:y,commit_timestamp:b,type:_,errors:g}=p;h=Object.assign(Object.assign({},{schema:v,table:y,commit_timestamp:b,eventType:_,new:{},old:{},errors:g}),this._getPayloadRecords(p))}f.callback(h,n)})}_isClosed(){return this.state===de.closed}_isJoined(){return this.state===de.joined}_isJoining(){return this.state===de.joining}_isLeaving(){return this.state===de.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Gi.isEqual(i.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Pe.close,{},e)}_onError(e){this._on(Pe.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=de.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Cs(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Cs(e.columns,e.old_record)),r}}const Ms=()=>{},dc=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class hc{constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Va,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ms,this.ref=0,this.logger=Ms,this.conn=null,this.sendBuffer=[],this.serializer=new ic,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch=="undefined"?a=(...o)=>ar(()=>Promise.resolve().then(function(){return Bt}),void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${di.websocket}`,this.httpEndpoint=Qa(e),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),((r==null?void 0:r.logLevel)||(r==null?void 0:r.log_level))&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,a)=>a(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ja(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window!="undefined"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Zu),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:rc}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r!=null?r:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Jt.connecting:return at.Connecting;case Jt.open:return at.Open;case Jt.closing:return at.Closing;default:return at.Closed}}isConnected(){return this.connectionState()===at.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Gi(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:n,payload:i,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:tc};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Pe.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(nc,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:i,payload:s,ref:a}=r;n==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Pe.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([dc],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Qi extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function se(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class fc extends Qi{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class fi extends Qi{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var pc=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const Ya=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=(...r)=>ar(()=>Promise.resolve().then(function(){return Bt}),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},vc=()=>pc(void 0,void 0,void 0,function*(){return typeof Response=="undefined"?(yield ar(()=>Promise.resolve().then(function(){return Bt}),void 0)).Response:Response}),pi=t=>{if(Array.isArray(t))return t.map(r=>pi(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=pi(n)}),e},gc=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var gt=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const xn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),yc=(t,e,r)=>gt(void 0,void 0,void 0,function*(){const n=yield vc();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const s=t.status||500,a=(i==null?void 0:i.statusCode)||s+"";e(new fc(xn(i),s,a))}).catch(i=>{e(new fi(xn(i),i))}):e(new fi(xn(t),t))}),mc=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(gc(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r))};function pr(t,e,r,n,i,s){return gt(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(r,mc(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>yc(l,o,n))})})}function Vr(t,e,r,n){return gt(this,void 0,void 0,function*(){return pr(t,"GET",e,r,n)})}function Me(t,e,r,n,i){return gt(this,void 0,void 0,function*(){return pr(t,"POST",e,n,i,r)})}function vi(t,e,r,n,i){return gt(this,void 0,void 0,function*(){return pr(t,"PUT",e,n,i,r)})}function _c(t,e,r,n){return gt(this,void 0,void 0,function*(){return pr(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Xa(t,e,r,n,i){return gt(this,void 0,void 0,function*(){return pr(t,"DELETE",e,n,i,r)})}var ge=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const wc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},js={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class bc{constructor(e,r={},n,i){this.url=e,this.headers=r,this.bucketId=n,this.fetch=Ya(i)}uploadOrUpdate(e,r,n,i){return ge(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},js),i);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob!="undefined"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const u=this._removeEmptyFolders(r),c=this._getFinalPath(u),d=yield(e=="PUT"?vi:Me)(this.fetch,`${this.url}/object/${c}`,s,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}upload(e,r,n){return ge(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return ge(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const u=Object.assign({upsert:js.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob!="undefined"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData!="undefined"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield vi(this.fetch,o.toString(),l,{headers:c});return{data:{path:s,fullPath:d.Key},error:null}}catch(l){if(se(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return ge(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield Me(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new Qi("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}update(e,r,n){return ge(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return ge(this,void 0,void 0,function*(){try{return{data:yield Me(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}copy(e,r,n){return ge(this,void 0,void 0,function*(){try{return{data:{path:(yield Me(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return ge(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield Me(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return ge(this,void 0,void 0,function*(){try{const i=yield Me(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}download(e,r){return ge(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)!="undefined"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Vr(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(se(o))return{data:null,error:o};throw o}})}info(e){return ge(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Vr(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:pi(n),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}exists(e){return ge(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield _c(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(se(n)&&n instanceof fi){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)!="undefined"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(e){return ge(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}})}list(e,r,n){return ge(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},wc),r),{prefix:e||""});return{data:yield Me(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer!="undefined"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Ac="2.10.4",Tc={"X-Client-Info":`storage-js/${Ac}`};var _t=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};class Pc{constructor(e,r={},n,i){const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},Tc),r),this.fetch=Ya(n)}listBuckets(){return _t(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(se(e))return{data:null,error:e};throw e}})}getBucket(e){return _t(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return _t(this,void 0,void 0,function*(){try{return{data:yield Me(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return _t(this,void 0,void 0,function*(){try{return{data:yield vi(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}emptyBucket(e){return _t(this,void 0,void 0,function*(){try{return{data:yield Me(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}})}deleteBucket(e){return _t(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}})}}class Ec extends Pc{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new bc(this.url,this.headers,e,this.fetch)}}const Oc="2.53.0";let Ht="";typeof Deno!="undefined"?Ht="deno":typeof document!="undefined"?Ht="web":typeof navigator!="undefined"&&navigator.product==="ReactNative"?Ht="react-native":Ht="node";const Sc={"X-Client-Info":`supabase-js-${Ht}/${Oc}`},kc={headers:Sc},Ic={schema:"public"},Cc={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},xc={};var Rc=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const Dc=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=Ba:e=fetch,(...r)=>e(...r)},Mc=()=>typeof Headers=="undefined"?La:Headers,jc=(t,e,r)=>{const n=Dc(r),i=Mc();return(s,a)=>Rc(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:t;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:u}))})};var $c=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};function Bc(t){return t.endsWith("/")?t:t+"/"}function Lc(t,e){var r,n;const{db:i,auth:s,realtime:a,global:o}=t,{db:l,auth:u,realtime:c,global:d}=e,h={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},c),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>$c(this,void 0,void 0,function*(){return""})};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}const Za="2.71.1",Et=30*1e3,gi=3,Rn=gi*Et,Nc="http://localhost:9999",Uc="supabase.auth.token",Kc={"X-Client-Info":`gotrue-js/${Za}`},yi="X-Supabase-Api-Version",eo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},qc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Fc=10*60*1e3;class Yi extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function R(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Hc extends Yi{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Wc(t){return R(t)&&t.name==="AuthApiError"}class to extends Yi{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Ze extends Yi{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class We extends Ze{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function zc(t){return R(t)&&t.name==="AuthSessionMissingError"}class Ar extends Ze{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Tr extends Ze{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Pr extends Ze{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Vc(t){return R(t)&&t.name==="AuthImplicitGrantRedirectError"}class $s extends Ze{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class mi extends Ze{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Dn(t){return R(t)&&t.name==="AuthRetryableFetchError"}class Bs extends Ze{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class _i extends Ze{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ls=` 	
\r=`.split(""),Jc=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ls.length;e+=1)t[Ls[e].charCodeAt(0)]=-2;for(let e=0;e<Jr.length;e+=1)t[Jr[e].charCodeAt(0)]=e;return t})();function Ns(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Jr[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Jr[n]),e.queuedBits-=6}}function ro(t,e,r){const n=Jc[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Us(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{Yc(a,n,r)};for(let a=0;a<t.length;a+=1)ro(t.charCodeAt(a),i,s);return e.join("")}function Gc(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Qc(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}Gc(n,e)}}function Yc(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Xc(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)ro(t.charCodeAt(i),r,n);return new Uint8Array(e)}function Zc(t){const e=[];return Qc(t,r=>e.push(r)),new Uint8Array(e)}function ed(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>Ns(i,r,n)),Ns(null,r,n),e.join("")}function td(t){return Math.round(Date.now()/1e3)+t}function rd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Te=()=>typeof window!="undefined"&&typeof document!="undefined",rt={tested:!1,writable:!1},no=()=>{if(!Te())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(rt.tested)return rt.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),rt.tested=!0,rt.writable=!0}catch{rt.tested=!0,rt.writable=!1}return rt.writable};function nd(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const io=t=>{let e;return t?e=t:typeof fetch=="undefined"?e=(...r)=>ar(()=>Promise.resolve().then(function(){return Bt}),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},id=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ot=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},nt=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Fe=async(t,e)=>{await t.removeItem(e)};class fn{constructor(){this.promise=new fn.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}fn.promiseConstructor=Promise;function Mn(t){const e=t.split(".");if(e.length!==3)throw new _i("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!qc.test(e[n]))throw new _i("JWT not in base64url format");return{header:JSON.parse(Us(e[0])),payload:JSON.parse(Us(e[1])),signature:Xc(e[2]),raw:{header:e[0],payload:e[1]}}}async function sd(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function ad(t,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await t(s);if(!e(s,null,a)){n(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function od(t){return("0"+t.toString(16)).substr(-2)}function ld(){const e=new Uint32Array(56);if(typeof crypto=="undefined"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,od).join("")}async function ud(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function cd(t){if(!(typeof crypto!="undefined"&&typeof crypto.subtle!="undefined"&&typeof TextEncoder!="undefined"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await ud(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wt(t,e,r=!1){const n=ld();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Ot(t,`${e}-code-verifier`,i);const s=await cd(n);return[s,n===s?"plain":"s256"]}const dd=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function hd(t){const e=t.headers.get(yi);if(!e||!e.match(dd))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function fd(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function pd(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vd=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function bt(t){if(!vd.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function jn(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ks(t){return JSON.parse(JSON.stringify(t))}var gd=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const it=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),yd=[502,503,504];async function qs(t){var e;if(!id(t))throw new mi(it(t),0);if(yd.includes(t.status))throw new mi(it(t),t.status);let r;try{r=await t.json()}catch(s){throw new to(it(s),s)}let n;const i=hd(t);if(i&&i.getTime()>=eo["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Bs(it(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new We}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Bs(it(r),t.status,r.weak_password.reasons);throw new Hc(it(r),t.status||500,n)}const md=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function N(t,e,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[yi]||(s[yi]=eo["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await _d(t,e,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function _d(t,e,r,n,i,s){const a=md(e,n,i,s);let o;try{o=await t(r,Object.assign({},a))}catch(l){throw console.error(l),new mi(it(l),0)}if(o.ok||await qs(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await qs(l)}}function Re(t){var e;let r=null;Td(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=td(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Fs(t){const e=Re(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ve(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function wd(t){return{data:t,error:null}}function bd(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=t,a=gd(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Ad(t){return t}function Td(t){return t.access_token&&t.refresh_token&&t.expires_in}const $n=["global","local","others"];var Pd=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class Ed{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=io(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=$n[0]){if($n.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$n.join(", ")}`);try{return await N(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(R(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await N(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ve})}catch(n){if(R(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=Pd(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await N(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:bd,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(R(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await N(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ve})}catch(r){if(R(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await N(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Ad});if(c.error)throw c.error;const d=await c.json(),h=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const v=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);u[`${y}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(R(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){bt(e);try{return await N(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ve})}catch(r){if(R(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){bt(e);try{return await N(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Ve})}catch(n){if(R(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){bt(e);try{return await N(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ve})}catch(n){if(R(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){bt(e.userId);try{const{data:r,error:n}=await N(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(R(r))return{data:null,error:r};throw r}}async _deleteFactor(e){bt(e.userId),bt(e.id);try{return{data:await N(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}}}function Hs(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function Od(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}const At={debug:!!(globalThis&&no()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class so extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Sd extends so{}async function kd(t,e,r){At.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),At.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){At.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{At.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw At.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Sd(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(At.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Od();const Id={url:Nc,storageKey:Uc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Kc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ws(t,e,r){return await r()}const Tt={};class nr{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=nr.nextInstanceID,nr.nextInstanceID+=1,this.instanceID>0&&Te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Id),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Ed({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=io(i.fetch),this.lock=i.lock||Ws,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Te()&&((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0?void 0:r.locks)?this.lock=kd:this.lock=Ws,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:no()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Hs(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Hs(this.memoryStorage)),Te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Tt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Tt[this.storageKey]=Object.assign(Object.assign({},Tt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Tt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Tt[this.storageKey]=Object.assign(Object.assign({},Tt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Za}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=nd(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Te()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Vc(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return R(r)?{error:r}:{error:new to("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const s=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Re}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(R(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var r,n,i;try{let s;if("email"in e){const{email:c,password:d,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await wt(this.storage,this.storageKey)),s=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},xform:Re})}else if("phone"in e){const{phone:c,password:d,options:h}=e;s=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Re})}else throw new Tr("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(R(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:a,options:o}=e;r=await N(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Fs})}else if("phone"in e){const{phone:s,password:a,options:o}=e;r=await N(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Fs})}else throw new Tr("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ar}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(R(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,i,s,a,o,l,u,c,d,h,f;let p,v;if("message"in e)p=e.message,v=e.signature;else{const{chain:y,wallet:b,statement:_,options:g}=e;let w;if(Te())if(typeof b=="object")w=b;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))w=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=b}const m=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const A=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:m.host,uri:m.href}),_?{statement:_}:null));let T;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")T=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)T=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)p=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),v=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${m.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${m.href}`,`Issued At: ${(i=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((d=(c=g==null?void 0:g.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||d===void 0)&&d.length?["Resources",...g.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const A=await w.signMessage(new TextEncoder().encode(p),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=A}}try{const{data:y,error:b}=await N(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ed(v)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Re});if(b)throw b;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Ar}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:b})}catch(y){if(R(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const r=await nt(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r!=null?r:"").split("/");try{const{data:s,error:a}=await N(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Re});if(await Fe(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Ar}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i!=null?i:null}),error:a})}catch(s){if(R(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=e,o=await N(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Re}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ar}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(r){if(R(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,s,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await wt(this.storage,this.storageKey));const{error:d}=await N(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:c}=await N(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Tr("You must provide either an email or phone number.")}catch(o){if(R(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var r,n;try{let i,s;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await N(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Re});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(R(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await wt(this.storage,this.storageKey)),await N(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:wd})}catch(s){if(R(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new We;const{error:i}=await N(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(R(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:a}=await N(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:a,error:o}=await N(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Tr("You must provide either an email or phone number and a type")}catch(r){if(R(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await nt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Rn:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await nt(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=jn()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await N(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ve}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new We}:await N(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Ve})})}catch(r){if(R(r))return zc(r)&&(await this._removeSession(),await Fe(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new We;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await wt(this.storage,this.storageKey));const{data:u,error:c}=await N(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Ve});if(c)throw c;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(R(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new We;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=Mn(e.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(R(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:a,error:o}=r;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new We;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(R(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!Te())throw new Pr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Pr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new $s("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Pr("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new $s("No code detected.");const{data:_,error:g}=await this._exchangeCodeForSession(e.code);if(g)throw g;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!s||!o||!a||!u)throw new Pr("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(o);let h=c+d;l&&(h=parseInt(l));const f=h-c;f*1e3<=Et&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const p=h-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,c);const{data:v,error:y}=await this._getUser(s);if(y)throw y;const b={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:h,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(R(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await nt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Wc(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Fe(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=rd(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await wt(this.storage,this.storageKey,!0));try{return await N(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(R(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(R(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,u,c;const{data:d,error:h}=s;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await N(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return Te()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(R(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await N(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(R(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await ad(async i=>(i>0&&await sd(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await N(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Re})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Dn(s)&&Date.now()+a-n<Et})}catch(n){if(this._debug(r,"error",n),R(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),Te()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await nt(this.storage,this.storageKey);if(i&&this.userStorage){let a=await nt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Ot(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:jn()}else if(i&&!i.user&&!i.user){const a=await nt(this.storage,this.storageKey+"-user");a&&(a==null?void 0:a.user)?(i.user=a.user,await Fe(this.storage,this.storageKey+"-user"),await Ot(this.storage,this.storageKey,i)):i.user=jn()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Rn;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Rn}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Dn(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a==null?void 0:a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new We;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new fn;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new We;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),R(s)){const a={session:null,error:s};return Dn(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ot(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=Ks(i);await Ot(this.storage,this.storageKey,s)}else{const i=Ks(r);await Ot(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Fe(this.storage,this.storageKey),await Fe(this.storage,this.storageKey+"-code-verifier"),await Fe(this.storage,this.storageKey+"-user"),this.userStorage&&await Fe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Te()&&(window==null?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Et);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno!="undefined"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/Et);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Et}ms, refresh threshold is ${gi} ticks`),i<=gi&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof so)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Te()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await wt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await N(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(R(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await N(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&((i=l==null?void 0:l.totp)===null||i===void 0?void 0:i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(R(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await N(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(R(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await N(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(R(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Mn(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(o=>o.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+Fc>i)return n;const{data:s,error:a}=await N(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};n=f.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=Mn(n);r!=null&&r.allowExpired||fd(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:s,header:i,signature:a},error:null}}const c=pd(i.alg),d=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,a,Zc(`${o}.${l}`)))throw new _i("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(R(n))return{data:null,error:n};throw n}}}nr.nextInstanceID=0;const Cd=nr;class xd extends Cd{constructor(e){super(e)}}var Rd=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};class Dd{constructor(e,r,n){var i,s,a;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=Bc(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:Ic,realtime:xc,auth:Object.assign(Object.assign({},Cc),{storageKey:u}),global:kc},d=Lc(n!=null?n:{},c);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=jc(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Yu(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Ec(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Su(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return Rd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:o,debug:l},u,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new xd({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,flowType:a,lock:o,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new hc(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Md=(t,e,r)=>new Dd(t,e,r);function jd(){if(typeof window!="undefined"||typeof process=="undefined"||process.version===void 0||process.version===null)return!1;const t=process.version.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}jd()&&console.warn("\u26A0\uFE0F  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const $d=Object.freeze({APP_VERSION:"v0.5",APP_LAST_BUILD:"2025-05-11",COURSE_VERSION:"v0.1",COURSE_LAST_UPDATED:"2025-04-23",isDev:!0}),Bd={SUPABASE_URL:"https://auabwwzrkwmwnywitepf.supabase.co",SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF1YWJ3d3pya3dtd255d2l0ZXBmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM3MDE0NDYsImV4cCI6MjA2OTI3NzQ0Nn0.Oloo_3WxPBJvg9gFARu0_PdLr4Rmv7uZMmVmi2bRknc",GOOGLE_CLIENT:""};function Ld(){if($d.isDev)return Bd}var zs=Object.freeze(Ld());const D=Md(zs.SUPABASE_URL,zs.SUPABASE_ANON_KEY);async function Nd(){try{const{data:t,error:e}=await D.from("ADDITIONAL_PROMPT").select();return e?(console.error("from error",e.message),[]):t}catch(t){return console.error("Unexpected error:",t),[]}}async function Ud(t){try{const{data:e,error:r}=await D.from("ADDITIONAL_PROMPT").select().eq("HABIT_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function Kd(t){try{const{data:e,error:r}=await D.from("ADDITIONAL_PROMPT").select(`
                    *,
                    AP_OPT_METADATA(*)
                    `).eq("HABIT_ID",t);if(r)throw r;return e.map(n=>({...n,AP_OPTIONS:n.AP_OPT_METADATA||[]}))}catch(e){return console.error("Unexpected error:",e),[]}}async function qd(t){var e;try{const{data:r,error:n}=await D.from("ADDITIONAL_PROMPT").insert(t).select("AP_ID");if(n)throw n;return(e=r[0])==null?void 0:e.AP_ID}catch(r){return console.error("Unexpected error:",r),0}}async function Fd(t){var e;try{const{data:r,error:n}=await D.from("ADDITIONAL_PROMPT").upsert(t).select("AP_ID");if(n)throw n;return(e=r[0])==null?void 0:e.AP_ID}catch(r){return console.error("Unexpected error:",r),0}}async function Hd(t){try{const{data:e,error:r}=await D.from("ADDITIONAL_PROMPT").delete().eq("AP_ID",t.AP_ID);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}async function Wd(t){try{const{data:e,error:r}=await D.from("ADDITIONAL_PROMPT").delete().eq("HABIT_ID",t);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}var zd=Object.freeze(Object.defineProperty({__proto__:null,readAllAP:Nd,readAllAdditionalPrompt:Ud,readAdditionalPromptWithOption:Kd,createAdditionalPrompt:qd,updateAdditionalPrompt:Fd,deleteAdditionalPrompt:Hd,deleteAllAdditionalPrompt:Wd},Symbol.toStringTag,{value:"Module"}));async function Vd(){try{const{data:t,error:e}=await D.from("ADDITIONAL_PROMPT_ANSWERS").select();return e?(console.error("from error",e.message),[]):t}catch(t){return console.error("Unexpected error:",t),[]}}async function Jd(t,e){try{const{data:r,error:n}=await D.from("ADDITIONAL_PROMPT_ANSWERS").select().eq("AP_ID",t).eq("CMT_ID",e);return n?(console.error("from error",n.message),[]):r}catch(r){return console.error("Unexpected error:",r),[]}}async function Gd(t){var e;try{const{data:r,error:n}=await D.from("ADDITIONAL_PROMPT_ANSWERS").insert(t).select("APA_ID");if(n)throw n;return(e=r[0])==null?void 0:e.APA_ID}catch(r){return console.error("Unexpected error:",r),0}}async function Qd(t){var e;try{const{data:r,error:n}=await D.from("ADDITIONAL_PROMPT_ANSWERS").upsert(t).select("APA_ID");if(n)throw n;return(e=r[0])==null?void 0:e.APA_ID}catch(r){return console.error("Unexpected error:",r),0}}async function Yd(t){try{const{data:e,error:r}=await D.from("ADDITIONAL_PROMPT_ANSWERS").delete().eq("APA_ID",t.APA_ID);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}async function Xd(t){try{const{data:e,error:r}=await D.from("ADDITIONAL_PROMPT_ANSWERS").delete().eq("AP_ID",t);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}var Zd=Object.freeze(Object.defineProperty({__proto__:null,readAllAPAnswer:Vd,readAPAnswer:Jd,createAPAnswer:Gd,updateAPAnswer:Qd,deleteAPAnswer:Yd,deleteAllAPAnswer:Xd},Symbol.toStringTag,{value:"Module"}));async function eh(){try{const{data:t,error:e}=await D.from("AP_OPT_METADATA").select();return e?(console.error("from error",e.message),[]):t}catch(t){return console.error("Unexpected error:",t),[]}}async function th(t){try{const{data:e,error:r}=await D.from("AP_OPT_METADATA").select().eq("AP_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function rh(t){try{const{data:e,error:r}=await D.from("AP_OPT_METADATA").select().eq("OPTION_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function nh(t){var e;try{const{data:r,error:n}=await D.from("AP_OPT_METADATA").insert(t).select("OPTION_ID");if(n)throw n;return(e=r[0])==null?void 0:e.OPTION_ID}catch(r){return console.error("Unexpected error:",r),0}}async function ih(t){var e;try{const{data:r,error:n}=await D.from("AP_OPT_METADATA").upsert(t).select("OPTION_ID");if(n)throw n;return(e=r[0])==null?void 0:e.OPTION_ID}catch(r){return console.error("Unexpected error:",r),0}}async function sh(t){try{const{data:e,error:r}=await D.from("AP_OPT_METADATA").delete().eq("OPTION_ID",t.OPTION_ID);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}async function ah(t){try{const{data:e,error:r}=await D.from("AP_OPT_METADATA").delete().eq("AP_ID",t);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}var oh=Object.freeze(Object.defineProperty({__proto__:null,readAllAPOptionAll:eh,readAllAPOption:th,readOneAPOption:rh,createAPOption:nh,updateAPOption:ih,deleteAPOption:sh,deleteAllAPOption:ah},Symbol.toStringTag,{value:"Module"}));async function lh(){return await M.OPTION_SCORE.toArray()}async function uh(t){return await M.OPTION_SCORE.where({OPTION_ID:t}).toArray()}async function ch(t,e){return await M.OPTION_SCORE.where({OPTION_ID:t,FOR_MONTH:e}).toArray()}async function dh(t){return await M.OPTION_SCORE.add(t)}async function hh(t){return await M.OPTION_SCORE.put(t)}async function fh(t){return await M.OPTION_SCORE.where("OPT_SRC_ID").equals(t.OPT_SRC_ID).delete()}async function ph(t){return await M.OPTION_SCORE.where("OPTION_ID").equals(t).clear()}var vh=Object.freeze(Object.defineProperty({__proto__:null,readAllAPOptionScoreAll:lh,readAllAPOptionScore:uh,readAPOptionScoreForMonth:ch,createAPOptionScore:dh,updateAPOptionScore:hh,deleteAPOptionScore:fh,deleteAllAPOptionScore:ph},Symbol.toStringTag,{value:"Module"}));async function gh(){return await M.AP_PERFORMANCE.toArray()}async function yh(t,e){return await M.AP_PERFORMANCE.where({AP_ID:t,PERIODICITY:e}).toArray()}async function mh(t,e,r){return await M.AP_PERFORMANCE.where({AP_ID:t,PERIODICITY:e,REF_DATE:r}).toArray()}async function _h(t){return await M.AP_PERFORMANCE.add(t)}async function wh(t){return await M.AP_PERFORMANCE.put(t)}async function bh(t){return await M.AP_PERFORMANCE.where("HP_ID").equals(t.HP_ID).delete()}async function Ah(t){return await M.AP_PERFORMANCE.where("AP_ID").equals(t).clear()}var Th=Object.freeze(Object.defineProperty({__proto__:null,readAllAPPerformanceAll:gh,readAllAPPerformance:yh,readOneAPPerformance:mh,createAPPerformance:_h,updateAPPerformance:wh,deleteAPPerformance:bh,deleteAllAPPerformance:Ah},Symbol.toStringTag,{value:"Module"}));async function Ph(){try{const{data:t,error:e}=await D.from("CHECKMARKS_TRACKER").select();return e?(console.error("from error",e.message),[]):t}catch(t){return console.error("Unexpected error:",t),[]}}async function Eh(t){try{const{data:e,error:r}=await D.from("CHECKMARKS_TRACKER").select().eq("HABIT_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function Oh(t,e,r){try{const{data:n,error:i}=await D.from("CHECKMARKS_TRACKER").select("*").eq("HABIT_ID",t).gte("DATE",e).lte("DATE",r).order("DATE",{ascending:!1}).limit(10);return i?(console.error("from error",i.message),[]):n}catch(n){return console.error("Unexpected error:",n),[]}}async function Sh(t){try{const{data:e,error:r}=await D.from("CHECKMARKS_TRACKER").select("*",{count:"exact",head:!0}).eq("HABIT_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function kh(t){try{const{data:e,error:r}=await D.from("CHECKMARKS_TRACKER").select().eq("CMT_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function Ih(t,e){try{const{data:r,error:n}=await D.from("CHECKMARKS_TRACKER").select().eq("DATE",e).eq("HABIT_ID",t);return n?(console.error("from error",n.message),[]):r}catch(r){return console.error("Unexpected error:",r),[]}}async function Ch(t){var e;try{const{data:r,error:n}=await D.from("CHECKMARKS_TRACKER").insert(t).select("CMT_ID");if(n)throw n;return(e=r[0])==null?void 0:e.CMT_ID}catch(r){return console.error("Unexpected error:",r),0}}async function xh(t){var e;try{const{data:r,error:n}=await D.from("CHECKMARKS_TRACKER").upsert(t).select("CMT_ID");if(n)throw n;return(e=r[0])==null?void 0:e.CMT_ID}catch(r){return console.error("Unexpected error:",r),0}}async function Rh(t){try{const{data:e,error:r}=await D.from("CHECKMARKS_TRACKER").delete().eq("CMT_ID",t.CMT_ID);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}async function Dh(t){try{const{data:e,error:r}=await D.from("CHECKMARKS_TRACKER").delete().eq("HABIT_ID",t);if(r)throw r;return e}catch(e){return console.error("Unexpected error:",e),0}}var Mh=Object.freeze(Object.defineProperty({__proto__:null,readAllCheckMarkALL:Ph,readAllCheckMark:Eh,readCheckMarkWithPagination:Oh,readCheckMarkCount:Sh,readCheckMarkByID:kh,readCheckMarkonDate:Ih,createCheckMark:Ch,updateCheckMark:xh,deleteCheckMark:Rh,deleteAllCheckMark:Dh},Symbol.toStringTag,{value:"Module"}));async function jh(){return await M.HABIT_PERFORMANCE.toArray()}async function $h(t,e){return await M.HABIT_PERFORMANCE.where({HABIT_ID:t,PERIODICITY:e}).toArray()}async function Bh(t,e,r){return await M.HABIT_PERFORMANCE.where({HABIT_ID:t,PERIODICITY:e,REF_DATE:r}).toArray()}async function Lh(t){return await M.HABIT_PERFORMANCE.add(t)}async function Nh(t){return await M.HABIT_PERFORMANCE.put(t)}async function Uh(t){return await M.HABIT_PERFORMANCE.where("HP_ID").equals(t.HP_ID).delete()}async function Kh(t){return await M.HABIT_PERFORMANCE.where("HABIT_ID").equals(t).clear()}var qh=Object.freeze(Object.defineProperty({__proto__:null,readAllPerformanceAll:jh,readAllPerformance:$h,readOnePerformance:Bh,createPerformance:Lh,updatePerformance:Nh,deletePerformance:Uh,deleteAllPerformance:Kh},Symbol.toStringTag,{value:"Module"}));async function Fh(){try{const{data:t,error:e}=await D.from("HABIT_METADATA").select();return e?(console.error("from error",e.message),[]):t}catch(t){return console.error("Unexpected error:",t),[]}}async function Hh(t){try{const{data:e,error:r}=await D.from("HABIT_METADATA").select().eq("HABIT_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function Wh(t){var e;try{const{data:r,error:n}=await D.from("HABIT_METADATA").insert(t).select("HABIT_ID");if(n)throw n;return(e=r[0])==null?void 0:e.HABIT_ID}catch(r){return console.error("Unexpected error:",r),0}}async function zh(t){var e;try{const{data:r,error:n}=await D.from("HABIT_METADATA").upsert(t).select("HABIT_ID");if(n)throw n;return(e=r[0])==null?void 0:e.HABIT_ID}catch(r){return console.error("Unexpected error:",r),0}}async function Vh(t){try{const{data:e,error:r}=await D.from("HABIT_METADATA").delete().eq("HABIT_ID",t.HABIT_ID);if(r)throw r;return e[0]}catch(e){return console.error("Unexpected error:",e),0}}async function Jh(){try{const{data:t,error:e}=await D.from("HABIT_METADATA").delete();if(e)throw e;return t[0]}catch(t){return console.error("Unexpected error:",t),0}}var Gh=Object.freeze(Object.defineProperty({__proto__:null,readAllHabit:Fh,readOneHabitdetails:Hh,createHabit:Wh,updateHabit:zh,deleteHabit:Vh,deleteAllHabit:Jh},Symbol.toStringTag,{value:"Module"}));async function Qh(){try{const{data:t,error:e}=await D.from("OPTION_METADATA").select();return e?(console.error("from error",e.message),[]):t}catch(t){return console.error("Unexpected error:",t),[]}}async function Yh(t){try{const{data:e,error:r}=await D.from("OPTION_METADATA").select().eq("HABIT_ID",t);return r?(console.error("from error",r.message),[]):e}catch(e){return console.error("Unexpected error:",e),[]}}async function Xh(t){var e;try{const{data:r,error:n}=await D.from("OPTION_METADATA").insert(t).select("OPTION_ID");if(n)throw n;return(e=r[0])==null?void 0:e.OPTION_ID}catch(r){return console.error("Unexpected error:",r),0}}async function Zh(t){var e;try{const{data:r,error:n}=await D.from("OPTION_METADATA").upsert(t).select("OPTION_ID");if(n)throw n;return(e=r[0])==null?void 0:e.OPTION_ID}catch(r){return console.error("Unexpected error:",r),0}}async function ef(t){try{const{data:e,error:r}=await D.from("OPTION_METADATA").delete().eq("OPTION_ID",t.OPTION_ID);if(r)throw r;return e[0]}catch(e){return console.error("Unexpected error:",e),0}}async function tf(t){try{const{data:e,error:r}=await D.from("OPTION_METADATA").delete().eq("HABIT_ID",t);if(r)throw r;return e[0]}catch(e){return console.error("Unexpected error:",e),0}}var rf=Object.freeze(Object.defineProperty({__proto__:null,readAllOptionAll:Qh,readAllOption:Yh,createOption:Xh,updateOption:Zh,deleteOption:ef,deleteAllOption:tf},Symbol.toStringTag,{value:"Module"}));async function nf(){return await M.OPTION_SCORE.toArray()}async function sf(t){return await M.OPTION_SCORE.where({OPTION_ID:t}).toArray()}async function af(t,e){return await M.OPTION_SCORE.where({OPTION_ID:t,FOR_MONTH:e}).toArray()}async function of(t){return await M.OPTION_SCORE.add(t)}async function lf(t){return await M.OPTION_SCORE.put(t)}async function uf(t){return await M.OPTION_SCORE.where("OPT_SRC_ID").equals(t.OPT_SRC_ID).delete()}async function cf(t){return await M.OPTION_SCORE.where("OPTION_ID").equals(t).clear()}var df=Object.freeze(Object.defineProperty({__proto__:null,readAllOptionScoreAll:nf,readAllOptionScore:sf,readOptionScoreForMonth:af,createOptionScore:of,updateOptionScore:lf,deleteOptionScore:uf,deleteAllOptionScore:cf},Symbol.toStringTag,{value:"Module"}));async function hf(){return await M.HABIT_REMINDER_METADATA.toArray()}async function ff(t){return await M.HABIT_REMINDER_METADATA.where({HABIT_ID:t}).toArray()}async function pf(t){return await M.HABIT_REMINDER_METADATA.add(t)}async function vf(t){return await M.HABIT_REMINDER_METADATA.put(t)}async function gf(t){return await M.HABIT_REMINDER_METADATA.where("HR_ID").equals(t.HR_ID).delete()}async function yf(t){return await M.HABIT_REMINDER_METADATA.where("HABIT_ID").equals(t).clear()}var mf=Object.freeze(Object.defineProperty({__proto__:null,readAllRemiderAll:hf,readAllRemider:ff,createRemider:pf,updateRemider:vf,deleteRemider:gf,deleteAllRemider:yf},Symbol.toStringTag,{value:"Module"}));async function _f(){return await M.TARGET_AND_TITLE.toArray()}async function wf(t){return await M.TARGET_AND_TITLE.where({HABIT_ID:t}).toArray()}async function bf(t){return await M.TARGET_AND_TITLE.add(t)}async function Af(t){return await M.TARGET_AND_TITLE.put(t)}async function Tf(t){return await M.TARGET_AND_TITLE.where("TT_ID").equals(t.TT_ID).delete()}async function Pf(t){return await M.TARGET_AND_TITLE.where("HABIT_ID").equals(t).clear()}var Ef=Object.freeze(Object.defineProperty({__proto__:null,readAllTargetAll:_f,readAllTarget:wf,createTarget:bf,updateTarget:Af,deleteTarget:Tf,deleteAllTarget:Pf},Symbol.toStringTag,{value:"Module"}));const E={...zd,...Zd,...oh,...vh,...Th,...Mh,...qh,...Gh,...rf,...df,...mf,...Ef},j={readAllAP:E.readAllAP,readAllAdditionalPrompt:E.readAllAdditionalPrompt,readAdditionalPromptWithOption:E.readAdditionalPromptWithOption,createAdditionalPrompt:E.createAdditionalPrompt,updateAdditionalPrompt:E.updateAdditionalPrompt,deleteAdditionalPrompt:E.deleteAdditionalPrompt,deleteAllAdditionalPrompt:E.deleteAllAdditionalPrompt,readAllAPAnswer:E.readAllAPAnswer,readAPAnswer:E.readAPAnswer,createAPAnswer:E.createAPAnswer,updateAPAnswer:E.updateAPAnswer,deleteAPAnswer:E.deleteAPAnswer,deleteAllAPAnswer:E.deleteAllAPAnswer,readAllAPOptionAll:E.readAllAPOptionAll,readAllAPOption:E.readAllAPOption,readOneAPOption:E.readOneAPOption,createAPOption:E.createAPOption,updateAPOption:E.updateAPOption,deleteAPOption:E.deleteAPOption,deleteAllAPOption:E.deleteAllAPOption,readAllAPOptionScoreAll:E.readAllAPOptionScoreAll,readAllAPOptionScore:E.readAllAPOptionScore,readAPOptionScoreForMonth:E.readAPOptionScoreForMonth,createAPOptionScore:E.createAPOptionScore,updateAPOptionScore:E.updateAPOptionScore,deleteAPOptionScore:E.deleteAPOptionScore,deleteAllAPOptionScore:E.deleteAllAPOptionScore,readAllAPPerformanceAll:E.readAllAPPerformanceAll,readAllAPPerformance:E.readAllAPPerformance,readOneAPPerformance:E.readOneAPPerformance,createAPPerformance:E.createAPPerformance,updateAPPerformance:E.updateAPPerformance,deleteAPPerformance:E.deleteAPPerformance,deleteAllAPPerformance:E.deleteAllAPPerformance,readAllCheckMarkALL:E.readAllCheckMarkALL,readAllCheckMark:E.readAllCheckMark,readCheckMarkWithPagination:E.readCheckMarkWithPagination,readCheckMarkCount:E.readCheckMarkCount,readCheckMarkByID:E.readCheckMarkByID,readCheckMarkonDate:E.readCheckMarkonDate,createCheckMark:E.createCheckMark,updateCheckMark:E.updateCheckMark,deleteCheckMark:E.deleteCheckMark,deleteAllCheckMark:E.deleteAllCheckMark,readAllPerformanceAll:E.readAllPerformanceAll,readAllPerformance:E.readAllPerformance,readOnePerformance:E.readOnePerformance,createPerformance:E.createPerformance,updatePerformance:E.updatePerformance,deletePerformance:E.deletePerformance,deleteAllPerformance:E.deleteAllPerformance,readAllHabit:E.readAllHabit,readOneHabitdetails:E.readOneHabitdetails,createHabit:E.createHabit,updateHabit:E.updateHabit,deleteHabit:E.deleteHabit,deleteAllHabit:E.deleteAllHabit,readAllOptionAll:E.readAllOptionAll,readAllOption:E.readAllOption,createOption:E.createOption,updateOption:E.updateOption,deleteOption:E.deleteOption,deleteAllOption:E.deleteAllOption,readAllOptionScoreAll:E.readAllOptionScoreAll,readAllOptionScore:E.readAllOptionScore,readOptionScoreForMonth:E.readOptionScoreForMonth,createOptionScore:E.createOptionScore,updateOptionScore:E.updateOptionScore,deleteOptionScore:E.deleteOptionScore,deleteAllOptionScore:E.deleteAllOptionScore,readAllRemiderAll:E.readAllRemiderAll,readAllRemider:E.readAllRemider,createRemider:E.createRemider,updateRemider:E.updateRemider,deleteRemider:E.deleteRemider,deleteAllRemider:E.deleteAllRemider,readAllTargetAll:E.readAllTargetAll,readAllTarget:E.readAllTarget,createTarget:E.createTarget,updateTarget:E.updateTarget,deleteTarget:E.deleteTarget,deleteAllTarget:E.deleteAllTarget,deleteDatabase:E.deleteDatabase,openDatabase:E.openDatabase,clearAllTables:E.clearAllTables},ap=j.readAllAP,op=j.readAllAdditionalPrompt,lp=j.readAdditionalPromptWithOption,up=j.createAdditionalPrompt,cp=j.updateAdditionalPrompt,dp=j.readAllAPAnswer,hp=j.readAPAnswer,fp=j.createAPAnswer,pp=j.updateAPAnswer,vp=j.readAllAPOptionAll,gp=j.readAllAPOption,yp=j.createAPOption,mp=j.updateAPOption,_p=j.readAllAPOptionScoreAll,wp=j.readAllAPPerformanceAll,bp=j.readOneAPPerformance,Ap=j.createAPPerformance,Tp=j.updateAPPerformance,Pp=j.readAllCheckMarkALL,Ep=j.readCheckMarkWithPagination,Op=j.readCheckMarkCount,Sp=j.readCheckMarkByID,kp=j.readCheckMarkonDate,Ip=j.createCheckMark,Cp=j.updateCheckMark,xp=j.readAllPerformanceAll,Rp=j.readOnePerformance,Dp=j.createPerformance,Mp=j.updatePerformance,jp=j.readAllHabit,$p=j.readOneHabitdetails,Bp=j.createHabit,Lp=j.updateHabit,Np=j.readAllOptionAll,Up=j.readAllOption,Kp=j.createOption,qp=j.updateOption,Fp=j.readAllOptionScoreAll,Hp=j.readAllRemiderAll,Wp=j.readAllTargetAll,zp=j.createTarget,Xi={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function Zi({showing:t,avoidEmit:e,configureAnchorEl:r}){const{props:n,proxy:i,emit:s}=Ie(),a=re(null);let o=null;function l(f){return a.value===null?!1:f===void 0||f.touches===void 0||f.touches.length<=1}const u={};r===void 0&&(Object.assign(u,{hide(f){i.hide(f)},toggle(f){i.toggle(f),f.qAnchorHandled=!0},toggleKey(f){tn(f,13)===!0&&u.toggle(f)},contextClick(f){i.hide(f),Dr(f),jr(()=>{i.show(f),f.qAnchorHandled=!0})},prevent:Dr,mobileTouch(f){if(u.mobileCleanup(f),l(f)!==!0)return;i.hide(f),a.value.classList.add("non-selectable");const p=f.target;Je(u,"anchor",[[p,"touchmove","mobileCleanup","passive"],[p,"touchend","mobileCleanup","passive"],[p,"touchcancel","mobileCleanup","passive"],[a.value,"contextmenu","prevent","notPassive"]]),o=setTimeout(()=>{o=null,i.show(f),f.qAnchorHandled=!0},300)},mobileCleanup(f){a.value.classList.remove("non-selectable"),o!==null&&(clearTimeout(o),o=null),t.value===!0&&f!==void 0&&Br()}}),r=function(f=n.contextMenu){if(n.noParentEvent===!0||a.value===null)return;let p;f===!0?i.$q.platform.is.mobile===!0?p=[[a.value,"touchstart","mobileTouch","passive"]]:p=[[a.value,"mousedown","hide","passive"],[a.value,"contextmenu","contextClick","notPassive"]]:p=[[a.value,"click","toggle","passive"],[a.value,"keyup","toggleKey","passive"]],Je(u,"anchor",p)});function c(){St(u,"anchor")}function d(f){for(a.value=f;a.value.classList.contains("q-anchor--skip");)a.value=a.value.parentNode;r()}function h(){if(n.target===!1||n.target===""||i.$el.parentNode===null)a.value=null;else if(n.target===!0)d(i.$el.parentNode);else{let f=n.target;if(typeof n.target=="string")try{f=document.querySelector(n.target)}catch{f=void 0}f!=null?(a.value=f.$el||f,r()):(a.value=null,console.error(`Anchor: target "${n.target}" not found`))}}return _e(()=>n.contextMenu,f=>{a.value!==null&&(c(),r(f))}),_e(()=>n.target,()=>{a.value!==null&&c(),h()}),_e(()=>n.noParentEvent,f=>{a.value!==null&&(f===!0?c():r())}),Zs(()=>{h(),e!==!0&&n.modelValue===!0&&a.value===null&&s("update:modelValue",!1)}),Ne(()=>{o!==null&&clearTimeout(o),c()}),{anchorEl:a,canShow:l,anchorEvents:u}}function ao(t,e){const r=re(null);let n;function i(o,l){const u=`${l!==void 0?"add":"remove"}EventListener`,c=l!==void 0?l:n;o!==window&&o[u]("scroll",c,Oe.passive),window[u]("scroll",c,Oe.passive),n=l}function s(){r.value!==null&&(i(r.value),r.value=null)}const a=_e(()=>t.noParentEvent,()=>{r.value!==null&&(s(),e())});return Ne(a),{localScrollTarget:r,unconfigureScrollTarget:s,changeScrollEvent:i}}const It=[];function Of(t){return It.find(e=>e.contentEl!==null&&e.contentEl.contains(t))}function oo(t,e){do{if(t.$options.name==="QMenu"){if(t.hide(e),t.$props.separateClosePopup===!0)return Or(t)}else if(t.__qPortal===!0){const r=Or(t);return r!==void 0&&r.$options.name==="QPopupProxy"?(t.hide(e),r):t}t=Or(t)}while(t!=null)}function Sf(t,e,r){for(;r!==0&&t!==void 0&&t!==null;){if(t.__qPortal===!0){if(r--,t.$options.name==="QMenu"){t=oo(t,e);continue}t.hide(e)}t=Or(t)}}const kf=ke({name:"QPortal",setup(t,{slots:e}){return()=>e.default()}});function If(t){for(t=t.parent;t!=null;){if(t.type.name==="QGlobalDialog")return!0;if(t.type.name==="QDialog"||t.type.name==="QMenu")return!1;t=t.parent}return!1}function es(t,e,r,n){const i=re(!1),s=re(!1);let a=null;const o={},l=n==="dialog"&&If(t);function u(d){if(d===!0){os(o),s.value=!0;return}s.value=!1,i.value===!1&&(l===!1&&a===null&&(a=So(!1,n)),i.value=!0,It.push(t.proxy),Lo(o))}function c(d){if(s.value=!1,d!==!0)return;os(o),i.value=!1;const h=It.indexOf(t.proxy);h!==-1&&It.splice(h,1),a!==null&&(ko(a),a=null)}return Eo(()=>{c(!0)}),t.proxy.__qPortal=!0,ra(t.proxy,"contentEl",()=>e.value),{showPortal:u,hidePortal:c,portalIsActive:i,portalIsAccessible:s,renderPortal:()=>l===!0?r():i.value===!0?[ae(Oo,{to:a},ae(kf,r))]:void 0}}const ts={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function rs(t,e=()=>{},r=()=>{}){return{transitionProps:F(()=>{const n=`q-transition--${t.transitionShow||e()}`,i=`q-transition--${t.transitionHide||r()}`;return{appear:!0,enterFromClass:`${n}-enter-from`,enterActiveClass:`${n}-enter-active`,enterToClass:`${n}-enter-to`,leaveFromClass:`${i}-leave-from`,leaveActiveClass:`${i}-leave-active`,leaveToClass:`${i}-leave-to`}}),transitionStyle:F(()=>`--q-transition-duration: ${t.transitionDuration}ms`)}}function ns(){let t;const e=Ie();function r(){t=void 0}return ea(r),Ne(r),{removeTick:r,registerTick(n){t=n,jr(()=>{t===n&&(ta(e)===!1&&t(),t=void 0)})}}}const ct=[];let Rt;function Cf(t){Rt=t.keyCode===27}function xf(){Rt===!0&&(Rt=!1)}function Rf(t){Rt===!0&&(Rt=!1,tn(t,27)===!0&&ct[ct.length-1](t))}function lo(t){window[t]("keydown",Cf),window[t]("blur",xf),window[t]("keyup",Rf),Rt=!1}function uo(t){me.is.desktop===!0&&(ct.push(t),ct.length===1&&lo("addEventListener"))}function Gr(t){const e=ct.indexOf(t);e!==-1&&(ct.splice(e,1),ct.length===0&&lo("removeEventListener"))}const dt=[];function co(t){dt[dt.length-1](t)}function ho(t){me.is.desktop===!0&&(dt.push(t),dt.length===1&&document.body.addEventListener("focusin",co))}function wi(t){const e=dt.indexOf(t);e!==-1&&(dt.splice(e,1),dt.length===0&&document.body.removeEventListener("focusin",co))}const{notPassiveCapture:Qr}=Oe,ht=[];function Yr(t){const e=t.target;if(e===void 0||e.nodeType===8||e.classList.contains("no-pointer-events")===!0)return;let r=It.length-1;for(;r>=0;){const n=It[r].$;if(n.type.name==="QTooltip"){r--;continue}if(n.type.name!=="QDialog")break;if(n.props.seamless!==!0)return;r--}for(let n=ht.length-1;n>=0;n--){const i=ht[n];if((i.anchorEl.value===null||i.anchorEl.value.contains(e)===!1)&&(e===document.body||i.innerRef.value!==null&&i.innerRef.value.contains(e)===!1))t.qClickOutside=!0,i.onClickOutside(t);else return}}function fo(t){ht.push(t),ht.length===1&&(document.addEventListener("mousedown",Yr,Qr),document.addEventListener("touchstart",Yr,Qr))}function Xr(t){const e=ht.findIndex(r=>r===t);e!==-1&&(ht.splice(e,1),ht.length===0&&(document.removeEventListener("mousedown",Yr,Qr),document.removeEventListener("touchstart",Yr,Qr)))}let Vs,Js;function Zr(t){const e=t.split(" ");return e.length!==2?!1:["top","center","bottom"].includes(e[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(e[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function po(t){return t?!(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number"):!0}const bi={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(t=>{bi[`${t}#ltr`]=t,bi[`${t}#rtl`]=t});function en(t,e){const r=t.split(" ");return{vertical:r[0],horizontal:bi[`${r[1]}#${e===!0?"rtl":"ltr"}`]}}function Df(t,e){let{top:r,left:n,right:i,bottom:s,width:a,height:o}=t.getBoundingClientRect();return e!==void 0&&(r-=e[1],n-=e[0],s+=e[1],i+=e[0],a+=e[0],o+=e[1]),{top:r,bottom:s,height:o,left:n,right:i,width:a,middle:n+(i-n)/2,center:r+(s-r)/2}}function Mf(t,e,r){let{top:n,left:i}=t.getBoundingClientRect();return n+=e.top,i+=e.left,r!==void 0&&(n+=r[1],i+=r[0]),{top:n,bottom:n+1,height:1,left:i,right:i+1,width:1,middle:i,center:n}}function jf(t,e){return{top:0,center:e/2,bottom:e,left:0,middle:t/2,right:t}}function Gs(t,e,r,n){return{top:t[r.vertical]-e[n.vertical],left:t[r.horizontal]-e[n.horizontal]}}function is(t,e=0){if(t.targetEl===null||t.anchorEl===null||e>5)return;if(t.targetEl.offsetHeight===0||t.targetEl.offsetWidth===0){setTimeout(()=>{is(t,e+1)},10);return}const{targetEl:r,offset:n,anchorEl:i,anchorOrigin:s,selfOrigin:a,absoluteOffset:o,fit:l,cover:u,maxHeight:c,maxWidth:d}=t;if(me.is.ios===!0&&window.visualViewport!==void 0){const A=document.body.style,{offsetLeft:T,offsetTop:P}=window.visualViewport;T!==Vs&&(A.setProperty("--q-pe-left",T+"px"),Vs=T),P!==Js&&(A.setProperty("--q-pe-top",P+"px"),Js=P)}const{scrollLeft:h,scrollTop:f}=r,p=o===void 0?Df(i,u===!0?[0,0]:n):Mf(i,o,n);Object.assign(r.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:d||"100vw",maxHeight:c||"100vh",visibility:"visible"});const{offsetWidth:v,offsetHeight:y}=r,{elWidth:b,elHeight:_}=l===!0||u===!0?{elWidth:Math.max(p.width,v),elHeight:u===!0?Math.max(p.height,y):y}:{elWidth:v,elHeight:y};let g={maxWidth:d,maxHeight:c};(l===!0||u===!0)&&(g.minWidth=p.width+"px",u===!0&&(g.minHeight=p.height+"px")),Object.assign(r.style,g);const w=jf(b,_);let m=Gs(p,w,s,a);if(o===void 0||n===void 0)Bn(m,p,w,s,a);else{const{top:A,left:T}=m;Bn(m,p,w,s,a);let P=!1;if(m.top!==A){P=!0;const S=2*n[1];p.center=p.top-=S,p.bottom-=S+2}if(m.left!==T){P=!0;const S=2*n[0];p.middle=p.left-=S,p.right-=S+2}P===!0&&(m=Gs(p,w,s,a),Bn(m,p,w,s,a))}g={top:m.top+"px",left:m.left+"px"},m.maxHeight!==void 0&&(g.maxHeight=m.maxHeight+"px",p.height>m.maxHeight&&(g.minHeight=g.maxHeight)),m.maxWidth!==void 0&&(g.maxWidth=m.maxWidth+"px",p.width>m.maxWidth&&(g.minWidth=g.maxWidth)),Object.assign(r.style,g),r.scrollTop!==f&&(r.scrollTop=f),r.scrollLeft!==h&&(r.scrollLeft=h)}function Bn(t,e,r,n,i){const s=r.bottom,a=r.right,o=Bo(),l=window.innerHeight-o,u=document.body.clientWidth;if(t.top<0||t.top+s>l)if(i.vertical==="center")t.top=e[n.vertical]>l/2?Math.max(0,l-s):0,t.maxHeight=Math.min(s,l);else if(e[n.vertical]>l/2){const c=Math.min(l,n.vertical==="center"?e.center:n.vertical===i.vertical?e.bottom:e.top);t.maxHeight=Math.min(s,c),t.top=Math.max(0,c-s)}else t.top=Math.max(0,n.vertical==="center"?e.center:n.vertical===i.vertical?e.top:e.bottom),t.maxHeight=Math.min(s,l-t.top);if(t.left<0||t.left+a>u)if(t.maxWidth=Math.min(a,u),i.horizontal==="middle")t.left=e[n.horizontal]>u/2?Math.max(0,u-a):0;else if(e[n.horizontal]>u/2){const c=Math.min(u,n.horizontal==="middle"?e.middle:n.horizontal===i.horizontal?e.right:e.left);t.maxWidth=Math.min(a,c),t.left=Math.max(0,c-t.maxWidth)}else t.left=Math.max(0,n.horizontal==="middle"?e.middle:n.horizontal===i.horizontal?e.left:e.right),t.maxWidth=Math.min(a,u-t.left)}var $f=ke({name:"QMenu",inheritAttrs:!1,props:{...Xi,...Ei,...Ai,...ts,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:Zr},self:{type:String,validator:Zr},offset:{type:Array,validator:po},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Oi,"click","escapeKey"],setup(t,{slots:e,emit:r,attrs:n}){let i=null,s,a,o;const l=Ie(),{proxy:u}=l,{$q:c}=u,d=re(null),h=re(!1),f=F(()=>t.persistent!==!0&&t.noRouteDismiss!==!0),p=Ti(t,c),{registerTick:v,removeTick:y}=ns(),{registerTimeout:b}=ki(),{transitionProps:_,transitionStyle:g}=rs(t),{localScrollTarget:w,changeScrollEvent:m,unconfigureScrollTarget:A}=ao(t,z),{anchorEl:T,canShow:P}=Zi({showing:h}),{hide:S}=Si({showing:h,canShow:P,handleShow:te,handleHide:ce,hideOnRouteChange:f,processOnMount:!0}),{showPortal:I,hidePortal:U,renderPortal:K}=es(l,d,qe,"menu"),B={anchorEl:T,innerRef:d,onClickOutside(L){if(t.persistent!==!0&&h.value===!0)return S(L),(L.type==="touchstart"||L.target.classList.contains("q-dialog__backdrop"))&&sr(L),!0}},G=F(()=>en(t.anchor||(t.cover===!0?"center middle":"bottom start"),c.lang.rtl)),C=F(()=>t.cover===!0?G.value:en(t.self||"top start",c.lang.rtl)),Q=F(()=>(t.square===!0?" q-menu--square":"")+(p.value===!0?" q-menu--dark q-dark":"")),X=F(()=>t.autoClose===!0?{onClick:Z}:{}),oe=F(()=>h.value===!0&&t.persistent!==!0);_e(oe,L=>{L===!0?(uo($),fo(B)):(Gr($),Xr(B))});function ee(){sa(()=>{let L=d.value;L&&L.contains(document.activeElement)!==!0&&(L=L.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||L.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||L.querySelector("[autofocus], [data-autofocus]")||L,L.focus({preventScroll:!0}))})}function te(L){if(i=t.noRefocus===!1?document.activeElement:null,ho(ue),I(),z(),s=void 0,L!==void 0&&(t.touchPosition||t.contextMenu)){const et=Mr(L);if(et.left!==void 0){const{top:vo,left:go}=T.value.getBoundingClientRect();s={left:et.left-go,top:et.top-vo}}}a===void 0&&(a=_e(()=>c.screen.width+"|"+c.screen.height+"|"+t.self+"|"+t.anchor+"|"+c.lang.rtl,Y)),t.noFocus!==!0&&document.activeElement.blur(),v(()=>{Y(),t.noFocus!==!0&&ee()}),b(()=>{c.platform.is.ios===!0&&(o=t.autoClose,d.value.click()),Y(),I(!0),r("show",L)},t.transitionDuration)}function ce(L){y(),U(),le(!0),i!==null&&(L===void 0||L.qClickOutside!==!0)&&(((L&&L.type.indexOf("key")===0?i.closest('[tabindex]:not([tabindex^="-"])'):void 0)||i).focus(),i=null),b(()=>{U(!0),r("hide",L)},t.transitionDuration)}function le(L){s=void 0,a!==void 0&&(a(),a=void 0),(L===!0||h.value===!0)&&(wi(ue),A(),Xr(B),Gr($)),L!==!0&&(i=null)}function z(){(T.value!==null||t.scrollTarget!==void 0)&&(w.value=ia(T.value,t.scrollTarget),m(w.value,Y))}function Z(L){o!==!0?(oo(u,L),r("click",L)):o=!1}function ue(L){oe.value===!0&&t.noFocus!==!0&&na(d.value,L.target)!==!0&&ee()}function $(L){r("escapeKey"),S(L)}function Y(){is({targetEl:d.value,offset:t.offset,anchorEl:T.value,anchorOrigin:G.value,selfOrigin:C.value,absoluteOffset:s,fit:t.fit,cover:t.cover,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function qe(){return ae($r,_.value,()=>h.value===!0?ae("div",{role:"menu",...n,ref:d,tabindex:-1,class:["q-menu q-position-engine scroll"+Q.value,n.class],style:[n.style,g.value],...X.value},ir(e.default)):null)}return Ne(le),Object.assign(u,{focus:ee,updatePosition:Y}),K}}),Vp=ke({name:"QTooltip",inheritAttrs:!1,props:{...Xi,...Ei,...ts,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:Zr},self:{type:String,default:"top middle",validator:Zr},offset:{type:Array,default:()=>[14,14],validator:po},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...Oi],setup(t,{slots:e,emit:r,attrs:n}){let i,s;const a=Ie(),{proxy:{$q:o}}=a,l=re(null),u=re(!1),c=F(()=>en(t.anchor,o.lang.rtl)),d=F(()=>en(t.self,o.lang.rtl)),h=F(()=>t.persistent!==!0),{registerTick:f,removeTick:p}=ns(),{registerTimeout:v}=ki(),{transitionProps:y,transitionStyle:b}=rs(t),{localScrollTarget:_,changeScrollEvent:g,unconfigureScrollTarget:w}=ao(t,te),{anchorEl:m,canShow:A,anchorEvents:T}=Zi({showing:u,configureAnchorEl:ee}),{show:P,hide:S}=Si({showing:u,canShow:A,handleShow:B,handleHide:G,hideOnRouteChange:h,processOnMount:!0});Object.assign(T,{delayShow:X,delayHide:oe});const{showPortal:I,hidePortal:U,renderPortal:K}=es(a,l,le,"tooltip");if(o.platform.is.mobile===!0){const z={anchorEl:m,innerRef:l,onClickOutside(ue){return S(ue),ue.target.classList.contains("q-dialog__backdrop")&&sr(ue),!0}},Z=F(()=>t.modelValue===null&&t.persistent!==!0&&u.value===!0);_e(Z,ue=>{(ue===!0?fo:Xr)(z)}),Ne(()=>{Xr(z)})}function B(z){I(),f(()=>{s=new MutationObserver(()=>Q()),s.observe(l.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),Q(),te()}),i===void 0&&(i=_e(()=>o.screen.width+"|"+o.screen.height+"|"+t.self+"|"+t.anchor+"|"+o.lang.rtl,Q)),v(()=>{I(!0),r("show",z)},t.transitionDuration)}function G(z){p(),U(),C(),v(()=>{U(!0),r("hide",z)},t.transitionDuration)}function C(){s!==void 0&&(s.disconnect(),s=void 0),i!==void 0&&(i(),i=void 0),w(),St(T,"tooltipTemp")}function Q(){is({targetEl:l.value,offset:t.offset,anchorEl:m.value,anchorOrigin:c.value,selfOrigin:d.value,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function X(z){if(o.platform.is.mobile===!0){Br(),document.body.classList.add("non-selectable");const Z=m.value,ue=["touchmove","touchcancel","touchend","click"].map($=>[Z,$,"delayHide","passiveCapture"]);Je(T,"tooltipTemp",ue)}v(()=>{P(z)},t.delay)}function oe(z){o.platform.is.mobile===!0&&(St(T,"tooltipTemp"),Br(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),v(()=>{S(z)},t.hideDelay)}function ee(){if(t.noParentEvent===!0||m.value===null)return;const z=o.platform.is.mobile===!0?[[m.value,"touchstart","delayShow","passive"]]:[[m.value,"mouseenter","delayShow","passive"],[m.value,"mouseleave","delayHide","passive"]];Je(T,"anchor",z)}function te(){if(m.value!==null||t.scrollTarget!==void 0){_.value=ia(m.value,t.scrollTarget);const z=t.noParentEvent===!0?Q:S;g(_.value,z)}}function ce(){return u.value===!0?ae("div",{...n,ref:l,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,b.value],role:"tooltip"},ir(e.default)):null}function le(){return ae($r,y.value,ce)}return Ne(C),Object.assign(a.proxy,{updatePosition:Q}),K}});function Jp(){let t=Object.create(null);return{getCache:(e,r)=>t[e]===void 0?t[e]=typeof r=="function"?r():r:t[e],setCache(e,r){t[e]=r},hasCache(e){return t.hasOwnProperty(e)},clearCache(e){e!==void 0?delete t[e]:t={}}}}let Er=0;const Bf={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Qs={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var Lf=ke({name:"QDialog",inheritAttrs:!1,props:{...Ei,...ts,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:t=>t==="standard"||["top","bottom","left","right"].includes(t)}},emits:[...Oi,"shake","click","escapeKey"],setup(t,{slots:e,emit:r,attrs:n}){const i=Ie(),s=re(null),a=re(!1),o=re(!1);let l=null,u=null,c,d;const h=F(()=>t.persistent!==!0&&t.noRouteDismiss!==!0&&t.seamless!==!0),{preventBodyScroll:f}=Go(),{registerTimeout:p}=ki(),{registerTick:v,removeTick:y}=ns(),{transitionProps:b,transitionStyle:_}=rs(t,()=>Qs[t.position][0],()=>Qs[t.position][1]),g=F(()=>_.value+(t.backdropFilter!==void 0?`;backdrop-filter:${t.backdropFilter};-webkit-backdrop-filter:${t.backdropFilter}`:"")),{showPortal:w,hidePortal:m,portalIsAccessible:A,renderPortal:T}=es(i,s,ue,"dialog"),{hide:P}=Si({showing:a,hideOnRouteChange:h,handleShow:C,handleHide:Q,processOnMount:!0}),{addToHistory:S,removeFromHistory:I}=Wo(a,P,h),U=F(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${t.maximized===!0?"maximized":"minimized"} q-dialog__inner--${t.position} ${Bf[t.position]}`+(o.value===!0?" q-dialog__inner--animating":"")+(t.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(t.fullHeight===!0?" q-dialog__inner--fullheight":"")+(t.square===!0?" q-dialog__inner--square":"")),K=F(()=>a.value===!0&&t.seamless!==!0),B=F(()=>t.autoClose===!0?{onClick:le}:{}),G=F(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${K.value===!0?"modal":"seamless"}`,n.class]);_e(()=>t.maximized,$=>{a.value===!0&&ce($)}),_e(K,$=>{f($),$===!0?(ho(Z),uo(ee)):(wi(Z),Gr(ee))});function C($){S(),u=t.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,ce(t.maximized),w(),o.value=!0,t.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),v(X)):y(),p(()=>{if(i.proxy.$q.platform.is.ios===!0){if(t.seamless!==!0&&document.activeElement){const{top:Y,bottom:qe}=document.activeElement.getBoundingClientRect(),{innerHeight:L}=window,et=window.visualViewport!==void 0?window.visualViewport.height:L;Y>0&&qe>et/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-et,qe>=L?1/0:Math.ceil(document.scrollingElement.scrollTop+qe-et/2))),document.activeElement.scrollIntoView()}d=!0,s.value.click(),d=!1}w(!0),o.value=!1,r("show",$)},t.transitionDuration)}function Q($){y(),I(),te(!0),o.value=!0,m(),u!==null&&((($&&$.type.indexOf("key")===0?u.closest('[tabindex]:not([tabindex^="-"])'):void 0)||u).focus(),u=null),p(()=>{m(!0),o.value=!1,r("hide",$)},t.transitionDuration)}function X($){sa(()=>{let Y=s.value;if(Y!==null){if($!==void 0){const qe=Y.querySelector($);if(qe!==null){qe.focus({preventScroll:!0});return}}Y.contains(document.activeElement)!==!0&&(Y=Y.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||Y.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||Y.querySelector("[autofocus], [data-autofocus]")||Y,Y.focus({preventScroll:!0}))}})}function oe($){$&&typeof $.focus=="function"?$.focus({preventScroll:!0}):X(),r("shake");const Y=s.value;Y!==null&&(Y.classList.remove("q-animate--scale"),Y.classList.add("q-animate--scale"),l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,s.value!==null&&(Y.classList.remove("q-animate--scale"),X())},170))}function ee(){t.seamless!==!0&&(t.persistent===!0||t.noEscDismiss===!0?t.maximized!==!0&&t.noShake!==!0&&oe():(r("escapeKey"),P()))}function te($){l!==null&&(clearTimeout(l),l=null),($===!0||a.value===!0)&&(ce(!1),t.seamless!==!0&&(f(!1),wi(Z),Gr(ee))),$!==!0&&(u=null)}function ce($){$===!0?c!==!0&&(Er<1&&document.body.classList.add("q-body--dialog"),Er++,c=!0):c===!0&&(Er<2&&document.body.classList.remove("q-body--dialog"),Er--,c=!1)}function le($){d!==!0&&(P($),r("click",$))}function z($){t.persistent!==!0&&t.noBackdropDismiss!==!0?P($):t.noShake!==!0&&oe()}function Z($){t.allowFocusOutside!==!0&&A.value===!0&&na(s.value,$.target)!==!0&&X('[tabindex]:not([tabindex="-1"])')}Object.assign(i.proxy,{focus:X,shake:oe,__updateRefocusTarget($){u=$||null}}),Ne(te);function ue(){return ae("div",{role:"dialog","aria-modal":K.value===!0?"true":"false",...n,class:G.value},[ae($r,{name:"q-transition--fade",appear:!0},()=>K.value===!0?ae("div",{class:"q-dialog__backdrop fixed-full",style:g.value,"aria-hidden":"true",tabindex:-1,onClick:z}):null),ae($r,b.value,()=>a.value===!0?ae("div",{ref:s,class:U.value,style:_.value,tabindex:-1,...B.value},ir(e.default)):null)])}return T}}),Gp=ke({name:"QPopupProxy",props:{...Xi,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(t,{slots:e,emit:r,attrs:n}){const{proxy:i}=Ie(),{$q:s}=i,a=re(!1),o=re(null),l=F(()=>parseInt(t.breakpoint,10)),{canShow:u}=Zi({showing:a});function c(){return s.screen.width<l.value||s.screen.height<l.value?"dialog":"menu"}const d=re(c()),h=F(()=>d.value==="menu"?{maxHeight:"99vh"}:{});_e(()=>c(),v=>{a.value!==!0&&(d.value=v)});function f(v){a.value=!0,r("show",v)}function p(v){a.value=!1,d.value=c(),r("hide",v)}return Object.assign(i,{show(v){u(v)===!0&&o.value.show(v)},hide(v){o.value.hide(v)},toggle(v){o.value.toggle(v)}}),ra(i,"currentComponent",()=>({type:d.value,ref:o.value})),()=>{const v={ref:o,...h.value,...n,onShow:f,onHide:p};let y;return d.value==="dialog"?y=Lf:(y=$f,Object.assign(v,{target:t.target,contextMenu:t.contextMenu,noParentEvent:!0,separateClosePopup:!0})),ae(y,v,e.default)}}});function Ys(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const e=parseInt(t,10);return isNaN(e)?0:e}var Qp=Xs({name:"close-popup",beforeMount(t,{value:e}){const r={depth:Ys(e),handler(n){r.depth!==0&&setTimeout(()=>{const i=Of(t);i!==void 0&&Sf(i,n,r.depth)})},handlerKey(n){tn(n,13)===!0&&r.handler(n)}};t.__qclosepopup=r,t.addEventListener("click",r.handler),t.addEventListener("keyup",r.handlerKey)},updated(t,{value:e,oldValue:r}){e!==r&&(t.__qclosepopup.depth=Ys(e))},beforeUnmount(t){const e=t.__qclosepopup;t.removeEventListener("click",e.handler),t.removeEventListener("keyup",e.handlerKey),delete t.__qclosepopup}});const Ln=/^[a-z0-9]+(-[a-z0-9]+)*$/,Nf=(t,e,r,n="")=>{const i=t.split(":");if(t.slice(0,1)==="@"){if(i.length<2||i.length>3)return null;n=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const o=i.pop(),l=i.pop(),u={provider:i.length>0?i[0]:n,prefix:l,name:o};return e&&!Nn(u)?null:u}const s=i[0],a=s.split("-");if(a.length>1){const o={provider:n,prefix:a.shift(),name:a.join("-")};return e&&!Nn(o)?null:o}if(r&&n===""){const o={provider:n,prefix:"",name:s};return e&&!Nn(o,r)?null:o}return null},Nn=(t,e)=>t?!!((t.provider===""||t.provider.match(Ln))&&(e&&t.prefix===""||t.prefix.match(Ln))&&t.name.match(Ln)):!1,Yp={__name:"MyAvatar",props:["BGCOLOR","EMOJI","SIZE","isRounded"],setup(t){const e=t,r=re(!1),n=re(45),i=re(20),s=re(24),a=F(()=>e==null?void 0:e.EMOJI);function o(){switch(e==null?void 0:e.SIZE){case"xl":n.value=100,s.value=70,i.value=63-4*(e==null?void 0:e.EMOJI.length);break;case"lg":n.value=75,s.value=50,i.value=52-4*(e==null?void 0:e.EMOJI.length);break;case"md":n.value=60,s.value=37,(e==null?void 0:e.EMOJI.length)<5?i.value=40-2*(e==null?void 0:e.EMOJI.length):(e==null?void 0:e.EMOJI.length)<=12?i.value=40-1*(e==null?void 0:e.EMOJI.length):i.value=36-1*(e==null?void 0:e.EMOJI.length);break;case"sm":n.value=40,s.value=26,i.value=30-1*(e==null?void 0:e.EMOJI.length);break;case"xs":n.value=30,s.value=20,i.value=16-1*(e==null?void 0:e.EMOJI.length);break;default:n.value=45,s.value=26,i.value=20-1*(e==null?void 0:e.EMOJI.length);break}i.value<12&&(i.value=12)}_e(a,(u,c)=>{console.log("Watching"),console.log("Watch props.selected function called with args:",u,c),l(),o()});function l(){Nf(e==null?void 0:e.EMOJI)?r.value=!0:r.value=!1}return l(),o(),(u,c)=>(gn(),as(Do,{rounded:e==null?void 0:e.isRounded,style:yn({backgroundColor:e==null?void 0:e.BGCOLOR}),"text-color":"white",size:`${n.value}px`},{default:Io(()=>[r.value?(gn(),as(Co(No),{key:0,icon:e==null?void 0:e.EMOJI,style:yn({fontSize:`${s.value}px`})},null,8,["icon","style"])):(gn(),xo("span",{key:1,style:yn({fontSize:`${i.value}px`,whiteSpace:"pre-line",textAlign:"center"})},Ro(e==null?void 0:e.EMOJI),5))]),_:1},8,["rounded","style","size"]))}};let Uf=!1;{const t=document.createElement("div");t.setAttribute("dir","rtl"),Object.assign(t.style,{width:"1px",height:"1px",overflow:"auto"});const e=document.createElement("div");Object.assign(e.style,{width:"1000px",height:"1px"}),document.body.appendChild(t),t.appendChild(e),t.scrollLeft=-1e3,Uf=t.scrollLeft>=0,t.remove()}export{bp as $,Fp as A,Hp as B,Qp as C,Wp as D,Lp as E,Bp as F,qp as G,Kp as H,cp as I,up as J,mp as K,yp as L,$p as M,lp as N,ns as O,Uf as P,Vp as Q,Ep as R,Jf as S,Yf as T,kp as U,ls as V,us as W,Br as X,hp as Y,Rp as Z,Yp as _,Oi as a,Mp as a0,Dp as a1,Tp as a2,Ap as a3,Cp as a4,Ip as a5,pp as a6,fp as a7,Qf as a8,Lf as a9,Nf as aa,Zf as ab,Op as ac,Sp as ad,zp as ae,ki as b,Si as c,Wo as d,Xf as e,Go as f,Gp as g,$f as h,Gf as i,Vf as j,zf as k,Up as l,op as m,gp as n,Jp as o,ep as p,ap as q,jp as r,dp as s,vp as t,Ei as u,_p as v,wp as w,Pp as x,xp as y,Np as z};
