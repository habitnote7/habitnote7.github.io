import{m as He,r as F,c,w as ne,v as Ve,h as s,g as Ae,n as Ie,a8 as Ke,al as Pe,q as Be,I as Fe,af as Te}from"./index.f7a7949b.js";import{p as k,T as $e}from"./rtl.1af79ae3.js";import{u as je,a as Ne}from"./use-dark.c9afc95e.js";import{u as Ye,c as ze,d as Le}from"./uid.4a806039.js";import{u as Qe,b as We,c as Ee,_ as T,g as Ue,f as Xe}from"./moment.f8dc2e6a.js";function Ge(u,$){if(u.hour!==null){if(u.minute===null)return"minute";if($===!0&&u.second===null)return"second"}return"hour"}function Je(){const u=new Date;return{hour:u.getHours(),minute:u.getMinutes(),second:u.getSeconds(),millisecond:u.getMilliseconds()}}He({name:"QTime",props:{...je,...Ye,...Qe,mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:u=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(u)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:We,setup(u,{slots:$,emit:ae}){const j=Ae(),{$q:y}=j.proxy,oe=Ne(u,y),{tabindex:g,headerClass:U,getLocale:ie,getCurrentDate:X}=Ee(u,y),se=ze(u),re=Le(se);let M,x;const G=F(null),D=c(()=>he()),S=c(()=>ie()),J=c(()=>_e()),O=T(u.modelValue,D.value,S.value,u.calendar,J.value),i=F(Ge(O)),l=F(O),v=F(O.hour===null||O.hour<12),ce=c(()=>`q-time q-time--${u.landscape===!0?"landscape":"portrait"}`+(oe.value===!0?" q-time--dark q-dark":"")+(u.disable===!0?" disabled":u.readonly===!0?" q-time--readonly":"")+(u.bordered===!0?" q-time--bordered":"")+(u.square===!0?" q-time--square no-border-radius":"")+(u.flat===!0?" q-time--flat no-shadow":"")),N=c(()=>{const e=l.value;return{hour:e.hour===null?"--":f.value===!0?k(e.hour):String(v.value===!0?e.hour===0?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:e.minute===null?"--":k(e.minute),second:e.second===null?"--":k(e.second)}}),f=c(()=>u.format24h!==null?u.format24h:y.lang.date.format24h),ve=c(()=>{const e=i.value==="hour",t=e===!0?12:60,n=l.value[i.value];let r=`rotate(${Math.round(n*(360/t))-180}deg) translateX(-50%)`;return e===!0&&f.value===!0&&l.value.hour>=12&&(r+=" scale(.7)"),{transform:r}}),Z=c(()=>l.value.hour!==null),de=c(()=>Z.value===!0&&l.value.minute!==null),q=c(()=>u.hourOptions!==void 0?e=>u.hourOptions.includes(e):u.options!==void 0?e=>u.options(e,null,null):null),p=c(()=>u.minuteOptions!==void 0?e=>u.minuteOptions.includes(e):u.options!==void 0?e=>u.options(l.value.hour,e,null):null),H=c(()=>u.secondOptions!==void 0?e=>u.secondOptions.includes(e):u.options!==void 0?e=>u.options(l.value.hour,l.value.minute,e):null),h=c(()=>{if(q.value===null)return null;const e=A(0,11,q.value),t=A(12,11,q.value);return{am:e,pm:t,values:e.values.concat(t.values)}}),w=c(()=>p.value!==null?A(0,59,p.value):null),b=c(()=>H.value!==null?A(0,59,H.value):null),V=c(()=>{switch(i.value){case"hour":return h.value;case"minute":return w.value;case"second":return b.value}}),fe=c(()=>{let e,t,n=0,o=1;const r=V.value!==null?V.value.values:void 0;i.value==="hour"?f.value===!0?(e=0,t=23):(e=0,t=11,v.value===!1&&(n=12)):(e=0,t=55,o=5);const m=[];for(let a=e,d=e;a<=t;a+=o,d++){const _=a+n,Oe=r!==void 0&&r.includes(_)===!1,pe=i.value==="hour"&&a===0?f.value===!0?"00":"12":a;m.push({val:_,index:d,disable:Oe,label:pe})}return m}),me=c(()=>[[$e,ge,void 0,{stop:!0,prevent:!0,mouse:!0}]]);ne(()=>u.modelValue,e=>{const t=T(e,D.value,S.value,u.calendar,J.value);(t.dateHash!==l.value.dateHash||t.timeHash!==l.value.timeHash)&&(l.value=t,t.hour===null?i.value="hour":v.value=t.hour<12)}),ne([D,S],()=>{Ie(()=>{E()})});function R(){const e={...X(),...Je()};E(e),Object.assign(l.value,e),i.value="hour"}function A(e,t,n){const o=Array.apply(null,{length:t+1}).map((r,m)=>{const a=m+e;return{index:a,val:n(a)===!0}}).filter(r=>r.val===!0).map(r=>r.index);return{min:o[0],max:o[o.length-1],values:o,threshold:t+1}}function ee(e,t,n){const o=Math.abs(e-t);return Math.min(o,n-o)}function Y(e,{min:t,max:n,values:o,threshold:r}){if(e===t)return t;if(e<t||e>n)return ee(e,t,r)<=ee(e,n,r)?t:n;const m=o.findIndex(_=>e<=_),a=o[m-1],d=o[m];return e-a<=d-e?a:d}function he(){return u.calendar!=="persian"&&u.mask!==null?u.mask:`HH:mm${u.withSeconds===!0?":ss":""}`}function _e(){if(typeof u.defaultDate!="string"){const e=X(!0);return e.dateHash=Ue(e),e}return T(u.defaultDate,"YYYY/MM/DD",void 0,u.calendar)}function z(){return Te(j)===!0||V.value!==null&&(V.value.values.length===0||i.value==="hour"&&f.value!==!0&&h.value[v.value===!0?"am":"pm"].values.length===0)}function L(){const e=G.value,{top:t,left:n,width:o}=e.getBoundingClientRect(),r=o/2;return{top:t+r,left:n+r,dist:r*.7}}function ge(e){if(z()!==!0){if(e.isFirst===!0){M=L(),x=I(e.evt,M);return}x=I(e.evt,M,x),e.isFinal===!0&&(M=!1,x=null,te())}}function te(){i.value==="hour"?i.value="minute":u.withSeconds&&i.value==="minute"&&(i.value="second")}function I(e,t,n){const o=Ke(e),r=Math.abs(o.top-t.top),m=Math.sqrt(Math.pow(Math.abs(o.top-t.top),2)+Math.pow(Math.abs(o.left-t.left),2));let a,d=Math.asin(r/m)*(180/Math.PI);if(o.top<t.top?d=t.left<o.left?90-d:270+d:d=t.left<o.left?d+90:270-d,i.value==="hour"){if(a=d/30,h.value!==null){const _=f.value!==!0?v.value===!0:h.value.am.values.length!==0&&h.value.pm.values.length!==0?m>=t.dist:h.value.am.values.length!==0;a=Y(a+(_===!0?0:12),h.value[_===!0?"am":"pm"])}else a=Math.round(a),f.value===!0?m<t.dist?a<12&&(a+=12):a===12&&(a=0):v.value===!0&&a===12?a=0:v.value===!1&&a!==12&&(a+=12);f.value===!0&&(v.value=a<12)}else a=Math.round(d/6)%60,i.value==="minute"&&w.value!==null?a=Y(a,w.value):i.value==="second"&&b.value!==null&&(a=Y(a,b.value));return n!==a&&xe[i.value](a),a}const Q={hour(){i.value="hour"},minute(){i.value="minute"},second(){i.value="second"}};function ke(e){e.keyCode===13&&ue()}function ye(e){e.keyCode===13&&le()}function qe(e){z()!==!0&&(y.platform.is.desktop!==!0&&I(e,L()),te())}function we(e){z()!==!0&&I(e,L())}function be(e){if(e.keyCode===13)i.value="hour";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(h.value!==null){const n=f.value===!0?h.value.values:h.value[v.value===!0?"am":"pm"].values;if(n.length===0)return;if(l.value.hour===null)K(n[0]);else{const o=(n.length+n.indexOf(l.value.hour)+t)%n.length;K(n[o])}}else{const n=f.value===!0?24:12,o=f.value!==!0&&v.value===!1?12:0,r=l.value.hour===null?-t:l.value.hour;K(o+(24+r+t)%n)}}}function Ce(e){if(e.keyCode===13)i.value="minute";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(w.value!==null){const n=w.value.values;if(n.length===0)return;if(l.value.minute===null)P(n[0]);else{const o=(n.length+n.indexOf(l.value.minute)+t)%n.length;P(n[o])}}else{const n=l.value.minute===null?-t:l.value.minute;P((60+n+t)%60)}}}function Me(e){if(e.keyCode===13)i.value="second";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(b.value!==null){const n=b.value.values;if(n.length===0)return;if(l.value.seconds===null)B(n[0]);else{const o=(n.length+n.indexOf(l.value.second)+t)%n.length;B(n[o])}}else{const n=l.value.second===null?-t:l.value.second;B((60+n+t)%60)}}}function K(e){l.value.hour!==e&&(l.value.hour=e,C())}function P(e){l.value.minute!==e&&(l.value.minute=e,C())}function B(e){l.value.second!==e&&(l.value.second=e,C())}const xe={hour:K,minute:P,second:B};function ue(){v.value===!1&&(v.value=!0,l.value.hour!==null&&(l.value.hour-=12,C()))}function le(){v.value===!0&&(v.value=!1,l.value.hour!==null&&(l.value.hour+=12,C()))}function W(e){const t=u.modelValue;i.value!==e&&t!==void 0&&t!==null&&t!==""&&typeof t!="string"&&(i.value=e)}function C(){if(q.value!==null&&q.value(l.value.hour)!==!0){l.value=T(),W("hour");return}if(p.value!==null&&p.value(l.value.minute)!==!0){l.value.minute=null,l.value.second=null,W("minute");return}if(u.withSeconds===!0&&H.value!==null&&H.value(l.value.second)!==!0){l.value.second=null,W("second");return}l.value.hour===null||l.value.minute===null||u.withSeconds===!0&&l.value.second===null||E()}function E(e){const t=Object.assign({...l.value},e),n=u.calendar==="persian"?k(t.hour)+":"+k(t.minute)+(u.withSeconds===!0?":"+k(t.second):""):Xe(new Date(t.year,t.month===null?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),D.value,S.value,t.year,t.timezoneOffset);t.changed=n!==u.modelValue,ae("update:modelValue",n,t)}function De(){const e=[s("div",{class:"q-time__link "+(i.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:Q.hour,onKeyup:be},N.value.hour),s("div",":"),s("div",Z.value===!0?{class:"q-time__link "+(i.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:Ce,onClick:Q.minute}:{class:"q-time__link"},N.value.minute)];u.withSeconds===!0&&e.push(s("div",":"),s("div",de.value===!0?{class:"q-time__link "+(i.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:Me,onClick:Q.second}:{class:"q-time__link"},N.value.second));const t=[s("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},e)];return f.value===!1&&t.push(s("div",{class:"q-time__header-ampm column items-between no-wrap"},[s("div",{class:"q-time__link "+(v.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:ue,onKeyup:ke},"AM"),s("div",{class:"q-time__link "+(v.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:le,onKeyup:ye},"PM")])),s("div",{class:"q-time__header flex flex-center no-wrap "+U.value},t)}function Se(){const e=l.value[i.value];return s("div",{class:"q-time__content col relative-position"},[s(Pe,{name:"q-transition--scale"},()=>s("div",{key:"clock"+i.value,class:"q-time__container-parent absolute-full"},[s("div",{ref:G,class:"q-time__container-child fit overflow-hidden"},[Be(s("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:qe,onMousedown:we},[s("div",{class:"q-time__clock-circle fit"},[s("div",{class:"q-time__clock-pointer"+(l.value[i.value]===null?" hidden":u.color!==void 0?` text-${u.color}`:""),style:ve.value}),fe.value.map(t=>s("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${t.index}`+(t.val===e?" q-time__clock-position--active "+U.value:t.disable===!0?" q-time__clock-position--disable":"")},[s("span",t.label)]))])]),me.value)])])),u.nowBtn===!0?s(Fe,{class:"q-time__now-button absolute",icon:y.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:u.color,textColor:u.textColor,tabindex:g.value,onClick:R}):null])}return j.proxy.setNow=R,()=>{const e=[Se()],t=Ve($.default);return t!==void 0&&e.push(s("div",{class:"q-time__actions"},t)),u.name!==void 0&&u.disable!==!0&&re(e,"push"),s("div",{class:ce.value,tabindex:-1},[De(),s("div",{class:"q-time__main col overflow-auto"},e)])}}});
