import{Q as X,a as H,b as Z}from"./QTabPanels.8f766304.js";import{Q as ee}from"./QTabs.235fe9b8.js";import{_ as te,Q as B,L as ae,a5 as le,J as oe,k as ie}from"./rtl.3aed263d.js";import{h as q,a as ne}from"./moment.f201de8e.js";import"./iconify.4d43847a.js";import{u as Q}from"./habitDetailStore.14cc725b.js";import{C as b,D as M,f as m,H as k,E as v,J as $,aI as re,m as A,c as I,h as d,v as N,g as G,r as p,w,k as se,o as ce,as as ue,ae as de,l as me,ac as L,W as ve,i as _e,p as R,Y as he,Q as fe,aX as j,ao as be,G as S,P as Y,O as F,M as V,F as ge,aH as De,L as ke,R as ye,an as Se}from"./index.431dcb33.js";import{Q as Me}from"./AllHabitStore.8682d05d.js";import{u as J,a as U}from"./use-dark.55495a85.js";import{u as Ie,d as Te,Q as P}from"./OptionSelecter2.ab9ae1ed.js";import{c as pe}from"./scroll.c8893e35.js";import{_ as Ce,u as Oe,a as qe}from"./CheckMarkPage2.3f4ad29e.js";import{u as W}from"./use-quasar.e647a0d9.js";import"./use-panel.4f709892.js";import"./uid.3d1f5a39.js";import"./QScrollObserver.fe79d156.js";import"./axios.492a3d3b.js";import"./apOptionQuery.ccdaf876.js";import"./QInput.665a9d0a.js";import"./QCard.9cbea35f.js";import"./QTime.5af0cc2c.js";const Ye={align:"center",class:"q-ma-md"},Ee={class:"text-h3"},$e={class:"text-body1"},xe={__name:"HabitDetail",setup(e){const a=Q();return(r,o)=>{var t,s,l,c;return b(),M("div",Ye,[m(te,{BGCOLOR:(t=k(a).habitDetail)==null?void 0:t.COLOR,EMOJI:(s=k(a).habitDetail)==null?void 0:s.EMOJI,SIZE:"lg",isRounded:!0},null,8,["BGCOLOR","EMOJI"]),v("div",Ee,$((l=k(a).habitDetail)==null?void 0:l.HABIT_LABEL),1),v("div",$e,$((c=k(a).habitDetail)==null?void 0:c.DESCRIPTION),1)])}}},Ne={};function Qe(e,a){return b(),M("div",null," Habit Graph ")}var Ae=re(Ne,[["render",Qe]]);const Re=["horizontal","vertical","cell","none"];var we=A({name:"QMarkupTable",props:{...J,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>Re.includes(e)}},setup(e,{slots:a}){const r=G(),o=U(e,r.proxy.$q),t=I(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(o.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>d("div",{class:t.value},[d("table",{class:"q-table"},N(a.default))])}});function Fe(e,a){return d("div",e,[d("table",{class:"q-table"},a)])}const Ve={list:Me,table:we},He=["list","table","__qtable"];var Be=A({name:"QVirtualScroll",props:{...Ie,type:{type:String,default:"list",validator:e=>He.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:a,attrs:r}){let o;const t=p(null),s=I(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:l,localResetVirtualScroll:c,padVirtualScroll:T,onVirtualScrollEvt:u}=Te({virtualScrollLength:s,getVirtualScrollTarget:_,getVirtualScrollEl:h}),i=I(()=>{if(s.value===0)return[];const g=(E,C)=>({index:l.value.from+C,item:E});return e.itemsFn===void 0?e.items.slice(l.value.from,l.value.to).map(g):e.itemsFn(l.value.from,l.value.to-l.value.from).map(g)}),n=I(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),D=I(()=>e.scrollTarget!==void 0?{}:{tabindex:0});w(s,()=>{c()}),w(()=>e.scrollTarget,()=>{f(),O()});function h(){return t.value.$el||t.value}function _(){return o}function O(){o=pe(h(),e.scrollTarget),o.addEventListener("scroll",u,L.passive)}function f(){o!==void 0&&(o.removeEventListener("scroll",u,L.passive),o=void 0)}function y(){let g=T(e.type==="list"?"div":"tbody",i.value.map(a.default));return a.before!==void 0&&(g=a.before().concat(g)),ve(a.after,g)}return se(()=>{c()}),ce(()=>{O()}),ue(()=>{O()}),de(()=>{f()}),me(()=>{f()}),()=>{if(a.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?Fe({ref:t,class:"q-table__middle "+n.value},y()):d(Ve[e.type],{...r,ref:t,class:[r.class,n.value],...D.value},y)}}}),Le=A({name:"QTimelineEntry",props:{heading:Boolean,tag:{type:String,default:"h3"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},icon:String,avatar:String,color:String,title:String,subtitle:String,body:String},setup(e,{slots:a}){const r=_e(j,R);if(r===R)return console.error("QTimelineEntry needs to be child of QTimeline"),R;const o=I(()=>`q-timeline__entry q-timeline__entry--${e.side}`+(e.icon!==void 0||e.avatar!==void 0?" q-timeline__entry--icon":"")),t=I(()=>`q-timeline__dot text-${e.color||r.color}`),s=I(()=>r.layout==="comfortable"&&r.side==="left");return()=>{const l=he(a.default,[]);if(e.body!==void 0&&l.unshift(e.body),e.heading===!0){const u=[d("div"),d("div"),d(e.tag,{class:"q-timeline__heading-title"},l)];return d("div",{class:"q-timeline__heading"},s.value===!0?u.reverse():u)}let c;e.icon!==void 0?c=[d(fe,{class:"row items-center justify-center",name:e.icon})]:e.avatar!==void 0&&(c=[d("img",{class:"q-timeline__dot-img",src:e.avatar})]);const T=[d("div",{class:"q-timeline__subtitle"},[d("span",{},N(a.subtitle,[e.subtitle]))]),d("div",{class:t.value},c),d("div",{class:"q-timeline__content"},[d("h6",{class:"q-timeline__title"},N(a.title,[e.title]))].concat(l))];return d("li",{class:o.value},s.value===!0?T.reverse():T)}}}),Pe=A({name:"QTimeline",props:{...J,color:{type:String,default:"primary"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},layout:{type:String,default:"dense",validator:e=>["dense","comfortable","loose"].includes(e)}},setup(e,{slots:a}){const r=G(),o=U(e,r.proxy.$q);be(j,e);const t=I(()=>`q-timeline q-timeline--${e.layout} q-timeline--${e.layout}--${e.side}`+(o.value===!0?" q-timeline--dark":""));return()=>d("ul",{class:t.value},N(a.default))}});const ze={key:0},Ge={class:"row"},je={class:"text-h6 text-grey col-9"},Je={key:0,class:"col-3",align:"right"},Ue=v("span",null,"Add New CheckMark Entry. ",-1),We={class:"row"},Ke={class:"text-h6 col-9"},Xe={key:0,class:"col-3",align:"right"},Ze=v("span",null,"Add New CheckMark Entry. ",-1),et={class:"q-mx-none"},tt={__name:"CheckMarkDetailItem",props:["cmItem"],emits:["openCheckMark"],setup(e,{expose:a,emit:r}){var u;const o=Q(),t=e,s=r,l=p([]);l.value=(u=t==null?void 0:t.cmItem)==null?void 0:u.CheckMarkArr;function c(i){let n={habitDetails:Object.assign({},o.habitDetail),forDate:t==null?void 0:t.cmItem.ForDate,CMT_ID:(i==null?void 0:i.CMT_ID)||null,CMDetails:Object.assign({},i)||null};s("openCheckMark",n)}async function T(){var n,D;const i=await ae((n=o.habitDetail)==null?void 0:n.HABIT_ID,t==null?void 0:t.cmItem.ForDate);for(let h=0;h<i.length;h++){const _=i[h];_.OPTION_ID&&(_.OPTION_DETAILS=(D=o.habitDetail)==null?void 0:D.optionDetails.find(O=>O.OPTION_ID==_.OPTION_ID))}l.value=i}return a({getCheckMarkDeatils:T}),(i,n)=>{var D;return b(),M("div",null,[l.value.length==0?(b(),M("div",ze,[v("div",Ge,[v("div",je,$(k(q)(t==null?void 0:t.cmItem.ForDate).format("ddd DD MMM YYYY")),1),l.value.length<((D=k(o).habitDetail)==null?void 0:D.NO_OF_ENTRIES_PERDAY)?(b(),M("div",Je,[m(P,{clickable:"",onClick:n[0]||(n[0]=h=>c()),color:"primary",icon:"add",outline:""},{default:S(()=>[Y("Add "),m(B,null,{default:S(()=>{var h;return[Ue,v("span",null,[Y(" You can add "),v("b",null,$(((h=k(o).habitDetail)==null?void 0:h.NO_OF_ENTRIES_PERDAY)-l.value.length),1),Y(" more entry")])]}),_:1})]),_:1})])):F("",!0)])])):(b(),V(Pe,{key:1,color:"secondary"},{default:S(()=>{var h;return[v("div",We,[v("div",Ke,$(k(q)(t==null?void 0:t.cmItem.ForDate).format("ddd DD MMM YYYY")),1),l.value.length<((h=k(o).habitDetail)==null?void 0:h.NO_OF_ENTRIES_PERDAY)?(b(),M("div",Xe,[m(P,{clickable:"",onClick:n[1]||(n[1]=_=>c()),color:"primary",icon:"add",outline:""},{default:S(()=>[Y("Add "),m(B,null,{default:S(()=>{var _;return[Ze,v("span",null,[Y(" You can add "),v("b",null,$(((_=k(o).habitDetail)==null?void 0:_.NO_OF_ENTRIES_PERDAY)-l.value.length),1),Y(" more entry")])]}),_:1})]),_:1})])):F("",!0)]),v("div",et,[(b(!0),M(ge,null,De(l.value,_=>(b(),V(Le,{key:_.CMT_ID,subtitle:k(q)(_.TIME_ENTRY).format("hh:mm A")},{default:S(()=>[m(Ce,{habitDetails:k(o).habitDetail,checkmark:_,onGoToEdit:O=>c(_)},null,8,["habitDetails","checkmark","onGoToEdit"])]),_:2},1032,["subtitle"]))),128))])]}),_:1}))])}}},at={class:"text-white text-center"},lt={key:0},ot={key:1},it={key:0},z=3,nt={__name:"HabitNotes",setup(e){const a=Q(),r=Oe(),o=p([]),t=p({}),s=p(q().add(1,"days").format("YYYY-MM-DD")),l=p(q(s.value).subtract(z,"days").format("YYYY-MM-DD"));function c(f){console.log("dataToPass",f),r.openCheckMarkDailog(f)}function T(){t.value[`ForDate${r.forDate}`].getCheckMarkDeatils()}const u=p(0),i=p(0),n=p(!1);async function D(f){u.value=await le(a.habitId)}D();const h=W();I(()=>({height:h.screen.height-52+"px"}));async function _({index:f}){if(console.log("Hey hey Iam Viewd"),console.log("index :",f),console.log("noOfFetchedCM.value :",i.value),f>=i.value-1&&i.value<u.value){const y=await O();console.log("noOfTotalCM :",u.value),y.length===0&&i.value<u.value&&_({index:f}),o.value=[...o.value,...y]}}async function O(){var f;if(i.value<u.value){n.value=!0,console.log("startDate.value :",l.value);const y=await oe(a.habitId,`${l.value}`,`${s.value}`);i.value=i.value+y.length;for(let C=0;C<y.length;C++){const x=y[C];x.OPTION_ID&&(x.OPTION_DETAILS=(f=a.habitDetail)==null?void 0:f.optionDetails.find(K=>K.OPTION_ID==x.OPTION_ID))}let g=q(s.value).subtract(1,"days"),E=[];for(;g.isSameOrAfter(l.value);){let C={ForDate:g.format("YYYY-MM-DD"),CheckMarkArr:y.filter(x=>x.DATE==g.format("YYYY-MM-DD"))};E.push(C),g.subtract(1,"days")}return s.value=q(l.value).format("YYYY-MM-DD"),l.value=q(s.value).subtract(z,"days").format("YYYY-MM-DD"),console.log("fetchCheckMark : ",y),n.value=!1,E}else return[]}return(f,y)=>(b(),M("div",null,[m(Be,{"scroll-target":"#virtual-scroll-target > .scroll",items:o.value,onVirtualScroll:_,class:"q-ma-none","virtual-scroll-item-size":10},{default:S(({item:g,index:E})=>[(b(),M("div",{key:E},[m(tt,{cmItem:g,ref:C=>t.value[`ForDate${g.ForDate}`]=C,onOpenCheckMark:c},null,8,["cmItem"])]))]),_:1},8,["items"]),v("div",at,[n.value?(b(),M("div",lt,"Please wait!! Loading more data ...")):(b(),M("div",ot,"You have reached the End !!"))]),k(r).addCMDailog?(b(),M("div",it,[m(qe,{onCloseCM:T})])):F("",!0)]))}},rt=v("div",{class:"text-h6"},"Graph and Insights",-1),st=v("div",{class:"text-h6 text-center"},"Habit Notes and Checkmarks",-1),ct=v("br",null,null,-1),Et={__name:"HabitDetailPage",setup(e){const a=Q(),r=W(),o=I(()=>({height:r.screen.height-52+"px"})),t={right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},s={right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2},l=ke();ye();const c=I(()=>l.params.habitid);console.log("forHabitId :",c);function T(i){a.habitId=parseInt(i),a.getHabitDetail()}T(c.value),w(c,(i,n)=>{console.log("Watch forHabitId :",i,n),T(i)});const u=p("notes");return(i,n)=>(b(),V(ne,{style:Se(o.value),"thumb-style":t,"bar-style":s,id:"virtual-scroll-target"},{default:S(()=>[v("div",null,[m(xe),m(ee,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=D=>u.value=D),dense:"","no-caps":"",align:"justify"},{default:S(()=>[m(X,{name:"notes",class:"text-orange",icon:"checklist_rtl",label:"Checkmarks and Notes"})]),_:1},8,["modelValue"]),m(ie),m(Z,{modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=D=>u.value=D),animated:"",swipeable:""},{default:S(()=>[m(H,{name:"habitGraph"},{default:S(()=>[rt,Y(" Lorem ipsum dolor sit amet consectetur adipisicing elit. "),m(Ae)]),_:1}),m(H,{name:"notes"},{default:S(()=>[st,m(nt)]),_:1})]),_:1},8,["modelValue"]),ct])]),_:1},8,["style"]))}};export{Et as default};
